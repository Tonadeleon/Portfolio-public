<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Tonatiuh De Leon" />


<title>Spotify Regression</title>

<script src="site_libs/header-attrs-2.26/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Tonatiuh de Leon</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Regression Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="DecibelRegression.html">Song Decibel Levels</a>
    </li>
    <li>
      <a href="SpotifyRegression.html">Spotify Regression</a>
    </li>
    <li>
      <a href="CarAnalysis.html">Selling my Car Regression</a>
    </li>
    <li>
      <a href="HousePriceRegression.html">House Prices Predictions</a>
    </li>
    <li>
      <a href="LogisticRegression325.html">Who's Getting Good Grades?</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Modeling &amp; Simulations
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Whale.html">Recreated the Milky Way, or a Whale?</a>
    </li>
    <li>
      <a href="Temple.html">Modeled a Beatiful Building</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Inferential Statistics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="StephApartment.html">Finding an Apartment</a>
    </li>
    <li>
      <a href="TtestInternet.html">Boys or Girls; Who Uses More Internet?</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Visualizations
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TimeSeries.html">Correlation</a>
    </li>
    <li>
      <a href="Distributions.html">Distribution</a>
    </li>
    <li>
      <a href="Maps.html">Spatial</a>
    </li>
    <li>
      <a href="BarGraphs.html">Quick Comparison</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Machine Learning
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Coming Soon</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Time Series
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Coming Soon</li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Spotify Regression</h1>
<h4 class="author">Tonatiuh De Leon</h4>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">SPOTIFY_CLIENT_ID =</span> <span class="st">&#39;857bab10601a4bc2af19d359336d3af7&#39;</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">Sys.setenv</span>(<span class="at">SPOTIFY_CLIENT_SECRET =</span> <span class="st">&#39;f36a14960bc445fba551b36f3b65cd65&#39;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://kworb.net/spotify/songs.html&quot;</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>url1 <span class="ot">&lt;-</span> <span class="st">&quot;https://kworb.net/spotify/artists.html&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>url2 <span class="ot">&lt;-</span> <span class="st">&quot;https://kworb.net/spotify/listeners.html&quot;</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="co">#access_token &lt;- get_spotify_access_token()</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a> </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="co">#all_artists_info &lt;- search_spotify(&quot;all&quot;, type = &quot;artist&quot;)</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>webpage <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">html_table</span>(webpage)[[<span class="dv">1</span>]]</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>webpage1 <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url1)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">html_table</span>(webpage1)[[<span class="dv">1</span>]]</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>webpage2 <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url2)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>table2 <span class="ot">&lt;-</span> <span class="fu">html_table</span>(webpage2)[[<span class="dv">1</span>]]</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a> </span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(table) <span class="sc">|&gt;</span> </span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">title =</span> <span class="st">`</span><span class="at">Artist and Title</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  <span class="fu">separate</span>(title, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;artist&quot;</span>, <span class="st">&quot;title&quot;</span>), <span class="at">sep =</span> <span class="st">&quot; - &quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">streams =</span> Streams,</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>         <span class="at">daily =</span> Daily) <span class="sc">|&gt;</span> </span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">streams =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;,&quot;</span>, <span class="st">&quot;&quot;</span>, streams)),</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>         <span class="at">daily =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;,&quot;</span>, <span class="st">&quot;&quot;</span>, daily))) <span class="sc">|&gt;</span> </span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a> </span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a> </span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(table1) <span class="sc">|&gt;</span>  </span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">artist_streams =</span> Streams,</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>         <span class="at">artist =</span> Artist,</span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>         <span class="at">daily1 =</span> Daily) <span class="sc">|&gt;</span> </span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">artist_streams =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;,&quot;</span>, <span class="st">&quot;&quot;</span>, artist_streams))) <span class="sc">|&gt;</span> </span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(artist, artist_streams, daily1) <span class="sc">|&gt;</span> </span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a> </span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(table2) <span class="sc">|&gt;</span>  </span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">monthly_listeners =</span> Listeners,</span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a>         <span class="at">peak_monthly_listeners =</span> PkListeners,</span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a>         <span class="at">months_sincepk =</span> Peak,</span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a>         <span class="at">daily_average =</span> <span class="st">`</span><span class="at">Daily Trend</span><span class="st">`</span>,</span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a>         <span class="at">artist =</span> Artist) <span class="sc">|&gt;</span> </span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">monthly_listeners =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;,&quot;</span>, <span class="st">&quot;&quot;</span>, monthly_listeners)),</span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a>         <span class="at">peak_monthly_listeners =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;,&quot;</span>, <span class="st">&quot;&quot;</span>, peak_monthly_listeners)),</span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a>         <span class="at">daily_average =</span> <span class="fu">as.numeric</span>(<span class="fu">gsub</span>(<span class="st">&quot;,&quot;</span>, <span class="st">&quot;&quot;</span>, daily_average)))<span class="sc">|&gt;</span> </span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(artist, monthly_listeners, peak_monthly_listeners, months_sincepk, daily_average) <span class="sc">|&gt;</span> </span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a> </span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a>dta <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://github.com/Tonadeleon/Regression-Projects/raw/main/Datasets/dataset.csv&quot;</span>)<span class="sc">|&gt;</span> </span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a>  <span class="co">#filter(popularity &gt; 20) |&gt; </span></span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">title =</span> track_name,</span>
<span id="cb1-50"><a href="#cb1-50" tabindex="-1"></a>         <span class="at">artist =</span> artists,</span>
<span id="cb1-51"><a href="#cb1-51" tabindex="-1"></a>         <span class="at">title_id =</span> track_id,</span>
<span id="cb1-52"><a href="#cb1-52" tabindex="-1"></a>         <span class="at">album =</span> album_name,</span>
<span id="cb1-53"><a href="#cb1-53" tabindex="-1"></a>         <span class="at">loud =</span> loudness,</span>
<span id="cb1-54"><a href="#cb1-54" tabindex="-1"></a>         <span class="at">words =</span> speechiness,</span>
<span id="cb1-55"><a href="#cb1-55" tabindex="-1"></a>         <span class="at">acoustics =</span> acousticness,</span>
<span id="cb1-56"><a href="#cb1-56" tabindex="-1"></a>         <span class="at">instrumental =</span> instrumentalness,</span>
<span id="cb1-57"><a href="#cb1-57" tabindex="-1"></a>         <span class="at">live =</span> liveness) <span class="sc">|&gt;</span> </span>
<span id="cb1-58"><a href="#cb1-58" tabindex="-1"></a>  <span class="fu">inner_join</span>(df1, <span class="at">by=</span><span class="st">&quot;artist&quot;</span>, <span class="at">relationship =</span></span>
<span id="cb1-59"><a href="#cb1-59" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-60"><a href="#cb1-60" tabindex="-1"></a>  <span class="fu">inner_join</span>(df2, <span class="at">by=</span><span class="st">&quot;artist&quot;</span>, <span class="at">relationship =</span></span>
<span id="cb1-61"><a href="#cb1-61" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>)</span>
<span id="cb1-62"><a href="#cb1-62" tabindex="-1"></a> </span>
<span id="cb1-63"><a href="#cb1-63" tabindex="-1"></a> </span>
<span id="cb1-64"><a href="#cb1-64" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(dta, df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;artist&quot;</span>), <span class="at">relationship =</span></span>
<span id="cb1-65"><a href="#cb1-65" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-66"><a href="#cb1-66" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>track_genre) <span class="sc">|&gt;</span> </span>
<span id="cb1-67"><a href="#cb1-67" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">explicit =</span> <span class="fu">as.factor</span>(explicit),</span>
<span id="cb1-68"><a href="#cb1-68" tabindex="-1"></a>         <span class="at">daily =</span> daily,</span>
<span id="cb1-69"><a href="#cb1-69" tabindex="-1"></a>         <span class="co">#streams = ifelse(streams&gt;3825666400, 942193161, streams),</span></span>
<span id="cb1-70"><a href="#cb1-70" tabindex="-1"></a>         <span class="co">#times = as.factor(time_signature),</span></span>
<span id="cb1-71"><a href="#cb1-71" tabindex="-1"></a>         <span class="co">#energy = ifelse(energy&gt;.5,1,0),</span></span>
<span id="cb1-72"><a href="#cb1-72" tabindex="-1"></a>         <span class="co">#duration = ifelse(between(duration_ms, 200000, 250000), 1, 0),</span></span>
<span id="cb1-73"><a href="#cb1-73" tabindex="-1"></a>         <span class="co">#loud = ifelse(loud&gt;-9, 1, 0),</span></span>
<span id="cb1-74"><a href="#cb1-74" tabindex="-1"></a>         <span class="at">dance =</span> <span class="fu">ifelse</span>(danceability<span class="sc">&gt;</span>.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb1-75"><a href="#cb1-75" tabindex="-1"></a>         <span class="at">words =</span> <span class="fu">ifelse</span>(<span class="fu">between</span>(words, .<span class="dv">025</span>, .<span class="dv">06</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb1-76"><a href="#cb1-76" tabindex="-1"></a>         <span class="at">instrumental =</span> <span class="fu">ifelse</span>(instrumental<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb1-77"><a href="#cb1-77" tabindex="-1"></a>         <span class="co">#popularity = ifelse(popularity&gt;76,1,0),</span></span>
<span id="cb1-78"><a href="#cb1-78" tabindex="-1"></a>         <span class="at">live =</span> <span class="fu">ifelse</span>(live<span class="sc">&lt;</span>.<span class="dv">37</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb1-79"><a href="#cb1-79" tabindex="-1"></a>         <span class="at">key =</span> <span class="fu">case_when</span>(key <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb1-80"><a href="#cb1-80" tabindex="-1"></a>         <span class="at">explicit =</span> <span class="fu">case_when</span>(explicit <span class="sc">==</span> <span class="st">&quot;TRUE&quot;</span> <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>), </span>
<span id="cb1-81"><a href="#cb1-81" tabindex="-1"></a>         <span class="co">#genre = case_when(genre %in% c(&quot;pop&quot;, &quot;chill&quot;, &quot;indie&quot;, &quot;garage&quot;, &quot;ambient&quot;, &quot;folk&quot;, &quot;indie-pop&quot;, &quot;power-pop&quot;, &quot;reggae&quot;, &quot;soul&quot;, &quot;synth-pop&quot;, &quot;swedish&quot;, &quot;country&quot;, &quot;metal&quot;, &quot;german&quot;, &quot;funk&quot;, &quot;alternative&quot;, &quot;alt-rock&quot;) ~ 1,TRUE ~ 0),</span></span>
<span id="cb1-82"><a href="#cb1-82" tabindex="-1"></a>         <span class="at">peak_last_year =</span> <span class="fu">ifelse</span>(months_sincepk<span class="sc">&lt;</span><span class="dv">13</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb1-83"><a href="#cb1-83" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">ifelse</span>(popularity <span class="sc">&gt;</span><span class="dv">79</span> ,<span class="dv">1</span> ,<span class="dv">0</span>),</span>
<span id="cb1-84"><a href="#cb1-84" tabindex="-1"></a>         <span class="at">popularity0 =</span> <span class="fu">round</span>(popularity <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>,</span>
<span id="cb1-85"><a href="#cb1-85" tabindex="-1"></a>         <span class="at">popularity0 =</span> <span class="fu">case_when</span>( popularity0 <span class="sc">&gt;</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">1</span>, popularity <span class="sc">==</span> <span class="dv">80</span> <span class="sc">~</span> <span class="dv">2</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">3</span> ),</span>
<span id="cb1-86"><a href="#cb1-86" tabindex="-1"></a>         <span class="at">popularity1 =</span> <span class="fu">round</span>(popularity <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb1-87"><a href="#cb1-87" tabindex="-1"></a>         <span class="at">popularity1 =</span> <span class="fu">case_when</span>( popularity1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>, popularity1 <span class="sc">==</span> <span class="dv">70</span> <span class="sc">~</span> <span class="dv">2</span>, popularity1 <span class="sc">==</span> <span class="dv">80</span> <span class="sc">~</span> <span class="dv">3</span>,  popularity1 <span class="sc">==</span> <span class="dv">90</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">5</span> ),</span>
<span id="cb1-88"><a href="#cb1-88" tabindex="-1"></a>         <span class="at">times =</span> <span class="fu">case_when</span>(time_signature <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb1-89"><a href="#cb1-89" tabindex="-1"></a>         <span class="at">energy =</span> <span class="fu">round</span>(energy<span class="sc">*</span><span class="dv">10</span>),</span>
<span id="cb1-90"><a href="#cb1-90" tabindex="-1"></a>         <span class="at">popular_artist =</span> <span class="fu">case_when</span>(artist_streams <span class="sc">&gt;</span> <span class="dv">75000</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">between</span>(artist_streams, <span class="dv">50000</span>,<span class="dv">75000</span>) <span class="sc">~</span> <span class="dv">2</span>, <span class="fu">between</span>(artist_streams, <span class="dv">25000</span>,<span class="dv">50000</span>) <span class="sc">~</span> <span class="dv">3</span>, artist_streams <span class="sc">&lt;</span> <span class="dv">25000</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span> ),</span>
<span id="cb1-91"><a href="#cb1-91" tabindex="-1"></a>         <span class="at">diff =</span> peak_monthly_listeners <span class="sc">-</span> monthly_listeners,</span>
<span id="cb1-92"><a href="#cb1-92" tabindex="-1"></a>         <span class="at">current_hit =</span> <span class="fu">ifelse</span>(diff<span class="sc">&gt;</span><span class="dv">20000000</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb1-93"><a href="#cb1-93" tabindex="-1"></a>         <span class="at">current_trend =</span> <span class="fu">ifelse</span>(daily_average<span class="sc">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-94"><a href="#cb1-94" tabindex="-1"></a>  </span>
<span id="cb1-95"><a href="#cb1-95" tabindex="-1"></a></span>
<span id="cb1-96"><a href="#cb1-96" tabindex="-1"></a>   <span class="fu">distinct</span>(<span class="fu">across</span>(<span class="fu">c</span>(daily1, monthly_listeners, artist_streams, streams, months_sincepk, explicit, daily, popular_artist))) <span class="sc">|&gt;</span> </span>
<span id="cb1-97"><a href="#cb1-97" tabindex="-1"></a>  </span>
<span id="cb1-98"><a href="#cb1-98" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(daily, daily1, monthly_listeners, artist_streams, streams, months_sincepk, explicit,  popular_artist)</span>
<span id="cb1-99"><a href="#cb1-99" tabindex="-1"></a> </span>
<span id="cb1-100"><a href="#cb1-100" tabindex="-1"></a></span>
<span id="cb1-101"><a href="#cb1-101" tabindex="-1"></a> </span>
<span id="cb1-102"><a href="#cb1-102" tabindex="-1"></a> </span>
<span id="cb1-103"><a href="#cb1-103" tabindex="-1"></a>dt<span class="sc">$</span>daily1 <span class="ot">&lt;-</span> <span class="fu">log</span>(dt<span class="sc">$</span>daily1)</span>
<span id="cb1-104"><a href="#cb1-104" tabindex="-1"></a>dt<span class="sc">$</span>monthly_listeners <span class="ot">&lt;-</span> <span class="fu">log</span>(dt<span class="sc">$</span>monthly_listeners)</span>
<span id="cb1-105"><a href="#cb1-105" tabindex="-1"></a>dt<span class="sc">$</span>artist_streams <span class="ot">&lt;-</span> <span class="fu">log</span>(dt<span class="sc">$</span>artist_streams)</span>
<span id="cb1-106"><a href="#cb1-106" tabindex="-1"></a>dt<span class="sc">$</span>streams <span class="ot">&lt;-</span> <span class="fu">log</span>(dt<span class="sc">$</span>streams)</span>
<span id="cb1-107"><a href="#cb1-107" tabindex="-1"></a>dt<span class="sc">$</span>daily <span class="ot">&lt;-</span> <span class="fu">log</span>(dt<span class="sc">$</span>daily)</span>
<span id="cb1-108"><a href="#cb1-108" tabindex="-1"></a></span>
<span id="cb1-109"><a href="#cb1-109" tabindex="-1"></a></span>
<span id="cb1-110"><a href="#cb1-110" tabindex="-1"></a> </span>
<span id="cb1-111"><a href="#cb1-111" tabindex="-1"></a> </span>
<span id="cb1-112"><a href="#cb1-112" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>((daily1) <span class="sc">~</span> </span>
<span id="cb1-113"><a href="#cb1-113" tabindex="-1"></a>             </span>
<span id="cb1-114"><a href="#cb1-114" tabindex="-1"></a>             explicit <span class="sc">+</span></span>
<span id="cb1-115"><a href="#cb1-115" tabindex="-1"></a>             </span>
<span id="cb1-116"><a href="#cb1-116" tabindex="-1"></a>             <span class="do">###</span></span>
<span id="cb1-117"><a href="#cb1-117" tabindex="-1"></a>             </span>
<span id="cb1-118"><a href="#cb1-118" tabindex="-1"></a>             (monthly_listeners) <span class="sc">+</span> </span>
<span id="cb1-119"><a href="#cb1-119" tabindex="-1"></a>             </span>
<span id="cb1-120"><a href="#cb1-120" tabindex="-1"></a>             (artist_streams) <span class="sc">+</span> </span>
<span id="cb1-121"><a href="#cb1-121" tabindex="-1"></a>             </span>
<span id="cb1-122"><a href="#cb1-122" tabindex="-1"></a>             (streams)</span>
<span id="cb1-123"><a href="#cb1-123" tabindex="-1"></a>             </span>
<span id="cb1-124"><a href="#cb1-124" tabindex="-1"></a>             </span>
<span id="cb1-125"><a href="#cb1-125" tabindex="-1"></a>, dt)</span>
<span id="cb1-126"><a href="#cb1-126" tabindex="-1"></a></span>
<span id="cb1-127"><a href="#cb1-127" tabindex="-1"></a></span>
<span id="cb1-128"><a href="#cb1-128" tabindex="-1"></a> </span>
<span id="cb1-129"><a href="#cb1-129" tabindex="-1"></a>b <span class="ot">&lt;-</span>(<span class="fu">coef</span>(mylm))</span>
<span id="cb1-130"><a href="#cb1-130" tabindex="-1"></a></span>
<span id="cb1-131"><a href="#cb1-131" tabindex="-1"></a><span class="co">#summary(mylm)</span></span></code></pre></div>
<div id="section"
class="section level1 tabset tabset-fade tabset-pills">
<h1 class="tabset tabset-fade tabset-pills"></h1>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<div id="section-1"
class="section level3 tabset tabset-fade tabset-panel">
<h3 class="tabset tabset-fade tabset-panel"></h3>
<div id="actual-model-representation" class="section level4">
<h4>Actual Model Representation</h4>
<p><br></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">y=</span>(daily1), <span class="at">x=</span>(monthly_listeners)))<span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> F, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)<span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="co">#geom_smooth( col=&quot;skyblue&quot;, method = &quot;lm&quot;, formula = &quot;(y)~(x)&quot;)+</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">log</span>(<span class="dv">50000000-5000000</span>), <span class="at">y =</span> <span class="fu">log</span>(.<span class="dv">75</span>), </span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Subset being measured:&quot;</span>, <span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size=</span><span class="fl">3.2</span>) <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  </span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) </span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> b[<span class="dv">4</span>] <span class="sc">*</span> <span class="fl">8.156</span> <span class="sc">+</span> b[<span class="dv">5</span>] <span class="sc">*</span> <span class="fl">20.17</span>) <span class="sc">+</span> </span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>    (b[<span class="dv">3</span>]) <span class="sc">*</span> x, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;skyblue1&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">log</span>(<span class="dv">50000000-1000000</span>), <span class="at">y =</span> <span class="fu">log</span>(.<span class="dv">38</span>), </span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;2nd Quartile&quot;</span>, <span class="at">color =</span> <span class="st">&quot;skyblue1&quot;</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size=</span><span class="fl">3.2</span>) <span class="sc">+</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) </span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>    (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> b[<span class="dv">4</span>] <span class="sc">*</span> <span class="fl">9.030</span> <span class="sc">+</span> b[<span class="dv">5</span>] <span class="sc">*</span> <span class="fl">20.55</span>) <span class="sc">+</span> </span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>    (b[<span class="dv">3</span>]) <span class="sc">*</span> x, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;skyblue3&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">log</span>(<span class="dv">50000000-500000</span>), <span class="at">y =</span> <span class="fu">log</span>(.<span class="dv">48</span>), </span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;Median&quot;</span>, <span class="at">color =</span> <span class="st">&quot;skyblue3&quot;</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size=</span><span class="fl">3.2</span>) <span class="sc">+</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) </span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>    (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> b[<span class="dv">4</span>] <span class="sc">*</span> <span class="fl">9.916</span> <span class="sc">+</span> b[<span class="dv">5</span>] <span class="sc">*</span> <span class="fl">20.86</span>) <span class="sc">+</span> </span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>    (b[<span class="dv">3</span>]) <span class="sc">*</span> x, <span class="at">linewidth =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;steelblue4&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">log</span>(<span class="dv">50000000-1000000</span>), <span class="at">y =</span> <span class="fu">log</span>(.<span class="dv">6</span>), </span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>           <span class="at">label =</span> <span class="st">&quot;3rd Quartile&quot;</span>, <span class="at">color =</span> <span class="st">&quot;steelblue4&quot;</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size=</span><span class="fl">3.2</span>) <span class="sc">+</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>  </span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="dv">4500000</span>), <span class="fu">log</span>(<span class="dv">10000000</span>), <span class="fu">log</span>(<span class="dv">25000000</span>), <span class="fu">log</span>(<span class="dv">50000000</span>), <span class="fu">log</span>(<span class="dv">100000000</span>)), </span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;4.5 M&quot;</span>, <span class="st">&quot;10 M&quot;</span>, <span class="st">&quot;25 M&quot;</span>, <span class="st">&quot;50 M&quot;</span> ,<span class="st">&quot;100 M&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">log</span>(.<span class="dv">5</span>), <span class="fu">log</span>(<span class="fl">1.5</span>), <span class="fu">log</span>(<span class="dv">6</span>), <span class="fu">log</span>(<span class="dv">20</span>), <span class="fu">log</span>(<span class="dv">70</span>)), </span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;.5 M&quot;</span>, <span class="st">&quot;1.5 M&quot;</span>, <span class="st">&quot;6 M&quot;</span>, <span class="st">&quot;20 M&quot;</span> ,<span class="st">&quot;70 M&quot;</span>)) <span class="sc">+</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>  <span class="fu">labs</span>( </span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Artist Monthly Followers vs. Artist Daily Streams&quot;</span>, </span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;These lines represent a 2D version of the actual high dimensional model&quot;</span>,</span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">&quot;Artist Monthly Followers&quot;</span>,</span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Artist Daily Streams&quot;</span>,</span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>    <span class="at">caption=</span> <span class="st">&quot;Log scale&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>),</span>
<span id="cb2-39"><a href="#cb2-39" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb2-40"><a href="#cb2-40" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb2-41"><a href="#cb2-41" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb2-42"><a href="#cb2-42" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/graphs%20actual-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><br></p>
<p><span class="math display">\[ \text{Regression Equation :} \\\
\\  \text{Artist Daily Streams}_{Y_i} = \\\ \ \text{b0} + \text{Monthly
followers}_{b_1} + \text{Explicit (or not)}_{b_2} + \text{All time
artist streams}_{b_3} + \\\ \ \text{All time streams per song}_{b_4}
\]</span></p>
<p><br></p>
<p>You may be wondering why the least square lines of this model look as
if they’re not fitting the data very well. Maybe I did a bad job
graphing the model? or maybe the model is not that good? It was
interesting to me at first. Considering that we’re used to the
<strong>simple idea</strong> (see the other tab) that the line should be
directly in the middle of the points; I was shocked when I realized that
even when these lines look as if they’re not fitting the data well
enough, they’re actually a correct representation of this model.</p>
<p>This is because this model has many dimensions to it. Differently
from the simple idea where only two dimensions are considered, here we
are looking at 3 and some subgroups that could make it 4 dimensional.
Because of this, there is not a “one line fits all scenarios” case in
this model, but actually there are infinite least squares lines
according to different scenarios. A couple examples are shown in the
graph above. The 3 least square lines shown in the graph portray subsets
of the data where all time artist streams, and all time streams per song
meet their respective quartiles as examples (see graph legend). In other
words, what if my artist has “x” amount of followers, and “z” amount of
all time streams, and has a song with “q” reproductions. Well there will
certainly be a line for that type of artist and if many fall into that
category we would be able to predict their daily streams.</p>
<p>This is a high dimensional regression. The actual model (1st graph)
and their near to infinite possible scenarios could be overwhelming to
understand, that’s why from this point on in this analysis, all details
for any scenario being considered will be disclosed in the different
tabs of the analysis.</p>
<p>This analysis will explain the relationship between artist monthly
followers and their daily streams on Spotify, we could estimate their
daily revenue as well; Spotify does not share all of its information
publicly, (no revenue data) only some variables were available to
perform a regression model on this data. This is why more research was
needed in order to find variables. By looking up related Spotify data I
came across with data that not only had information on how the song was
made (duration, decibel levels, etc..), but it also had Monthly
followers for more than 3000 artists as well as daily streamings, and
other interesting variables which led me to continue an analysis on
it.(See model selection tab)</p>
<p>If the correlation is proven true, then an artist can focus their
efforts on getting more followers so their streams go up and thus their
<a
href="https://dittomusic.com/en/blog/how-much-does-spotify-pay-per-stream#:~:text=Spotify%20pays%20artists%20between%20%240.003,holders%20and%2030%25%20to%20Spotify.">earnings</a>.</p>
<p>Thus, this analysis will consider the next hypothesis:</p>
<p><br></p>
<p><span class="math display">\[
\left.\begin{array}{ll}
H_0: \beta_1 = 0 \\  
H_a: \beta_1 \neq 0
\end{array}
\right\} \ \text{Slope Hypotheses} \\ \text{alpha level:} \ .05
\]</span></p>
<p><br></p>
<p>The null hypothesis being a slope of zero will help us test if the
correlation is non existent. IF the slope of this model was zero, then
no correlation would be found between these two variables. A T-test will
be performed to test for a significant difference between zero and the
actual slope of the model. If the results are significant at the
<strong>alpha level of .05</strong>, Then it would be safe to assume
that correlation has been found between these two variables and in the
model as well.</p>
<p>Such hypothesis can be tested by using the slope coefficient of the
model summary. However, it’s crucial to understand that even when there
are almost infinite lines in this model, all of them share the same
slope. So, for each specific scenario that we try to analyze there will
be a single slope (as seen in the first graph). There’s only one slope
when we test monthly followers as the main predictor because all of
these lines are only shifting in their intercepts.</p>
<p>There would be different slopes if we tested a null hypothesis on the
rest of the variables. Since, Monthly followers is the best predictor in
this model, we will stick to it and test the null at the <strong>.05
alpha level.</strong></p>
<p>To start the hypothesis testing, a corresponding T value is needed
for the comparison between our selected line slope, and the slope that
is being hypothesized which is of 0, meaning no correlation. After that,
a P value for the slope in the model can be calculated while is tested
against the null hypothesis. For this we will use the artist monthly
followers slope.</p>
<p><br></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>tvalue <span class="ot">&lt;-</span> ((b[<span class="dv">3</span>]) <span class="sc">-</span> <span class="dv">0</span>)<span class="sc">/</span>(<span class="fl">0.03272</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="fu">round</span>(<span class="fu">pt</span>(<span class="sc">-</span><span class="fu">abs</span>(tvalue), <span class="dv">876</span> ) <span class="sc">*</span> <span class="dv">2</span>, <span class="dv">5</span>), <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">kable</span>(result, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>, <span class="at">col.names =</span> <span class="st">&#39;P. Value when 0 streams increase per new monthly follower is the null &#39;</span>)</span></code></pre></div>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">P. Value when 0 streams increase per new monthly
follower is the null</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>As we can see, there is a significant difference between the model’s
estimated slope for this correlation and zero. It is then safe to assume
that, it is reasonable to explain the amount of monthly streams per
artist (which can lead to more earnings) by their monthly followers.</p>
<p>Spotify’s follower count increases their monthly streams. What I mean
by this is that the slope of these lines actually mean streams per one
follower gained in a month. So, in this case there is an increase of
<strong>3</strong> streams per follower in a monthly basis. This slope
is being tested to the 0 or no additional stream per new monthly
follower, and the results indicate that the slope of the model is of
significant value.</p>
<p>Keep on reading to see more on how the data was worked up in order to
get to these results.</p>
<p><br><br><br><br></p>
</div>
<div id="simple-idea" class="section level4">
<h4>Simple Idea</h4>
<p><br></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">y=</span>(daily1), <span class="at">x=</span>(monthly_listeners)))<span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> F, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>( <span class="at">col=</span><span class="st">&quot;skyblue&quot;</span>, <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;(y)~(x)&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  </span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="dv">4500000</span>), <span class="fu">log</span>(<span class="dv">10000000</span>), <span class="fu">log</span>(<span class="dv">25000000</span>), <span class="fu">log</span>(<span class="dv">50000000</span>), <span class="fu">log</span>(<span class="dv">100000000</span>)), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;4.5 M&quot;</span>,<span class="st">&quot;10 M&quot;</span>,<span class="st">&quot;25 M&quot;</span>,<span class="st">&quot;50 M&quot;</span> ,<span class="st">&quot;100 M&quot;</span>)) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>   <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">log</span>(.<span class="dv">5</span>), <span class="fu">log</span>(<span class="fl">1.5</span>), <span class="fu">log</span>(<span class="dv">6</span>), <span class="fu">log</span>(<span class="dv">20</span>), <span class="fu">log</span>(<span class="dv">70</span>)), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;.5 M&quot;</span>,<span class="st">&quot;1.5 M&quot;</span>,<span class="st">&quot;6 M&quot;</span>,<span class="st">&quot;20 M&quot;</span> ,<span class="st">&quot;70 M&quot;</span>))<span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a> </span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="fu">labs</span>( </span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Artist Monthly Followers vs. Artist Daily Streams&quot;</span>, </span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;March 2023, Spotify Measurements&quot;</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">&quot;Artist Monthly Followers&quot;</span>,</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Artist Daily Streams&quot;</span>,</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>    <span class="at">caption=</span> <span class="st">&quot;Log scale&quot;</span>) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>),</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey45&quot;</span>),</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey45&quot;</span>),</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/graphs%20simple-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>While this is not the actual model being used, it gives an idea of
how the model would look like if it was 2D only, it also portrays how
linear the data is and looks when transformed with log scales on x and
y. However, a better prediction can be achieved when using the rest of
the variables shown in the actual model.</p>
<p><br><br><br><br></p>
</div>
</div>
<div id="section-2" class="section level3">
<h3></h3>
</div>
</div>
<div id="model-selection" class="section level2">
<h2>Model Selection</h2>
<p><br></p>
<div id="section-3"
class="section level3 tabset tabset-fade tabset-panel">
<h3 class="tabset tabset-fade tabset-panel"></h3>
<div id="data-collection" class="section level4">
<h4>Data Collection</h4>
<p><br></p>
<p>I found many interesting data variables for Spotify, some of them I
found in <a
href="https://www.kaggle.com/code/adrianograms/spotify-regression/input">Kaggle</a>
and the rest I found in <a href="https://kworb.net/">Kworb’s Project</a>
on the Spotify section. Here are the variables I was able to find that
are available in Spotify, other than artist’s name, albums, and
songs;</p>
<p><strong>Kaggle:</strong></p>
<ol style="list-style-type: decimal">
<li><p><span style="color: #0047AB;"><strong>key</strong> - if certain
Keys were present in the song</span></p></li>
<li><p><span style="color: #0047AB;"><strong>loud</strong> - song’s
decibel level</span></p></li>
<li><p><span style="color: #0047AB;"><strong>mode</strong> - major or
minor scale</span></p></li>
<li><p><span style="color: #0047AB;"><strong>words</strong> - are there
too many words in the song?</span></p></li>
<li><p><span style="color: #0047AB;"><strong>acoustics</strong> - level
of acoustics</span></p></li>
<li><p><span style="color: #0047AB;"><strong>instrumental</strong> -
level of instrumentality</span></p></li>
<li><p><span style="color: #0047AB;"><strong>live</strong> - crowd
noises present</span></p></li>
<li><p><span style="color: #0047AB;"><strong>valence</strong> - level of
joy</span></p></li>
<li><p><span style="color: #0047AB;"><strong>tempo</strong> - beats per
minute</span></p></li>
<li><p><span style="color: #0047AB;"><strong>time_signature</strong> -
3/4, 4/4, etc..</span></p></li>
<li><p><span style="color: #0047AB;"><strong>track_genre</strong> -
genre</span></p></li>
</ol>
<p><br></p>
<p><strong>Kworb’s Project:</strong></p>
<p><br></p>
<ol start="12" style="list-style-type: decimal">
<li><p><span style="color: #0047AB;"><strong>daily</strong> - Monthly
streams per song</span></p></li>
<li><p><span style="color: #0047AB;"><strong>daily1</strong> - daily
streams per artist</span></p></li>
<li><p><span style="color: #0047AB;"><strong>monthly_listeners</strong>
- number of followers per artist</span></p></li>
<li><p><span
style="color: #0047AB;"><strong>peak_monthly_listeners</strong> - max
number of followers the artist had</span></p></li>
<li><p><span style="color: #0047AB;"><strong>months_sincepk</strong> -
number of months since peak monthly listeners</span></p></li>
<li><p><span style="color: #0047AB;"><strong>daily_average</strong> -
amount of followers the artist is getting or losing</span></p></li>
</ol>
<p><br></p>
<p>More variables were included in the final data set, and after deep
data analysis more were found. By pure logic we can infer that number of
followers will be important, as well as number of streams. But to be
sure about this, multiple pairs plot were used. Here are a couple of
them.</p>
<p><br><br><br><br></p>
</div>
<div id="model-selection-1" class="section level4">
<h4>Model Selection</h4>
<p><br></p>
<div id="section-4"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills"></h5>
<div id="original-pairs-plot" class="section level6">
<h6>Original Pairs Plot</h6>
<p><br></p>
<p>Take a look to the following pairs plot to understand more about the
process of selecting this final model. Consider which variables have a
larger correlation; Since no monetary values were available, I looked
for other types of correlation and tried to keep my model
business/industry related. I looked for variables which were related in
order to get good insights for spotify artists.</p>
<p>Originally, not many correlations were visible. A little on daily and
monthly_listeners can be visible but, it’s not too obvious. But was
enough to get me started on trying to find something there. At the same
time, the relation between streams and daily looked good to me. This is
why I tried both models. Take a look at my alternative model if you’re
curious about it.</p>
<p><br></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>dto <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(dta, df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;artist&quot;</span>), <span class="at">relationship =</span> <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">explicit =</span> <span class="fu">as.factor</span>(explicit),</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>         <span class="at">track_genre =</span> <span class="fu">as.factor</span>(track_genre)) <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(daily, daily1, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;...1&quot;</span>, title_id, artist, album, title))</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="fu">pairs</span>(dto, <span class="at">panel=</span>panel.smooth)</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/original%20pairs%20plot-1.png" width="1920" style="display: block; margin: auto;" /></p>
<p><br><br><br><br></p>
</div>
<div id="wrangled-pairs-plot" class="section level6">
<h6>Wrangled Pairs Plot</h6>
<p><br></p>
<p>After wrangling the data, and creating new variables such as
current_trend, peaked_last_year and others in where I create some on-off
switches, as well as multiple categorical variables I got many good
insights as to what to do next. This pairs plot helped me view the
correlation between daily1 and monthly_listeners and that got me my
first raw R<sup>2</sup> of around .7 Then I tried transforming the
data.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>dta1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://github.com/Tonadeleon/Regression-Projects/raw/main/Datasets/dataset.csv&quot;</span>)<span class="sc">|&gt;</span> </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="co">#filter(popularity &gt; 59) |&gt; </span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">title =</span> track_name,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>         <span class="at">artist =</span> artists,</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>         <span class="at">title_id =</span> track_id,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>         <span class="at">album =</span> album_name,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>         <span class="at">loud =</span> loudness,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>         <span class="at">words =</span> speechiness,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>         <span class="at">acoustics =</span> acousticness,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>         <span class="at">instrumental =</span> instrumentalness,</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>         <span class="at">live =</span> liveness) <span class="sc">|&gt;</span> </span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>  <span class="fu">inner_join</span>(df1, <span class="at">by=</span><span class="st">&quot;artist&quot;</span>, <span class="at">relationship =</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="fu">inner_join</span>(df2, <span class="at">by=</span><span class="st">&quot;artist&quot;</span>, <span class="at">relationship =</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>)</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a>dtal <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(dta1, df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;artist&quot;</span>), <span class="at">relationship =</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">explicit =</span> <span class="fu">as.factor</span>(explicit),</span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>         <span class="at">genre =</span> <span class="fu">as.factor</span>(track_genre),</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a>         <span class="at">track_genre =</span> <span class="fu">as.factor</span>(track_genre),</span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a>         <span class="at">daily =</span> daily,</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>         <span class="co">#streams = ifelse(streams&gt;3825666400, 942193161, streams),</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>         <span class="co">#times = as.factor(time_signature),</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>         <span class="co">#energy = ifelse(energy&gt;.5,1,0),</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>         <span class="co">#duration = ifelse(between(duration_ms, 200000, 250000), 1, 0),</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>         <span class="co">#loud = ifelse(loud&gt;-9, 1, 0),</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>         <span class="at">dance =</span> <span class="fu">ifelse</span>(danceability<span class="sc">&gt;</span>.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>         <span class="at">words =</span> <span class="fu">ifelse</span>(<span class="fu">between</span>(words, .<span class="dv">025</span>, .<span class="dv">06</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>         <span class="at">instrumental =</span> <span class="fu">ifelse</span>(instrumental<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>         <span class="co">#popularity = ifelse(popularity&gt;76,1,0),</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a>         <span class="at">live =</span> <span class="fu">ifelse</span>(live<span class="sc">&lt;</span>.<span class="dv">37</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>         <span class="at">key =</span> <span class="fu">case_when</span>(key <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>         <span class="at">explicit =</span> <span class="fu">case_when</span>(explicit <span class="sc">==</span> <span class="st">&quot;TRUE&quot;</span> <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>), </span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a>         <span class="at">genre =</span> <span class="fu">case_when</span>(genre <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;pop&quot;</span>, <span class="st">&quot;chill&quot;</span>, <span class="st">&quot;indie&quot;</span>, <span class="st">&quot;garage&quot;</span>, <span class="st">&quot;ambient&quot;</span>, <span class="st">&quot;folk&quot;</span>, <span class="st">&quot;indie-pop&quot;</span>, <span class="st">&quot;power-pop&quot;</span>, <span class="st">&quot;reggae&quot;</span>, <span class="st">&quot;soul&quot;</span>, <span class="st">&quot;synth-pop&quot;</span>, <span class="st">&quot;swedish&quot;</span>, <span class="st">&quot;country&quot;</span>, <span class="st">&quot;metal&quot;</span>, <span class="st">&quot;german&quot;</span>, <span class="st">&quot;funk&quot;</span>, <span class="st">&quot;alternative&quot;</span>, <span class="st">&quot;alt-rock&quot;</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a>         <span class="at">peak_last_year =</span> <span class="fu">ifelse</span>(months_sincepk<span class="sc">&lt;</span><span class="dv">13</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">ifelse</span>(popularity <span class="sc">&gt;</span><span class="dv">79</span> ,<span class="dv">1</span> ,<span class="dv">0</span>),</span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>         <span class="at">popularity0 =</span> <span class="fu">round</span>(popularity <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>,</span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a>         <span class="at">popularity0 =</span> <span class="fu">case_when</span>( popularity0 <span class="sc">&gt;</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">1</span>, popularity <span class="sc">==</span> <span class="dv">80</span> <span class="sc">~</span> <span class="dv">2</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">3</span> ),</span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a>         <span class="at">popularity1 =</span> <span class="fu">round</span>(popularity <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a>         <span class="at">popularity1 =</span> <span class="fu">case_when</span>( popularity1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>, popularity1 <span class="sc">==</span> <span class="dv">70</span> <span class="sc">~</span> <span class="dv">2</span>, popularity1 <span class="sc">==</span> <span class="dv">80</span> <span class="sc">~</span> <span class="dv">3</span>,  popularity1 <span class="sc">==</span> <span class="dv">90</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">5</span> ),</span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a>         <span class="at">times =</span> <span class="fu">case_when</span>(time_signature <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a>         <span class="at">energy =</span> <span class="fu">round</span>(energy<span class="sc">*</span><span class="dv">10</span>),</span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a>         <span class="at">popular_artist =</span> <span class="fu">case_when</span>(artist_streams <span class="sc">&gt;</span> <span class="dv">75000</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">between</span>(artist_streams, <span class="dv">50000</span>,<span class="dv">75000</span>) <span class="sc">~</span> <span class="dv">2</span>, <span class="fu">between</span>(artist_streams, <span class="dv">25000</span>,<span class="dv">50000</span>) <span class="sc">~</span> <span class="dv">3</span>, artist_streams <span class="sc">&lt;</span> <span class="dv">25000</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span> ),</span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a>         <span class="at">diff =</span> peak_monthly_listeners <span class="sc">-</span> monthly_listeners,</span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a>         <span class="at">current_hit =</span> <span class="fu">ifelse</span>(diff<span class="sc">&gt;</span><span class="dv">20000000</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a>         <span class="at">current_trend =</span> <span class="fu">ifelse</span>(daily_average<span class="sc">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(daily, daily1, <span class="fu">everything</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;...1&quot;</span>, title_id, artist, album, title))</span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" tabindex="-1"></a><span class="fu">pairs</span>(dtal, <span class="at">panel=</span>panel.smooth)</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/alternative%20pairs%20plot-1.png" width="1920" style="display: block; margin: auto;" /></p>
<p><br><br><br><br></p>
</div>
<div id="variables-selected" class="section level6">
<h6>Variables Selected</h6>
<p><br></p>
<p>After considering multiple variables within all the options available
in the pairs plots; and after getting all the data that I got. I found
the most significant model as compared to others I tried in the process
of finding correlations in this data set.</p>
<p>These are the variables I used.</p>
<p><br></p>
<p><strong>Response:</strong></p>
<p><br></p>
<ol style="list-style-type: decimal">
<li><span style="color: #0047AB;"><strong>daily1</strong> - Max count of
daily streams per artist</span></li>
</ol>
<p><br></p>
<p><strong>Explanatory:</strong></p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li><p><span style="color: #0047AB;"><strong>explicit</strong> - 1-0
categorical variable. Songs in 0 group (no curse words) tend to have
higher streams</span></p></li>
<li><p><span style="color: #0047AB;"><strong>monthly_listeners</strong>
- Monthly followers count updated in march 2023 (Main explanatory
variable)</span></p></li>
<li><p><span style="color: #0047AB;"><strong>artist_streams</strong> -
Monthly artist streams updated in march 2023 </span></p></li>
<li><p><span style="color: #0047AB;"><strong>streams</strong> - Song
specific max streams count </span></p></li>
<li><p><span style="color: #0047AB;"><strong>daily</strong> - Song
specific daily streams </span></p></li>
</ol>
<p><br></p>
<p>When considering all this variables in the model its significance got
really high up. It was also maintained even when validations where
run.</p>
<p>Other than my alternative model which I added in this html, I
could’ve also analyzed some plots like <code>loud~energy</code>
<code>energy~acoustics</code> <code>loud-acoustics</code>. I did not
venture into those ones; While I was trying to predict more on a
industry level type of scenario probably business related, I cannot deny
that these graphs are also useful scenarios because they may increase a
song’s quality. But that’s pay for another check.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>dtwhat <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(dta, df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;artist&quot;</span>), <span class="at">relationship =</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>track_genre) <span class="sc">|&gt;</span> </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">explicit =</span> <span class="fu">as.factor</span>(explicit))<span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;...1&quot;</span>, title_id, artist, album, title)) </span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>g11 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dtwhat, <span class="fu">aes</span>((loud),(energy)))<span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span><span class="st">&quot;steelblue&quot;</span>)<span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="co">#geom_smooth(se=F)+</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Loudness (decibel level)&quot;</span>,</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Energy level (expert rating)&quot;</span>)</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>g22 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dtwhat, <span class="fu">aes</span>((energy),(acoustics)))<span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span><span class="st">&quot;purple&quot;</span>)<span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>  <span class="co">#geom_smooth(se=F,col=&quot;purple&quot;)+</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Energy level (expert rating)&quot;</span>,</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Acousticness level (expert rating)&quot;</span>)</span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>g33 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dtwhat, <span class="fu">aes</span>((acoustics),(loud)))<span class="sc">+</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span><span class="st">&quot;forestgreen&quot;</span>)<span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>  <span class="co">#geom_smooth(se=F,col=&quot;grey50&quot;)+</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Acousticness level (expert rating)&quot;</span>,</span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Loudness (decibel level)&quot;</span>)</span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="fu">grid.arrange</span>(g11,g22,g33, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">top =</span> <span class="st">&quot;Other Possible Models&quot;</span>)</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/unnamed-chunk-1-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><br><br><br><br></p>
</div>
<div id="final-dataset-used" class="section level6">
<h6>Final Dataset Used</h6>
<p><br></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">datatable</span>(dt)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-9c80554cbdb488febe4b" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9c80554cbdb488febe4b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857"],[13.7873065375912,12.64245485627306,14.00579697752363,12.80457117742581,14.05754102331958,14.84540493733986,13.69310786811801,13.61720473066248,14.00327394775646,13.9204793969268,14.15852704845326,13.5834006790069,12.69724745047649,13.41341975049506,12.59319386186996,13.81848512953645,12.68597091100885,14.34310125916294,13.46266114448691,13.62692180324815,13.70832838409418,13.64482424838801,12.56557758126196,13.06308035524049,13.05131840179125,13.32572209326408,13.81475827507044,12.89519172416968,13.14098687843173,12.94611533939875,12.9158015856818,13.11846378386322,12.59823296955926,12.78477651982391,13.14770358513774,13.24873520137376,13.04447318474058,13.38954218717227,14.07433548945265,12.94192245111574,13.28264721093503,13.48399223044774,13.2877744207063,12.23489331133837,13.4647069155808,12.99349993009394,13.62408125124612,12.44060707377106,12.44373035500241,13.41156429582538,13.30006260099057,13.45888561277558,14.07396410862592,12.93291085560756,12.81294272490856,13.05656326078974,12.84115629687445,12.88485463908534,13.56999869078806,13.1179556777525,12.87185890673347,12.58974194126788,13.48937451833437,12.33506374661248,12.67073076295114,12.55927556897553,12.39957727139306,13.34446158253455,13.31628407004164,12.87841744921082,12.52057676902515,13.352663658128,12.58114383611841,13.10476543799679,12.52554767312969,13.15579428501113,12.70852228850333,12.48064288233495,14.52039459140803,14.89685223108725,12.360881680023,12.88555944650942,13.29036117048076,14.04227873238829,12.65864078110698,12.95214666052433,13.22714312444871,13.82709816161593,12.61291680231346,13.66187557847407,13.71286524170297,13.68631148157661,14.25152232973274,14.48652715363623,13.64918793299196,13.73934631929673,12.17024337492876,13.43650235881847,14.12050908150048,12.99272610711967,13.38129251781393,13.11968579588024,13.08607276730329,12.86100380806162,12.81345494462932,12.95613404344987,12.72177535694621,13.63742402080181,14.33731172944324,13.90179283589243,13.76959121902986,13.62475311896067,12.31982981045524,13.26324121867179,12.78121864164102,13.26324121867179,13.1806643604856,12.52334385956908,12.74205418917728,12.8349585998361,12.32580932713251,12.15305154355292,12.25480090302152,12.95162724960526,12.36667248475161,12.61776499075409,13.29084121727763,12.67670732562143,12.78193291734243,13.94444012842848,14.25112587915663,12.99261681327166,14.39057384511468,14.2798066803361,14.14263567462119,13.54978695723987,12.50536209102367,14.10368725806763,12.96692987511206,13.18618289011728,12.83845285039185,13.79540682534043,13.77530399902469,12.32249920603443,12.54652978899607,13.25416502488191,12.41607421809744,12.69799064136854,12.66194565618218,12.54665428412403,12.94087986934941,12.37765760411044,12.69786528574824,12.86263882582712,14.5039953866333,12.01303386389501,14.13999913363135,14.16325191598948,13.48446715850368,14.00325322727207,13.91228693510305,12.64974834140209,12.60161872229533,11.51793290678077,12.24865788462066,12.2548294758107,12.7955329091843,12.76735561437543,12.22320995932603,13.23285948331493,13.51083151866755,12.87120350860706,13.52146964419951,13.13568623272012,12.24808752827627,12.14815747483374,13.43565325328765,11.77665034184624,13.25888529395136,12.79291720011904,13.3195932509314,13.08602506613657,13.1303771809329,12.39751085242872,13.95359021652797,12.49796583875342,12.70130228167161,13.6418057699574,13.20155710941538,13.82332196929576,13.09520387454067,13.34312810155142,13.58265247299455,12.69669964360297,12.7926808385292,12.83862551631427,13.92501766461843,13.77700670780331,13.85072904210361,12.83707842955227,12.61645564098229,12.78906450034736,13.83279039786353,12.91778148762828,13.94554710070908,12.6648194032701,12.58931600262046,14.33651084385493,13.26307443444502,12.14716623424423,13.81723207530261,12.74568395722786,13.79037734832528,12.1266343385031,12.53209764214503,13.92492175850954,13.6125237379107,13.38512448619562,13.3048465877983,13.88874057339819,12.54931477179147,13.61244165576848,13.61244165576848,12.63441082568951,12.24179204392086,12.51448706001824,12.83340582520732,13.83913821344517,13.1441953168022,12.97453367802134,13.42010221068897,13.71145363670239,13.09692863950708,10.99080293746194,13.21668579680666,12.75016281812861,13.06900057463974,13.72549284829991,13.1856874113508,12.04569847321904,12.36631899467227,12.01344617502598,12.67211217811648,13.04155237466771,12.86805418357192,13.05188940963558,12.56446361625237,11.66187981006209,13.13790596320303,12.70784137920591,12.76983980458807,13.30996264919365,12.30633418346818,12.89092048160861,12.94028019219761,12.53567850530554,12.64216717996833,12.82358800115459,13.37497873688495,13.23705185206431,12.85022914181788,12.07040182309977,13.66265187648093,13.12808895495747,13.35564100506571,13.66807958359381,11.99284229566697,13.5153604144765,13.57286303475192,14.1115111851018,12.24284806369279,13.94571479674592,13.59995812109588,12.16691073064824,13.45481324943851,12.75016281812861,12.05293312097973,14.35874141447894,11.6738701560046,13.39673222079398,13.01173344717965,13.09365521326758,13.59752493165496,12.42762292826582,12.48067707718862,13.28600487658492,12.85457543133053,12.15196486788194,12.69150968957685,11.91119138768502,12.55965832259397,12.00085496149928,14.31448665254111,11.70360367414523,12.32795836477016,13.23027743000983,12.85684454250744,12.32218317221173,13.34838917106457,12.58615156724792,14.15292877557578,13.16252019074063,13.06114095193889,12.53955470172882,13.5320449171911,13.29872554559681,12.79528884371808,12.86923473299954,13.32629801314067,13.00414499699917,12.41399696970363,13.39571323254585,12.73587114067539,12.63755631603689,12.63709503294708,13.41601907219379,12.16622413535357,13.24152679323081,12.84055203842427,12.88954568209385,13.26659185169718,12.9976116164878,11.32315624304112,13.41017494147171,11.45553996652499,11.92879624579227,12.50144383084126,11.20563914554359,11.97824313222525,12.51936398348837,12.46026127267471,11.70742259769432,13.35351636735741,12.43904770875767,13.23846856181077,13.30633856619494,13.39954198105035,13.62318472486212,12.48438218267279,12.58537856615254,12.21979802014865,12.14376097644942,12.60635434294618,13.63777765716696,13.32233655693152,12.89244442480984,12.10146184876289,12.3493934649744,13.01994741119148,13.91643856455205,13.15807988105779,11.73312067419226,11.40954077386265,12.96517609175281,13.60624402391,11.60516730586999,12.06301603168058,12.43140978916059,13.75692017817382,11.81635046468791,12.97147536927052,12.08221997686286,12.20438622432096,12.01928513117662,12.22388309367614,11.49696883234597,11.51175477998589,12.01462154094845,13.19866123572037,11.50454040843579,11.96164161507271,13.3865183452973,14.18099151490784,12.97705317184311,13.43659438718957,12.52004726949937,12.63005196958962,13.6243379458923,13.06701767255543,13.185347566193,13.41438651378883,11.89126600568174,12.24262634382048,12.54773140883869,13.23417662930767,13.28819640919346,12.72095104569218,13.15688653584249,13.03704511174699,12.57994732236876,10.41592188164153,13.05980050339013,12.53994865773261,12.82236307951512,13.62718139156668,13.185347566193,12.64490160522368,14.95765540425507,13.67597488998713,13.54646180198017,13.77062197272758,14.1396130321238,13.52709354884602,13.65815591759937,13.32584937889811,12.91445813112889,12.53986271693145,13.04756008664957,13.37765499727421,12.62080798528966,12.87586675341542,13.00443758155819,12.39708135947158,12.81712271791358,12.3266251759265,12.75178653401039,13.38098835174,12.53331671904374,12.20224031150995,13.59702738021965,12.71316430672662,13.71746764765086,12.68202106941673,12.43049138344824,12.03043867688604,13.30991622709407,12.40625049228963,12.41970712862054,13.34120167439665,12.73262790733911,12.54461416827276,13.60110001270555,13.27598706125074,13.27483550639589,13.04821509674592,13.59424648931547,14.8291475771864,14.00926402080397,14.31963115318237,14.00986196507955,13.24776884393678,12.88771135696975,12.53960843214186,13.31336713458112,13.1536333361414,13.4978997215102,12.79209386405964,13.22488927933802,13.50917016324951,12.43032757903035,13.27418105217616,12.93803420670151,13.34241736091535,13.88248579539586,13.77518010928223,13.08982572278426,12.99380474295485,13.66896108231445,13.92675582446075,12.1953604745505,12.60170288278607,12.98884341328593,13.43185488569377,12.95068972988131,14.02143063311076,12.86775495845954,12.66075957066402,12.91903961010187,12.77522283624852,12.30657387395203,13.28778289612293,12.58221535678417,13.58397564746883,12.55810533084087,13.08261996766899,12.58221535678417,12.66177132004582,13.50733321839673,12.79482828526895,12.58718358376977,13.25944346595259,14.12313862978691,12.48201355955387,11.59600662878016,13.66291167347958,12.48629571868355,13.79357778351472,13.53958839920469,12.18555866528247,12.07663002532845,12.29346519986249,13.01987872249197,12.34519090252347,13.93909804846496,14.38542626203402,13.94941800487152,14.03031463230327,12.51320801956513,12.04562803373534,12.15830470870829,12.4655288395027,13.69951479917663,13.48850259349478,12.61550985439074,11.81609203145639,12.06343131168332,12.90613337235919,13.50882913550271,11.48051590317218,12.67939264453759,13.78772406425572,12.53386085633831,12.42164762734443,13.46618426074425,12.13868206112398,11.1614370477188,12.3587765650185,13.07135846248405,12.18014952617679,13.52171114602,14.0160403344069,12.43477670850503,13.07035825077694,12.59903998080836,13.68866419919702,13.065727415298,14.15346455338135,13.60443020284029,12.07410003736964,13.3183872932895,13.62043075982366,12.8621978938454,13.89822998771107,12.72928227003435,12.96376147222281,12.92104491663197,13.19954846751368,12.67295892087332,12.82264920872871,13.18199173841185,13.05738102445465,13.45459090368995,12.70293118206755,14.13180924136193,12.30190087294284,13.20723930928651,13.8780195209413,12.58479671111386,12.46066059886554,13.81916686551775,11.09937778066871,14.3676516224859,13.71999805769454,14.00526690806054,13.06894783263568,13.0267485512,12.80799503969004,12.84972228678988,12.43258252440046,12.81426360854013,12.72823872259017,10.48355001802591,12.66797794665649,11.37887965434116,13.21808256446287,11.2265891532428,12.77100854227128,12.362298313936,12.30549707745299,12.38640054965199,13.20828966589831,12.83613092041883,12.59493739360701,12.66206608885254,12.75046456477977,12.12156540330361,12.18216922144861,12.12565403388026,12.59183152169598,12.04206437221617,12.39182996001002,12.21087111444175,12.63930855058369,12.12698073570507,12.48180485188994,11.97710592241316,11.97002747509275,13.53778409687977,13.70740182496977,12.57794649864325,12.60147731672372,12.75115185899919,13.51927736197871,13.053165484902,14.2876812125137,13.30758073731031,13.2847900026422,12.90642629699028,13.01158376046027,12.85218062808433,13.50452573994266,13.32927022395659,13.89052618949913,13.30173726074102,12.97502974197276,12.73795892846772,12.66425669797057,12.89292253973765,13.67521347242555,13.32968319113157,13.135129542054,12.27393220839878,12.36505307190351,12.715717572548,11.87202546607946,13.56936830233666,12.71818044695497,12.35067935478588,13.71832431946181,11.53194347080599,12.88328097478861,12.39630036608273,11.65139962198391,13.06098572212935,12.47327901422062,12.21512158014879,13.44979198627856,12.4316372636954,12.06210411786827,11.512435344881,12.44722898804502,12.71548026440226,13.86609815340489,13.50462263381188,13.31960310290549,12.57735340335821,12.92419044881258,13.99518110393213,13.14709306247824,14.1841353176019,12.23518474607362,12.49514999413131,12.77502754503048,14.06241672858352,13.13358418798495,12.5253442239386,12.56179413507569,13.29708781570111,12.65461320721146,12.76183530540709,12.27256238679901,13.70801665714665,13.24579443292531,12.60686686198844,12.77415817798534,14.44911949513499,13.48908349918326,14.37509205959764,14.06420956902136,14.03980544623565,13.89098994643945,13.75032542782015,14.33618116049944,13.09556550029894,13.99810124520605,13.41703397314178,13.98755195451733,13.11093633675175,14.0007628160548,13.89567941152724,13.46556435376718,13.88963610139219,13.59889689047777,13.94134465225067,13.6243815290053,14.01269691744472,13.81025678101573,13.80397224693772,11.05081063714473,13.47689863384357,13.42028781727037,13.79617278260769,11.21919849220056,12.24258295809486,11.82171078912768,13.77486979702022,13.12030526093486,13.03741097018999,13.88856769246718,13.78338707975106,14.35392021987407,13.22384176735388,13.32603538260893,14.36758541297191,13.56569957037838,14.20633568933292,13.18897849093069,13.97003345422469,13.90611239818617,12.74170892369981,13.64128930494654,13.77663666466204,13.05502627722832,13.81993077439776,13.52760979493478,14.16420988102607,13.53289827903046,13.61113846521956,11.80303957761329,13.63327499747253,13.78732710948998,13.98505922088591,14.2030377391414,14.76470246130064,13.89578370062409,13.6007728285314,12.88383711655053,13.77535084408777,13.42674621251693,13.08076191250929,12.69293953734951,13.69725165910295,13.61113846521956,11.80303957761329,13.64513614893814,14.43879037763999,14.06784158044926,12.78796977891722,12.6860296996837,12.39500149269331,12.83975109847052,12.079443094592,12.43628316688436,13.10602868984784,13.38135272246345,12.47781586668045,13.17502034157146,12.89586169387046,12.71069808783441,12.71559742356312,13.12651873194781,12.84600099483524,12.80618580387257,13.27909871412632,12.60131905344401,13.20256730285081,13.49813462081709,13.86949672331803,13.64702444844278,13.00643611872816,12.66607328628635,12.99020703895934,12.79430643268046,12.4592758445157,13.57876745046612,13.00969399470959,12.33239687886367,13.79976931208196,12.0855984920623,12.3648739231157,11.88419242569842,12.60574433749755,13.73709485932675,12.73040760590295,12.96024201592474,13.30940710053361,13.35536695846498,12.48871453758551,12.746523088776,13.49693206906381,13.11770454186356,13.02307549702792,13.57741198570132,13.91007409546423,13.94660811621528,14.17847100666533,13.9182927526073,13.62196100244707,14.24089920109166,13.27602479470505,12.80789917751239,13.20571690594913,12.85884044193678,13.31791864772413,13.4595039620598,14.18246488752261,13.7444451831824,13.40319302553156,12.65158504815602,13.01118150604234,12.95859896673443,14.3666920196164,13.44478160315494,12.57408161603881,12.22943754783491,13.35238084910165,12.78595033903087,12.21760588134385,12.71607192797019,12.79762166832369,13.6741209416463,12.98787381159274,13.76079879568873,13.58096727592419,14.00249041467885,13.29279789580386,13.74128257860998,13.1340824401583,12.73308849737488,13.42724616570282,12.74188157133958,13.70760681103367,12.33066798025277,13.88087124103408,14.64067586173392,14.25964494516262,13.95700751606792,12.44399445842211,12.38599131770782,12.71444626559061,11.81004783724136,12.8411430495077,13.6360022402997,13.67151777820528,13.34598521432174,13.92562784223847,14.27149702926442,12.87966231874959,13.54604685199402,12.31110810836405,13.42394687573407,13.7502656540638,13.1275140896819,13.82587169551392,13.39816920562177,14.003119777066,13.35014893790334,12.50558076382887,13.89784417795469,13.21136094727299,12.6162101542871,12.8695386663632,12.73346035759514,13.33735216886249,13.06341347745805,13.53493517308141,13.24876340216338,12.99361822671375,13.19126611149569,13.77784711164134,12.84378903669434,13.30080909951216,12.7235322159322,13.91986787058216,13.01459997713019,13.35329889236816,14.38899656527106],[0.5838901946229957,0.5838901946229957,2.36631078387459,0.8329091229351039,2.36631078387459,2.36631078387459,2.36631078387459,0.3285840637722067,2.037837991824761,0.3886579897917832,1.319085611426441,2.09297455596242,1.319085611426441,1.319085611426441,2.09297455596242,2.36631078387459,1.144222799920162,2.047305671649765,-0.2433462586317292,2.047305671649765,0.4114471797857118,0.7227059828014898,0.8127064156175846,0.8127064156175846,0.8024499154503955,-0.05024121643674679,2.037837991824761,2.09297455596242,0.7438402948754634,0.07603468627599758,0.3763795272130678,0.3763795272130678,0.3947411447451887,-0.5041810810473222,0.1142211440900229,-0.06720874969344999,-0.004008021397538822,2.037837991824761,2.09297455596242,-0.2382571891242579,0.3321773123383321,2.09297455596242,-0.1289703812969601,0.3947411447451887,0.6291418505840328,0.3067491351690066,1.27954399117301,-0.03770186718401153,-0.5996568374726063,-0.1009259185899605,2.09297455596242,2.09297455596242,1.529961710932304,2.047305671649765,2.037837991824761,-0.7507762933965817,0.8329091229351039,1.27954399117301,1.308332819650179,0.8329091229351039,2.09297455596242,1.529961710932304,0.03149866705937102,0.9222728035517026,0.2715526905218973,1.11185751541813,1.319085611426441,1.193619392246444,-0.3797973613595865,1.442910961538787,1.11185751541813,1.308332819650179,1.27954399117301,0.03825871211709027,1.27954399117301,1.442910961538787,0.9222728035517026,-0.8891620644859025,3.48250083272619,3.48250083272619,0.2223432311434407,1.516225530711922,1.602413297497136,3.48250083272619,1.15404699555621,1.201770380770736,0.9719146356221521,0.7178397931503168,0.5743636445699783,1.516225530711922,1.725441588190407,3.48250083272619,3.48250083272619,3.48250083272619,3.48250083272619,3.48250083272619,-0.1438703704197019,3.48250083272619,1.725441588190407,1.516225530711922,1.725441588190407,1.725441588190407,1.602413297497136,1.256754989764905,1.725441588190407,1.256754989764905,1.602413297497136,2.088401283051308,2.088401283051308,2.088401283051308,2.088401283051308,0.9805792217565169,0.316998126785834,0.5771750043075246,0.2669690308542393,0.5771750043075246,-0.3382738585678411,-0.06935007813479317,0.5771750043075246,-0.1684186516249633,0.1151128071005047,-0.2587707289573609,-1.058430499035278,0.6662897263900627,-0.8462983600541201,-0.3652833184753326,0.4285303810391604,0.5670169034157331,0.1177830356563835,2.741227045796767,2.741227045796767,2.741227045796767,2.741227045796767,2.741227045796767,2.741227045796767,2.741227045796767,2.741227045796767,2.741227045796767,2.741227045796767,2.741227045796767,-0.4557063245449111,1.407321728311966,1.511604552085337,1.511604552085337,1.511604552085337,2.741227045796767,2.33068652310492,2.741227045796767,-0.5887871652357024,0.1414995622736994,-0.6443570163905132,1.407321728311966,-0.2433462586317292,-0.05762911283663642,1.550324647941594,0.6861225656229808,3.040849032357114,1.866557679303241,1.866557679303241,1.866557679303241,3.040849032357114,0.520577915208669,0.520577915208669,0.08892620919440149,-0.03666398437159147,0.1535790879283006,-0.2850189550322972,-0.02020270731751947,1.041689141268489,0.3499523981779056,1.820184943411759,0.2358623237219845,2.468014782117782,0.8028980445190645,-0.9213032736976993,1.069526707773013,2.917824784677466,0.08892620919440149,2.917824784677466,-0.3886079910417414,2.468014782117782,0.8028980445190645,2.917824784677466,1.061602463034209,2.656195345559933,2.324346584775558,0.9005677714089187,3.369087327743922,0.792087128414849,1.745540995426441,3.369087327743922,2.397713438085623,2.613446438393232,2.613446438393232,2.182110939526171,2.182110939526171,2.182110939526171,1.765757666689054,2.040570767290843,2.397713438085623,0.9005677714089187,1.572773928062509,2.040570767290843,1.350926217282099,3.502188364802039,2.613446438393232,2.397713438085623,3.502188364802039,1.702017093727194,0.06109509935981083,2.167108953431596,2.167108953431596,2.167108953431596,1.745540995426441,3.369087327743922,1.765757666689054,2.040570767290843,1.50341050778857,3.132751327212079,3.132751327212079,3.132751327212079,3.132751327212079,3.132751327212079,3.132751327212079,2.397713438085623,2.182110939526171,1.745540995426441,3.132751327212079,2.324346584775558,3.132751327212079,2.324346584775558,2.324346584775558,1.50341050778857,1.825677687431516,1.960939497598835,1.210153663401017,3.369087327743922,3.369087327743922,2.613446438393232,1.394262530769067,2.040570767290843,2.040570767290843,0.7774883289936962,0.8595087177751706,2.613446438393232,0.9760679359100157,1.845616142018766,1.569657042422256,1.210153663401017,2.064454799371513,1.825677687431516,1.142948102488161,2.428688969789772,-0.5041810810473222,0.4848922417394863,3.369087327743922,1.289783460739047,1.812052172495817,0.06109509935981083,1.765757666689054,0.9760679359100157,0.3660310388627573,1.740466174840505,1.740466174840505,1.740466174840505,0.4421184257561999,1.50341050778857,2.085796307317844,2.397713438085623,3.502188364802039,1.825677687431516,1.202371522958962,2.613446438393232,1.745540995426441,1.691754954923314,1.210153663401017,1.210153663401017,3.502188364802039,2.049368857423543,3.369087327743922,2.613446438393232,2.040570767290843,2.182110939526171,1.394262530769067,2.397713438085623,1.169070752316671,2.167108953431596,-0.02429269256904459,2.451952924644869,0.09166718852582387,3.369087327743922,0.6275414234619514,3.502188364802039,0.9005677714089187,3.369087327743922,1.764045630660539,1.493128790033717,1.825677687431516,2.324346584775558,1.691754954923314,1.072610486129109,1.126551657357351,-0.5327304591540407,0.1124354293297882,0.5353230953663781,0.1124354293297882,-0.583396316600826,1.072610486129109,0.1007499031001431,1.126551657357351,-0.583396316600826,0.5353230953663781,-0.6500876910994983,-0.623621117911335,-0.3566749439387324,1.631199404215613,-0.5361434317502807,0.01390290516899143,1.572773928062509,1.765757666689054,1.606633985101366,0.2941610385494901,0.4369637751675354,1.606633985101366,1.169070752316671,0.9329511727672622,-0.353821874956326,0.4369637751675354,0.2941610385494901,-0.1020327255651516,1.401182973613641,0.7217346374118577,-0.005012541823544286,0.7217346374118577,0.2279320680460069,3.702930277336596,0.80692219481879,1.616214896713124,1.616214896713124,3.702930277336596,3.702930277336596,3.702930277336596,3.702930277336596,3.702930277336596,3.702930277336596,0.7589349210979485,0.80692219481879,1.401182973613641,3.702930277336596,3.702930277336596,0.6841064359077962,0.6841064359077962,0.09166718852582387,3.702930277336596,0.4337285733810237,0.09166718852582387,0.09166718852582387,0.6275414234619514,2.513575088135685,-0.006018072325563021,3.702930277336596,1.702017093727194,3.702930277336596,3.702930277336596,3.702930277336596,0.7217346374118577,1.702017093727194,0.6841064359077962,2.513575088135685,0.4337285733810237,3.702930277336596,2.699278508715086,2.699278508715086,2.699278508715086,2.699278508715086,2.699278508715086,2.699278508715086,2.699278508715086,2.699278508715086,2.699278508715086,2.699278508715086,2.699278508715086,2.699278508715086,2.699278508715086,1.404870746692826,1.488850949444983,1.404870746692826,1.404870746692826,1.453251829244772,1.404870746692826,-0.5996568374726063,1.453251829244772,2.060003847787361,1.488850949444983,2.060003847787361,2.699278508715086,1.404870746692826,1.227298629629433,0.07325046173959274,1.416823566154713,0.3357576956833441,0.9258449446789667,1.416823566154713,0.8002062528533531,1.227298629629433,0.8002062528533531,0.2608246182818983,-0.1176580434682325,1.227298629629433,-0.7444404749474959,-0.7787050689215919,0.3845818971917403,0.8411360582733945,-0.113168698105638,-0.5603660693261269,1.227298629629433,0.6162661362239877,0.6162661362239877,0.9258449446789667,0.3900130035492428,0.39068982252601,0.8671004876833833,-0.4604494164409239,0.39068982252601,0.39068982252601,0.3625576070968879,1.78456699864655,0.8883026953339863,0.6518042170255629,0.6518042170255629,1.506297153514587,0.7626732432085556,-0.03355678352884275,0.7626732432085556,1.072610486129109,1.072610486129109,2.517938378833192,2.517938378833192,2.517938378833192,2.517938378833192,2.517938378833192,2.517938378833192,2.517938378833192,2.517938378833192,0.596085467716814,0.6729444732424258,-0.1707883209802816,0.1248689820458693,1.193619392246444,-0.5025268209512956,0.7011153502091222,1.553502280103797,0.9574326752053303,1.553502280103797,1.975468951296858,1.553502280103797,1.553502280103797,1.975468951296858,1.975468951296858,0.5394130806179033,-0.6733445532637656,1.553502280103797,1.553502280103797,1.975468951296858,1.975468951296858,-0.2420715611997286,0.371563556432483,0.371563556432483,-0.2420715611997286,0.9574326752053303,0.2215422699472359,0.223943231484774,1.296916549968674,-0.2536027587989182,0.3527673191077154,0.223943231484774,1.296916549968674,1.296916549968674,0.9899128717447687,-0.3768776512562517,0.9899128717447687,3.191504628072069,2.545060572607747,2.545060572607747,3.172664333063508,-0.791863153499103,3.191504628072069,3.781116735580347,0.9899128717447687,0.9899128717447687,0.1672079189839064,3.191504628072069,1.357894886598193,2.330394793633313,3.482070513668711,3.180093415645716,3.482070513668711,2.235697147452414,1.330517345650892,1.761300261743346,3.191504628072069,2.132271155324368,3.482070513668711,1.304813119252007,0.1672079189839064,0.1672079189839064,2.107421428186793,2.107421428186793,-1.007857925399646,3.482070513668711,3.482070513668711,3.482070513668711,3.482070513668711,3.482070513668711,1.163775614574523,-0.5124936808666878,3.482070513668711,-0.07580171341628185,0.3660310388627573,0.9360933591703348,1.272845668612312,1.221419717929657,1.221419717929657,-0.4049652330665133,1.54926318939803,1.839914511115102,1.187843422396052,0.6054082662519386,0.2004888607494036,1.221419717929657,1.54926318939803,-0.6292338548162925,0.8981267612464839,-0.09101939838716855,0.2577381960787088,-0.5960204698292225,-0.2206466711156225,0.9360933591703348,0.2004888607494036,0.1570037488096647,-0.3581045367483269,2.079066471349753,1.839914511115102,1.969487157011782,-0.353821874956326,0.2053868297249507,1.969487157011782,-0.231932057347289,0.8981267612464839,1.969487157011782,1.572773928062509,0.6647477060382473,0.08892620919440149,0.7975071958841882,0.1831545430978465,0.598836501088704,-0.04186420409869887,0.2004888607494036,0.8729656071357814,0.6444820085786643,0.8467262684882458,0.8467262684882458,0.5223588595796637,0.8467262684882458,0.2523139286139895,0.05164323315183839,1.719367971806297,1.381281819296346,1.719367971806297,2.480982292895844,2.480982292895844,1.616214896713124,1.616214896713124,2.480982292895844,1.616214896713124,2.480982292895844,1.616214896713124,2.480982292895844,2.480982292895844,2.480982292895844,1.616214896713124,2.480982292895844,1.616214896713124,1.616214896713124,1.616214896713124,2.480982292895844,1.357894886598193,3.145143166890686,3.145143166890686,2.639128755635788,2.639128755635788,1.706927533711357,2.545060572607747,1.994155947397475,2.048982334195127,3.668319540148575,1.012327920071097,0.8006553882752305,1.160020916796753,1.086539707433841,1.160020916796753,3.668319540148575,0.9266370239282993,3.668319540148575,2.40829554741616,3.668319540148575,-0.2678794451556012,3.668319540148575,2.914739114344459,2.399530299050525,2.149666986569333,2.399530299050525,3.668319540148575,2.399530299050525,3.668319540148575,1.237794352801447,2.399530299050525,1.689542156675762,2.914739114344459,2.522844489128393,2.522844489128393,3.668319540148575,1.689542156675762,3.668319540148575,3.668319540148575,0.4265740713183996,3.668319540148575,3.668319540148575,3.668319540148575,2.399530299050525,3.668319540148575,1.552232438663321,1.467643906816214,1.467643906816214,1.467643906816214,1.467643906816214,1.062985111024959,2.199111684517769,0.3450071390710503,2.199111684517769,2.199111684517769,2.199111684517769,2.199111684517769,0.7485818874480459,0.308219723669329,2.199111684517769,2.199111684517769,1.970463379110091,0.7485818874480459,-0.7011793522572096,0.308219723669329,1.970463379110091,1.970463379110091,1.970463379110091,1.227298629629433,3.690203577076068,0.858237800425538,2.224731653789182,0.6124792774924905,2.701965057446262,2.701965057446262,0.9262410627273231,2.082187767347861,-0.1392620673335077,3.690203577076068,4.192937227559188,4.192937227559188,4.192937227559188,4.192937227559188,1.456053605534743,3.690203577076068,2.977670130735583,4.192937227559188,3.690203577076068,2.082187767347861,3.690203577076068,3.690203577076068,3.017346983526399,3.017346983526399,2.224731653789182,2.701965057446262,2.51954959323154,2.977670130735583,2.977670130735583,2.977670130735583,2.977670130735583,2.701965057446262,2.224731653789182,2.977670130735583,2.693951276722709,1.549475571261417,-0.4307829160924542,-0.2744368457017603,3.690203577076068,3.690203577076068,4.192937227559188,0.5999347988377666,2.056812423619474,2.693951276722709,4.192937227559188,2.51954959323154,1.413909528152864,3.235182151142511,3.235182151142511,3.702930277336596,3.235182151142511,3.235182151142511,3.702930277336596,3.702930277336596,2.693951276722709,2.693951276722709,2.366967351923314,2.701965057446262,3.017346983526399,3.017346983526399,1.135586891459471,2.224731653789182,4.192937227559188,3.235182151142511,0.3513608491149636,4.192937227559188,2.224731653789182,3.702930277336596,3.702930277336596,2.693951276722709,1.688803467814841,0.4427608928518613,0.1930966299619132,1.384292358449217,1.384292358449217,1.384292358449217,1.384292358449217,0.5641767992629853,1.494251502624983,1.494251502624983,-0.1851254841266889,1.494251502624983,0.9835754786797514,0.2143046026470055,-0.6911491778972723,0.9835754786797514,0.219135529916671,1.308332819650179,2.021150133302732,2.021150133302732,2.021150133302732,2.021150133302732,2.021150133302732,2.021150133302732,0.6413274318301488,0.6413274318301488,2.021150133302732,0.6439569363691735,1.198457623637826,0.9585836440644065,-0.1543173603843573,-0.709276562489829,3.159592802704362,3.159592802704362,3.159592802704362,1.49604522507901,1.49604522507901,0.1160036757563061,0.1697427745870946,1.90687227632856,1.90687227632856,1.90687227632856,-0.1875351238468421,1.90687227632856,1.443855471644422,1.443855471644422,1.443855471644422,-0.2943710606025776,0.2484213584984783,2.83702958235867,2.83702958235867,2.83702958235867,2.83702958235867,2.83702958235867,2.83702958235867,1.104925650724702,2.83702958235867,-0.3595361762197646,2.018097911438784,2.018097911438784,2.018097911438784,2.83702958235867,2.83702958235867,1.104925650724702,-0.1031407589195134,1.104925650724702,1.179577647491215,2.398349714978425,2.83702958235867,1.183259762728395,0.824613943302251,-0.780886094867952,2.018097911438784,2.398349714978425,-0.6831968497067772,0.04688358589885046,-0.5621189181535413,1.104925650724702,1.262430373897505,1.262430373897505,0.003992021269537457,2.342766882626877,2.398349714978425,2.83702958235867,1.092929505532612,0.3096881527143955,1.183259762728395,2.342766882626877,1.183259762728395,1.057443011630039,0.7217346374118577,1.119068297235492,1.074319596099065,0.08892620919440149,1.21431909638008,1.21431909638008,2.484739969230901,2.484739969230901,1.372448954297838,1.372448954297838,0.9400072584914712,2.657808984665464,2.657808984665464,2.657808984665464,-0.2587707289573609,0.2554171118645054,2.657808984665464,2.657808984665464,2.657808984665464,2.741227045796767,2.657808984665464,2.657808984665464,1.484101421122803,1.484101421122803,-0.5887871652357024,2.07493138620195,1.484101421122803,-0.4812668215244463,0.1222176327242491,0.7533011033796925,2.149666986569333,0.3777512695406486,0.4774756440844366,1.689726743662903,1.689726743662903,1.689726743662903,0.0944006754214843,0.04688358589885046,0.7178397931503168,-0.3051673867928005,-0.2744368457017603,0.7957037688850375],[16.60403057551608,16.60403057551608,17.60568782110835,16.63862412941322,17.60568782110835,17.60568782110835,17.60568782110835,16.57116831947376,17.30360067068902,16.64782173048022,17.11944877845787,17.43262302844066,17.11944877845787,17.11944877845787,17.43262302844066,17.60568782110835,16.44495843576336,17.20088785945132,16.06045901690696,17.20088785945132,16.63098418546005,16.72541834988959,16.54512320951417,16.54512320951417,16.51442091767798,16.15215547344185,17.30360067068902,17.43262302844066,16.11696971733289,16.22675604602032,16.3256351294981,16.3256351294981,16.39786442065571,15.83307869060488,16.29446544778199,16.23108311734248,15.84626737366588,17.30360067068902,17.43262302844066,16.20168467838467,16.11950246093696,17.43262302844066,16.16895814256367,16.39786442065571,16.42291142464247,16.09873901419358,16.82692068912638,15.5549393528069,15.57452986980266,16.01236384415824,17.43262302844066,17.43262302844066,16.96547577938999,17.20088785945132,17.30360067068902,15.82988864075082,16.63862412941322,16.82692068912638,16.79603974808371,16.63862412941322,17.43262302844066,16.96547577938999,16.07041823245773,16.41205897994966,15.93680240527122,16.62024193801578,17.11944877845787,16.44702062133809,16.08151921462151,16.34210115068824,16.62024193801578,16.79603974808371,16.82692068912638,15.88866953057174,16.82692068912638,16.34210115068824,16.41205897994966,15.47540030085443,17.67693442802074,17.67693442802074,16.25369380635653,17.04820301209046,16.44215639698444,17.67693442802074,16.18840079437304,16.96416891898113,16.24248199228004,16.58395633504608,16.11485410281337,17.04820301209046,16.98396008091936,17.67693442802074,17.67693442802074,17.67693442802074,17.67693442802074,17.67693442802074,15.77738263492983,17.67693442802074,16.98396008091936,17.04820301209046,16.98396008091936,16.98396008091936,16.44215639698444,16.89717187299407,16.98396008091936,16.89717187299407,16.44215639698444,17.09693378550868,17.09693378550868,17.09693378550868,17.09693378550868,16.71091021034391,16.31247406419624,16.61843272165555,16.17667347362744,16.61843272165555,15.94205918155823,15.91854447304692,16.61843272165555,15.94390451255527,15.93480878840664,15.80214468530784,15.45682884754292,16.32551802969679,15.39966204653698,15.72680471299862,16.29072354229106,16.55691448738101,16.09105687577964,17.94818585409225,17.94818585409225,17.94818585409225,17.94818585409225,17.94818585409225,17.94818585409225,17.94818585409225,17.94818585409225,17.94818585409225,17.94818585409225,17.94818585409225,15.71843088827494,16.84823886035699,17.17432830900958,17.17432830900958,17.17432830900958,17.94818585409225,17.42960291321629,17.94818585409225,15.74138008569079,16.05471230235197,15.67682034327817,16.84823886035699,16.05647053506456,15.37328226438266,17.45394617259114,16.25640819563784,17.29257779922071,17.43085474128437,17.43085474128437,17.43085474128437,17.29257779922071,16.47569666596085,16.47569666596085,16.11242490261463,15.78971310438016,16.10583448919082,15.79067863182452,16.05426578533178,16.33725985516267,16.27878899508871,17.10200947927245,16.13914397264321,17.27867268268697,16.96967282771068,15.39219694684196,16.65351751193902,17.55748473167462,16.11242490261463,17.55748473167462,15.86443979796642,17.27867268268697,16.96967282771068,17.55748473167462,16.18541377417027,17.7172704372239,17.87780068911879,16.90838183799917,18.15746889838948,16.62274681190077,17.40320308044501,18.15746889838948,17.73446941467001,18.04535005879212,18.04535005879212,17.82827805960634,17.82827805960634,17.82827805960634,17.4535556386861,17.66418183640266,17.73446941467001,16.90838183799917,17.52676716557317,17.66418183640266,17.31853312335626,18.43217012747991,18.04535005879212,17.73446941467001,18.43217012747991,17.53243227660802,16.25349155430193,17.77916211457513,17.77916211457513,17.77916211457513,17.40320308044501,18.15746889838948,17.4535556386861,17.66418183640266,17.31249079558057,18.32123925402626,18.32123925402626,18.32123925402626,18.32123925402626,18.32123925402626,18.32123925402626,17.73446941467001,17.82827805960634,17.40320308044501,18.32123925402626,17.87780068911879,18.32123925402626,17.87780068911879,17.87780068911879,17.31249079558057,17.44370443215387,17.20619332092615,17.19169716142675,18.15746889838948,18.15746889838948,18.04535005879212,17.27267675172628,17.66418183640266,17.66418183640266,16.68084498136029,16.42599629360181,18.04535005879212,16.73171195117211,17.72624935915503,17.52148203272274,17.19169716142675,17.62691032023057,17.44370443215387,17.07086321961305,17.637243493723,15.89594548107736,16.50087810848178,18.15746889838948,17.18409276710674,17.58271348116922,16.25349155430193,17.4535556386861,16.73171195117211,16.62654745945293,17.57494567510341,17.57494567510341,17.57494567510341,16.16668922437648,17.31249079558057,17.50841029490058,17.73446941467001,18.43217012747991,17.44370443215387,17.07849046062013,18.04535005879212,17.40320308044501,17.35537432557701,17.19169716142675,17.19169716142675,18.43217012747991,17.91493874331692,18.15746889838948,18.04535005879212,17.66418183640266,17.82827805960634,17.27267675172628,17.73446941467001,17.0488410095424,17.77916211457513,16.1232261673226,17.83942679035045,16.17333052709634,18.15746889838948,16.73196377385649,18.43217012747991,16.90838183799917,18.15746889838948,17.47038972276951,17.28132248912377,17.44370443215387,17.87780068911879,17.35537432557701,17.09389742484901,17.08625249712737,15.92689422456306,16.46749250372894,16.79802723899581,16.46749250372894,15.73175514622241,17.09389742484901,16.37188293033227,17.08625249712737,15.57895011054834,16.79802723899581,15.75670833550295,15.75153255137636,15.47596567667711,17.36714335496917,15.69591623378618,16.29075703146686,17.52676716557317,17.4535556386861,16.77148579056694,16.39755889114767,16.16879760553894,16.77148579056694,17.0488410095424,16.56791289928387,15.82244256085331,16.16879760553894,16.39755889114767,15.874673241468,16.45024104026201,16.53423815227842,16.14381934156112,16.53423815227842,16.11549206456683,18.47718051259985,16.52175813531611,17.21056272977591,17.21056272977591,18.47718051259985,18.47718051259985,18.47718051259985,18.47718051259985,18.47718051259985,18.47718051259985,16.55565666376462,16.52175813531611,16.45024104026201,18.47718051259985,18.47718051259985,16.50074586745414,16.50074586745414,16.17333052709634,18.47718051259985,16.68485619707036,16.17333052709634,16.17333052709634,16.73196377385649,18.04928320973743,15.44453891832336,18.47718051259985,17.53243227660802,18.47718051259985,18.47718051259985,18.47718051259985,16.53423815227842,17.53243227660802,16.50074586745414,18.04928320973743,16.68485619707036,18.47718051259985,17.48679352296863,17.48679352296863,17.48679352296863,17.48679352296863,17.48679352296863,17.48679352296863,17.48679352296863,17.48679352296863,17.48679352296863,17.48679352296863,17.48679352296863,17.48679352296863,17.48679352296863,16.98124793456344,16.7714057684604,16.98124793456344,16.98124793456344,16.92628709794549,16.98124793456344,15.61827277435816,16.92628709794549,16.64645491805747,16.7714057684604,16.64645491805747,17.48679352296863,16.98124793456344,17.17441980139812,16.1435935002342,17.0707850022379,16.49804566666564,16.93311770639271,17.0707850022379,16.77758397452778,17.0760551355518,16.77758397452778,16.22947520580124,15.99328022087852,17.0760551355518,15.65599050639414,15.58396114014538,16.44150334545744,16.70889543851031,15.86203562296753,15.56443733201212,17.0760551355518,16.51551057645434,16.51551057645434,16.93311770639271,16.3940942365093,16.15521377059488,16.79251047128191,15.55748384215876,16.15521377059488,16.15521377059488,16.36833080814676,17.30888515621668,16.74605337857054,16.51360550286785,16.51360550286785,16.94769826995101,16.82585199610309,16.21820692341421,16.82585199610309,16.5912490644214,16.5912490644214,17.79583021390712,17.79583021390712,17.79583021390712,17.79583021390712,17.79583021390712,17.79583021390712,17.79583021390712,17.79583021390712,16.44554667567593,16.54069938353974,16.04812587388302,15.98448368365917,16.44702062133809,15.65121402319037,15.92704010366925,17.25820407486276,16.95240132000792,17.25820407486276,17.48997810769109,17.25820407486276,17.25820407486276,17.48997810769109,17.48997810769109,16.48455752626264,15.73522632447986,17.25820407486276,17.25820407486276,17.48997810769109,17.48997810769109,16.11919434717053,16.08759396834475,15.99496009106781,16.11919434717053,16.95240132000792,16.56494195720325,16.10266551636794,16.95008730967355,15.52780537463496,15.89266924591522,16.10266551636794,16.95008730967355,16.95008730967355,16.99164404563393,15.78521019414486,16.99164404563393,18.13896067670775,17.81586609227643,17.81586609227643,17.84623715298676,15.55788333513551,18.13896067670775,18.15349456170247,16.99164404563393,16.99164404563393,16.30635661781738,18.13896067670775,17.17709528300668,17.4571270062087,18.04581028975563,18.03125838010115,18.04581028975563,17.65382934664159,16.96319864724977,17.12033920975562,18.13896067670775,17.41420112852095,18.04581028975563,16.44568887123542,16.30635661781738,16.30635661781738,17.43518362672737,17.43518362672737,15.39959784136266,18.04581028975563,18.04581028975563,18.04581028975563,18.04581028975563,18.04581028975563,16.77917878025936,15.74862779700655,18.04581028975563,16.11401734596645,16.32057491905749,16.81990877354068,16.96083167913599,17.01296587306998,17.01296587306998,15.57836099213969,16.98996337075743,16.79930743722971,16.67739133052167,16.39839095831254,16.02645294773273,17.01296587306998,16.98996337075743,15.63552263692992,16.5811332612341,16.11673292286602,15.89192000749516,15.80069883610696,15.76166596265625,16.81990877354068,16.02645294773273,16.24884852457152,15.60319038341738,17.13198274732394,16.79930743722971,16.91586668590779,15.60840255231026,15.8871055206025,16.91586668590779,15.97255737765953,16.5811332612341,16.91586668590779,17.52676716557317,16.75061840032681,16.25026168690749,16.91104364060984,15.66013362966719,16.16110475600773,15.89864826041818,16.05844001577267,15.91656509703493,15.83928002183576,16.57944033702577,16.57944033702577,16.05598979515628,16.57944033702577,16.24900890675172,15.70791308311375,16.96590139663567,17.24084286828474,16.96590139663567,17.11761065779519,17.11761065779519,16.60826918073344,16.60826918073344,17.11761065779519,16.60826918073344,17.11761065779519,16.60826918073344,17.11761065779519,17.11761065779519,17.11761065779519,16.60826918073344,17.11761065779519,16.60826918073344,16.60826918073344,16.60826918073344,17.11761065779519,17.17709528300668,17.59689020210208,17.59689020210208,17.87332501343645,17.87332501343645,16.51034406879818,17.81586609227643,17.38265245509916,17.44559371941145,17.98875629964135,16.53268857352795,16.32303140176377,17.08660616389867,16.70749634594615,17.08660616389867,17.98875629964135,16.58043781851518,17.98875629964135,17.96292180951251,17.98875629964135,15.79835019842678,17.98875629964135,17.69827190659879,17.61005442405487,16.91388835993139,17.61005442405487,17.98875629964135,17.61005442405487,17.98875629964135,16.76943529943203,17.61005442405487,17.18988756746032,17.69827190659879,17.57215958897868,17.57215958897868,17.98875629964135,17.18988756746032,17.98875629964135,17.98875629964135,16.16511968500913,17.98875629964135,17.98875629964135,17.98875629964135,17.61005442405487,17.98875629964135,16.4889266632838,17.23934149071447,17.23934149071447,17.23934149071447,17.23934149071447,16.23184621154914,17.86156996347921,16.29414667230639,17.86156996347921,17.86156996347921,17.86156996347921,17.86156996347921,16.77193859087666,16.32031476518297,17.86156996347921,17.86156996347921,17.71324697434618,16.77193859087666,15.51737668314041,16.32031476518297,17.71324697434618,17.71324697434618,17.71324697434618,17.0760551355518,18.46480265734633,16.94566742512,17.58141963882526,16.72890920586155,18.03553896578652,18.03553896578652,16.87554646569706,17.72004980983482,16.04517027157373,18.46480265734633,18.35462192107487,18.35462192107487,18.35462192107487,18.35462192107487,16.78344148055414,18.46480265734633,18.14112222590232,18.35462192107487,18.46480265734633,17.72004980983482,18.46480265734633,18.46480265734633,18.30980780722499,18.30980780722499,17.58141963882526,18.03553896578652,17.94744882137066,18.14112222590232,18.14112222590232,18.14112222590232,18.14112222590232,18.03553896578652,17.58141963882526,18.14112222590232,17.6906306293128,17.28015161163536,15.8950437204468,16.06123509863558,18.46480265734633,18.46480265734633,18.35462192107487,16.37591931479105,17.48576801905902,17.6906306293128,18.35462192107487,17.94744882137066,16.9152202060773,17.94615050103203,17.94615050103203,18.47718051259985,17.94615050103203,17.94615050103203,18.47718051259985,18.47718051259985,17.6906306293128,17.6906306293128,17.78056989979923,18.03553896578652,18.30980780722499,18.30980780722499,16.95215233258731,17.58141963882526,18.35462192107487,17.94615050103203,16.31986527873674,18.35462192107487,17.58141963882526,18.47718051259985,18.47718051259985,17.6906306293128,17.37848154810816,16.73319496199807,16.3092295150646,16.74238582580114,16.74238582580114,16.74238582580114,16.74238582580114,16.33873551065075,16.90850442425908,16.90850442425908,15.87895736312067,16.90850442425908,16.68875667224399,15.87506311861955,15.42391013151108,16.68875667224399,16.1308581625359,16.79603974808371,17.39310051022267,17.39310051022267,17.39310051022267,17.39310051022267,17.39310051022267,17.39310051022267,16.23008647744546,16.23008647744546,17.39310051022267,16.21336364805478,16.46280784568771,16.21546561703654,16.09651842799827,15.74704341877731,17.94932190882983,17.94932190882983,17.94932190882983,16.98617830321895,16.98617830321895,16.51365364527944,16.07156049235163,17.08187669303385,17.08187669303385,17.08187669303385,15.70969107684992,17.08187669303385,17.05322992290052,17.05322992290052,17.05322992290052,16.23837618748365,16.33669987509844,17.89577735853088,17.89577735853088,17.89577735853088,17.89577735853088,17.89577735853088,17.89577735853088,16.88718641077111,17.89577735853088,15.91928147554031,17.25310473337245,17.25310473337245,17.25310473337245,17.89577735853088,17.89577735853088,16.88718641077111,15.96517230098688,16.88718641077111,17.22508313621726,16.93192463944946,17.89577735853088,17.07550479421691,16.92200675742562,15.64716535248725,17.25310473337245,16.93192463944946,15.6699746803214,16.41606529936994,15.84986987132605,17.16780067360084,17.07803834042717,17.07803834042717,16.15174945528049,17.79035338340901,16.93192463944946,17.89577735853088,16.76142928387055,16.19259329003917,17.07550479421691,17.79035338340901,17.07550479421691,17.00279705246331,17.10135062203567,17.26095972568155,16.27763882227625,16.0224639894843,16.66640790830723,16.66640790830723,17.81009342038581,17.81009342038581,17.0441241366373,17.0441241366373,16.90764337120959,17.42380576404816,17.42380576404816,17.42380576404816,15.7511072773969,16.46098951046761,17.42380576404816,17.42380576404816,17.42380576404816,17.94818585409225,17.42380576404816,17.42380576404816,17.37556526863971,17.37556526863971,15.95184506158816,17.62354661507003,17.37556526863971,15.93805876232138,16.02782832456814,16.44018675879414,16.91388835993139,16.22260205196405,16.26713744548411,17.31690009227599,17.31690009227599,17.31690009227599,16.28062283542202,16.14457593300774,16.85665133192164,15.97874875244054,16.11013726686127,16.84118214388092],[8.662020543782612,8.662020543782612,9.476711980917907,8.528686885127451,9.476711980917907,9.476711980917907,9.476711980917907,7.85142768759751,9.355185027625856,8.016680868925311,9.000507834721645,9.683763149267573,9.000507834721645,9.000507834721645,9.683763149267573,9.476711980917907,9.003611361930068,9.156306483483696,7.345041999413257,9.156306483483696,8.161888736499689,8.306546231431311,8.376827066559596,8.376827066559596,7.960951704119764,7.50928046999477,9.355185027625856,9.683763149267573,8.39049553837028,7.686713115955193,8.042795924263798,8.042795924263798,8.511597565059077,7.394984688892941,7.601951908677654,7.588880484314757,7.596241614659887,9.355185027625856,9.683763149267573,7.487509772186992,7.80994708647679,9.683763149267573,7.435614995303907,8.511597565059077,8.304816469212922,8.147230353150571,9.043801609057411,7.755381656830141,7.316548177182976,7.120282677833157,9.683763149267573,9.683763149267573,8.831215299199858,9.156306483483696,9.355185027625856,6.90785527398247,8.528686885127451,9.043801609057411,8.704983102801977,8.528686885127451,9.683763149267573,8.831215299199858,7.511797984459261,8.633926787714827,7.882843081364749,8.66669881393519,9.000507834721645,8.627212836454786,6.865786794159636,8.999792165231677,8.66669881393519,8.704983102801977,9.043801609057411,7.733508424090104,9.043801609057411,8.999792165231677,8.633926787714827,7.330601784921076,9.923643058739692,9.923643058739692,8.270550689813266,9.201914977815807,8.982510858671258,9.923643058739692,8.641461816761575,8.829343461035229,8.201413382180094,8.188327948116772,8.337157021135962,9.201914977815807,9.072812432357596,9.923643058739692,9.923643058739692,9.923643058739692,9.923643058739692,9.923643058739692,7.599751797784687,9.923643058739692,9.072812432357596,9.201914977815807,9.072812432357596,9.072812432357596,8.982510858671258,8.662868052762452,9.072812432357596,8.662868052762452,8.982510858671258,8.655737000864297,8.655737000864297,8.655737000864297,8.655737000864297,8.475224706593735,8.24672215569481,8.230364088415895,7.503950933465632,8.230364088415895,7.224971881536236,7.43413924166398,8.230364088415895,7.48605261786314,8.143807976771484,7.844671828649949,6.863489862684122,8.336198753610185,6.983697282557294,7.357556200910353,7.930278146542992,8.066835314417336,7.543379273298417,9.997337575921645,9.997337575921645,9.997337575921645,9.997337575921645,9.997337575921645,9.997337575921645,9.997337575921645,9.997337575921645,9.997337575921645,9.997337575921645,9.997337575921645,7.567965959295818,8.767235700039063,9.190535544677584,9.190535544677584,9.190535544677584,9.997337575921645,9.91130690158826,9.997337575921645,7.756109723844465,7.861572982747013,7.118421308785234,8.767235700039063,7.143380607798402,7.36827659283838,8.506294010547236,8.660773919893762,9.281870023115104,9.025491624524284,9.025491624524284,9.025491624524284,9.281870023115104,8.140169756939375,8.140169756939375,8.496153399146971,8.332019571353657,7.756280956721596,7.594381242551817,7.991964337339503,8.684976241089069,7.460087462899854,8.868596263425868,8.242282549280144,9.448545919767049,8.196629736394444,6.94051284322031,8.728442283283373,9.787431150389811,8.496153399146971,9.787431150389811,7.41709980646633,9.448545919767049,8.196629736394444,9.787431150389811,8.875384984357632,10.41568823048165,9.928701980176854,9.036486859873056,10.80898423772899,9.222575220044478,9.578345881923966,10.80898423772899,10.05629447277989,10.40143156343656,10.40143156343656,10.12829771428332,10.12829771428332,10.12829771428332,9.761682023459359,10.10992431948339,10.05629447277989,9.036486859873056,9.473396704601559,10.10992431948339,9.277961636573659,10.4463030017932,10.40143156343656,10.05629447277989,10.4463030017932,9.964102762543567,7.647833754226514,10.08655466466795,10.08655466466795,10.08655466466795,9.578345881923966,10.80898423772899,9.761682023459359,10.10992431948339,9.19819693802949,10.03837240382211,10.03837240382211,10.03837240382211,10.03837240382211,10.03837240382211,10.03837240382211,10.05629447277989,10.12829771428332,9.578345881923966,10.03837240382211,9.928701980176854,10.03837240382211,9.928701980176854,9.928701980176854,9.19819693802949,9.993479067832427,9.350823793153342,9.572946690482336,10.80898423772899,10.80898423772899,10.40143156343656,9.617304356208082,10.10992431948339,10.10992431948339,8.871154456657287,8.848092786817528,10.40143156343656,9.270202350112665,9.884569733681483,9.600597083131664,9.572946690482336,9.591321512392781,9.993479067832427,9.237780426401574,10.48587913456017,7.933474242129922,9.062953433061219,10.80898423772899,9.290001468383863,9.791684103464741,7.647833754226514,9.761682023459359,9.270202350112665,8.477537183535953,9.301834187809597,9.301834187809597,9.301834187809597,7.207415328193325,9.19819693802949,9.344066745590677,10.05629447277989,10.4463030017932,9.993479067832427,8.690558090167301,10.40143156343656,9.578345881923966,9.451999448115645,9.572946690482336,9.572946690482336,10.4463030017932,9.879691662769641,10.80898423772899,10.40143156343656,10.10992431948339,10.12829771428332,9.617304356208082,10.05629447277989,9.231083733114083,10.08655466466795,8.610355611890373,10.2123683361289,8.725296198695684,10.80898423772899,8.984568369308281,10.4463030017932,9.036486859873056,10.80898423772899,9.233685735971173,9.305805085294134,9.993479067832427,9.928701980176854,9.451999448115645,8.332404593978492,8.598681008262506,7.129938369201223,8.038512020976814,7.916953306044307,8.038512020976814,7.156722510305805,8.332404593978492,7.468170747088124,8.598681008262506,7.065613363597717,7.916953306044307,6.958258261155244,6.898108901930332,7.229693840112009,8.760013871955994,8.160518247477505,7.947289665712335,9.473396704601559,9.761682023459359,8.758365248183125,8.65121696280244,8.880905316212983,8.758365248183125,9.231083733114083,8.524407108434433,7.572760153595802,8.880905316212983,8.65121696280244,8.392559241748096,9.120481307807847,9.285002476284605,7.567655865748447,9.285002476284605,7.934441828078658,10.56993135026152,8.620904347628281,9.487593248937424,9.487593248937424,10.56993135026152,10.56993135026152,10.56993135026152,10.56993135026152,10.56993135026152,10.56993135026152,8.415559057499225,8.620904347628281,9.120481307807847,10.56993135026152,10.56993135026152,8.911839992088522,8.911839992088522,8.725296198695684,10.56993135026152,8.356695746752298,8.725296198695684,8.725296198695684,8.984568369308281,10.17476962717656,7.861996687084766,10.56993135026152,9.964102762543567,10.56993135026152,10.56993135026152,10.56993135026152,9.285002476284605,9.964102762543567,8.911839992088522,10.17476962717656,8.356695746752298,10.56993135026152,10.40645740033654,10.40645740033654,10.40645740033654,10.40645740033654,10.40645740033654,10.40645740033654,10.40645740033654,10.40645740033654,10.40645740033654,10.40645740033654,10.40645740033654,10.40645740033654,10.40645740033654,9.360758379757129,8.864930311743302,9.360758379757129,9.360758379757129,8.983138597201119,9.360758379757129,8.528647341461353,8.983138597201119,9.483804344590352,8.864930311743302,9.483804344590352,10.40645740033654,9.360758379757129,8.299335644531265,7.432010323059789,8.923071547459044,8.423058320665561,8.746605055743197,8.923071547459044,8.575613031545631,8.755044058002673,8.575613031545631,7.877169629178565,8.009396309710256,8.755044058002673,7.025004839032377,7.235042606026277,7.858988354053857,8.656937742335817,7.574455809527099,7.736656380519702,8.755044058002673,8.258448368859055,8.258448368859055,8.746605055743197,7.364547014255642,8.740736662751774,8.2419138856815,7.43791283104762,8.740736662751774,8.740736662751774,8.007433665832245,9.333230345000711,8.767344721570923,8.328692583545568,8.328692583545568,9.212707567955661,8.119636727376115,7.6366556292479,8.119636727376115,8.359439361365961,8.359439361365961,9.879399757007038,9.879399757007038,9.879399757007038,9.879399757007038,9.879399757007038,9.879399757007038,9.879399757007038,9.879399757007038,8.165761619800497,8.278961382680555,7.37800887698308,7.922623574217286,8.627212836454786,7.278214777891487,8.061739200963,9.202529949884205,8.732272312448364,9.202529949884205,9.43884552418573,9.202529949884205,9.202529949884205,9.43884552418573,9.43884552418573,8.148416747375117,7.102170083463475,9.202529949884205,9.202529949884205,9.43884552418573,9.43884552418573,7.36593933142253,8.107870652980768,8.00463273035653,7.36593933142253,8.732272312448364,7.750270291192906,8.0527102948432,9.008395531802966,7.426013214565423,8.268398443216499,8.0527102948432,9.008395531802966,9.008395531802966,9.362692292147704,7.998167371084906,9.362692292147704,10.83778518270274,10.30182062134069,10.30182062134069,10.59384835474694,7.48273810119144,10.83778518270274,11.54459466012452,9.362692292147704,9.362692292147704,8.683994936552155,10.83778518270274,9.241984377310644,10.14820471105506,10.80180574148767,10.54380605007611,10.80180574148767,9.341131764225803,9.776210844242341,9.546098067659527,10.83778518270274,9.572243624459146,10.80180574148767,9.338355326998784,8.683994936552155,8.683994936552155,9.36220272128543,9.36220272128543,7.200350263294562,10.80180574148767,10.80180574148767,10.80180574148767,10.80180574148767,10.80180574148767,7.68390999852569,8.170185652879642,10.80180574148767,8.231109840328154,8.109916443278806,8.166386708611872,8.824163052775303,9.103923743271693,9.103923743271693,7.298039065094637,8.89609527213168,8.62934261023319,7.399275751690122,7.949761942171126,7.962659467887608,9.103923743271693,8.89609527213168,7.320129795391236,8.298290634359283,7.905072849498666,7.444657922458246,7.501137371352507,7.003519900966516,8.166386708611872,7.962659467887608,7.538228865014023,6.854776354191251,8.877074987902436,8.62934261023319,8.394731728967937,8.037866234709618,7.343943559733142,8.394731728967937,7.686804888542786,8.298290634359283,8.394731728967937,9.473396704601559,7.543061459852233,7.059187982742347,8.432963396782423,7.68285104218925,7.484930283289661,7.887208585813932,8.82494256201813,8.232546507507978,7.522129778376686,9.184006663524327,9.184006663524327,8.278453652477472,9.184006663524327,7.936052393735221,8.201550505605104,7.873902273207722,7.788584622578133,7.873902273207722,10.60938806256867,10.60938806256867,9.521033155609908,9.521033155609908,10.60938806256867,9.521033155609908,10.60938806256867,9.521033155609908,10.60938806256867,10.60938806256867,10.60938806256867,9.521033155609908,10.60938806256867,9.521033155609908,9.521033155609908,9.521033155609908,10.60938806256867,9.241984377310644,10.05390125856648,10.05390125856648,10.6752633645118,10.6752633645118,9.245553063731926,10.30182062134069,10.06891300400363,9.531300051490684,11.344155272272,8.750413798226976,8.513064680832457,8.513325722389748,8.654412774297771,8.513325722389748,11.344155272272,8.101223098662926,11.344155272272,9.989197249374286,11.344155272272,7.459223681210144,11.344155272272,10.20780547863933,10.18873792079032,9.10167439930963,10.18873792079032,11.344155272272,10.18873792079032,11.344155272272,8.749225123775851,10.18873792079032,9.963019813237462,10.20780547863933,10.53327152101215,10.53327152101215,11.344155272272,9.963019813237462,11.344155272272,11.344155272272,7.294784824934617,11.344155272272,11.344155272272,11.344155272272,10.18873792079032,11.344155272272,8.914491710191342,8.966534824213877,8.966534824213877,8.966534824213877,8.966534824213877,8.481338008507249,9.699883113408884,7.745175948698507,9.699883113408884,9.699883113408884,9.699883113408884,9.699883113408884,8.165050816989909,8.11102783819368,9.699883113408884,9.699883113408884,9.581503848387326,8.165050816989909,7.088826053874439,8.11102783819368,9.581503848387326,9.581503848387326,9.581503848387326,8.755044058002673,11.13807927659209,8.131883589511638,10.00175245375773,8.217357562791886,10.91429906180941,10.91429906180941,7.95763240196837,10.03483155456522,7.877965852845723,11.13807927659209,11.41417858647624,11.41417858647624,11.41417858647624,11.41417858647624,9.312842807210474,11.13807927659209,10.91145824657715,11.41417858647624,11.13807927659209,10.03483155456522,11.13807927659209,11.13807927659209,10.41983788694482,10.41983788694482,10.00175245375773,10.91429906180941,10.22054030273904,10.91145824657715,10.91145824657715,10.91145824657715,10.91145824657715,10.91429906180941,10.00175245375773,10.91145824657715,9.84809111491575,9.324775587709667,7.405374075260846,7.798030523653011,11.13807927659209,11.13807927659209,11.41417858647624,7.967314840386546,9.059191847833121,9.84809111491575,11.41417858647624,10.22054030273904,8.862398611111672,10.26401456771281,10.26401456771281,10.56993135026152,10.26401456771281,10.26401456771281,10.56993135026152,10.56993135026152,9.84809111491575,9.84809111491575,8.25343595721673,10.91429906180941,10.41983788694482,10.41983788694482,8.7608606784486,10.00175245375773,11.41417858647624,10.26401456771281,8.220214707592666,11.41417858647624,10.00175245375773,10.56993135026152,10.56993135026152,9.84809111491575,9.442094743538288,7.129457792499942,7.703549296502225,9.200895913148184,9.200895913148184,9.200895913148184,9.200895913148184,8.286143468530931,9.042525088583851,9.042525088583851,7.59890045687141,9.042525088583851,8.485041831399153,8.100677247120988,6.950910549296065,8.485041831399153,7.717128728510215,8.704983102801977,9.310402877932709,9.310402877932709,9.310402877932709,9.310402877932709,9.310402877932709,9.310402877932709,8.134232938648143,8.134232938648143,9.310402877932709,8.120350800598958,9.23865568295623,8.309529210950414,7.343814252174935,6.945725210233766,10.1544408044896,10.1544408044896,10.1544408044896,9.529535646265424,9.529535646265424,7.822564914574494,7.729647415432645,9.291551627401006,9.291551627401006,9.291551627401006,8.362992510338938,9.291551627401006,9.050910783194514,9.050910783194514,9.050910783194514,7.231793388394572,7.003247260441357,10.42217419735395,10.42217419735395,10.42217419735395,10.42217419735395,10.42217419735395,10.42217419735395,9.393744675721376,10.42217419735395,7.72081655620742,9.73892536052794,9.73892536052794,9.73892536052794,10.42217419735395,10.42217419735395,9.393744675721376,8.140985869375008,9.393744675721376,8.579717184754596,8.57687619357741,10.42217419735395,8.732514226473301,8.998013113095823,7.303372051035487,9.73892536052794,8.57687619357741,7.3757569055572,7.551554639911743,7.738183065076116,8.553775812477925,8.327242607457793,8.327242607457793,7.855699704658087,10.0602476819294,8.57687619357741,10.42217419735395,8.573497907626706,8.378367810330605,8.732514226473301,10.0602476819294,8.732514226473301,8.051946231261411,8.02446940301423,8.317839406224765,8.919560171946161,7.914617709040679,9.314024483253064,9.314024483253064,9.345779942870006,9.345779942870006,8.79349070500138,8.79349070500138,9.190290714170478,9.746541302073402,9.746541302073402,9.746541302073402,7.82464583092826,8.084439103070402,9.746541302073402,9.746541302073402,9.746541302073402,9.997337575921645,9.746541302073402,9.746541302073402,9.094166041659216,9.094166041659216,7.180755092647776,9.628826997602797,9.094166041659216,7.822204315976921,7.506701664143256,8.539130792934138,9.10167439930963,7.629829994615262,7.855699704658087,9.083676770563855,9.083676770563855,9.083676770563855,7.208674354465914,7.769843224841976,8.115221972562329,7.423449034144988,6.929418918618163,7.134890851565884],[21.38618655922211,20.58281584937243,21.1518727192938,20.32610392718047,20.7486092182287,21.87327263679614,20.31760223864037,20.89210865226124,21.47498322976199,21.31483212506519,21.55679753864782,21.12055726737807,20.30002675598048,20.56987527915319,20.06672750196594,20.19008542649429,20.52109578968458,21.29901966959934,20.78712145089344,20.441699912008,21.28076689040627,21.08182437560627,20.06862606712313,20.52124301199127,20.41294157521557,20.47192104634743,21.03482078975842,20.82732384270639,20.42249097881821,20.4879274600843,20.34532539372155,20.70459517687353,20.51270529028327,20.59314058881986,20.45331119430556,20.72872176924287,20.40320973934914,20.45850181486253,20.97839093096484,20.85623597234556,20.65893852123674,21.10299438889469,20.82300828789072,20.33745448475952,20.89884378748729,20.66826124948568,20.94900065283279,20.1419600934307,20.1855637329778,20.29090267446052,20.78016095468254,20.71554602875698,20.85506236731729,20.16575805186094,20.27657467926124,20.29032520851222,20.54330074790016,20.51871806733605,20.75241027082497,20.50603079098552,20.45992858588095,20.15136089321278,20.64731178398746,20.13806702765561,20.2720414362088,20.29308187682862,20.14937559198516,20.20482100895573,20.65315855366181,20.22399362804448,20.14749022429049,20.67880125374794,20.22745058016655,20.38056211790538,20.30708388303754,20.08913923476575,20.23937369363773,20.86594092763382,21.50047760242421,21.32786941161698,20.18898630636884,20.5396399018208,20.4939002299783,20.6382948634625,20.23141006407601,20.26777773464608,20.15046280780644,20.91726745135065,20.16287255709246,21.12565566121285,21.08764414533763,20.12226371793906,20.4321196834881,20.41873370288332,20.27004785554657,20.23834656531362,20.0586372634436,20.1044855597289,20.71456117809163,20.25837950318136,20.24481617940884,20.13911502072856,20.25875475998076,20.51315115262945,20.23311627101657,20.48245552844065,20.12023960447801,20.37442347381658,21.08576772084848,20.17897207963449,20.33079400000144,20.71824312522191,20.04725330622521,21.02748140920944,20.07627534839096,21.02748140920944,20.7327078029605,20.05976186865762,20.34483874102255,20.114074098092,20.40910284617165,20.22737973242438,20.1696576660879,20.19905990139572,20.16806698820725,20.17595482454707,20.53354120206656,20.26424094579941,20.23687560570067,20.50735662706753,21.25919000865597,20.31490975499746,21.3324298901914,21.43002248514945,20.48271727463056,21.01300790415129,20.18346433285688,21.36296101689348,20.81364249144898,21.18637891515341,20.4943290082094,20.81344984033032,20.96968946261525,20.21281403330097,20.2676454377319,20.29137722210202,20.2249059503521,20.32528490935977,20.60003371457151,20.34036710991668,20.43058557030685,20.1456210399986,20.22097738427735,20.44585217940717,21.68640649193909,20.27323756203947,20.74007650258983,21.26851759553028,20.65562966009011,21.10862944622075,20.22949337625309,20.14711502003088,20.22945879705305,20.07158871862547,20.61508973234665,20.21866869087922,20.4561145135739,20.42239325361656,20.26125003271224,20.39378007020925,20.74812414995405,20.27191685553619,20.60889962703685,20.37385439975772,20.17938294982062,20.0407076090199,20.40495887043242,20.24639550174558,20.47603743647246,20.58828922449463,20.08275167684014,20.3050221064115,20.57032705097905,20.17498756900493,21.02155464333607,20.11431612170417,20.3724373420268,21.56937288760106,21.3279771535076,21.34293526449206,21.11406857123026,21.24403066576111,21.4868049593711,20.7076701723202,21.3183142458915,20.43105872057509,21.04834772702508,21.35188047875089,21.48435590361821,20.91383864914371,20.14469178312636,21.16976679190679,21.53522341147164,21.17407388866647,20.64559256311278,20.73375349173205,20.6259451230723,21.09123111907188,21.46336996330972,20.06186470176003,21.39376709224683,20.57645519087487,21.48070332143433,20.23265283484879,20.726294040307,21.61361748316532,21.40645481831723,20.71818895435958,20.27289735744386,21.04424967736458,20.27145490760206,20.98706236369796,20.98706236369796,20.55817420795231,20.16533066523407,20.69184184771458,20.57416095431307,20.16416487421575,20.66474973021138,20.12675170081942,20.84349097623883,20.92921516967467,21.26659598335729,20.05559663074344,20.36328898914662,20.54752116455586,21.37436482307267,21.15435044047663,21.49639921989119,20.40908085660806,20.75946324026999,20.63377509979108,21.09208513133394,20.7180109893873,21.20934948936391,21.33289606353901,20.91578376692989,20.34246393026441,20.5851591582162,20.92844669676395,20.94880012098038,21.02741154861988,20.16130228917841,21.05454555431437,21.10272262042794,20.8074607283616,20.55547500595231,20.6168035367691,20.61999459057808,21.09354568978389,20.39116575371784,20.19309100717327,21.13527814197569,20.4370244009461,20.77505667648784,20.73224991796221,20.10199127900697,20.41013238177767,20.82498874934042,21.50738391897257,20.31428860855781,21.15049245510093,21.72122265127717,20.36816540424262,20.62590407358298,20.54752116455586,20.88222770073036,21.52918165137097,20.16488447629203,21.07779988820898,20.93485168498026,21.05451086333476,21.3131631550743,20.79635453653258,20.92559646051076,21.13564273417895,20.40388730395542,20.54080549012157,20.53332166409196,20.78571042796667,21.02791758723856,20.15885764074522,21.49329262430828,20.3011464103728,20.71814877006232,20.60763612198005,20.37257617399561,20.80595423523047,20.69717234973922,20.16889092484809,21.26597537099793,20.79231011844518,20.59279087951857,21.14089361895038,20.94374021638868,20.72533713831987,20.25479170462369,20.19613982408222,20.51293907481003,20.4802056305101,20.09444162616951,20.61476107108847,20.36223251190514,20.11836771047105,20.27308523792597,20.84013286653063,20.75697492936967,21.06514556100417,20.51572123198601,20.7648364657301,20.4688049665183,20.64541185725929,20.09782461028342,20.39528758309931,20.17228986284837,20.09245307214241,20.29267085088631,20.27181693512496,20.60731248028108,20.55365615087765,20.5666598105547,20.38527943775943,20.51545022402199,20.97871653306493,20.2151991122494,21.66821259047444,21.2996238439304,21.42141682206923,20.4527209681935,20.53880812138907,20.75504621625914,20.30360952535329,20.60302395542969,21.24110337091026,20.74202208266256,20.10352222536365,20.11182216570361,20.0671113258312,20.7280980400249,21.13112209996369,20.68480865654779,20.25943662350316,20.21546317442548,20.84156924385286,21.11470614368854,20.21709055024908,20.44456500018416,20.93458202230276,21.19624881851102,20.07201743800336,20.36206511855153,20.2928424254552,20.50566370233302,20.07746006685696,20.07076066863088,20.25823486512085,20.15646637510055,20.25638328885578,20.78448267771952,20.03946474135352,20.10172081246096,21.5297875745291,21.1089639910821,20.23454887235055,21.22613744483186,20.70341977316688,21.0533120199261,21.14030935185277,21.53938738153635,21.11754880868708,21.39010369095046,20.0749067333538,20.15227257203658,20.14086558324997,20.93125863707153,20.71667017128657,20.53525068354917,20.45274516826673,20.56077171537621,20.32613687244337,20.29523543536169,20.52715148213665,20.4833390530475,20.50732228581078,20.95436073633974,21.11754880868708,20.23770391470098,21.57716113757117,20.62484941737066,21.01763428766558,21.57019698753237,21.7152182658042,21.01899711817433,20.92781670089981,20.27553080845408,20.69075692613061,20.42304424565198,20.8115491487672,20.71656187955606,20.45204665506033,20.67313128674491,20.66548391476553,20.29809090054611,20.43248420983427,20.26845254728107,20.60292967846892,20.24941282592804,20.12478178689954,20.06885493876056,20.65203009030868,20.44263457169657,20.87721317524404,20.11122920786566,20.39471412995072,20.0983282913571,20.85128274169304,20.29931844380647,20.26991208992278,20.89487484287965,20.22266385321588,20.46049737770322,20.73638027652574,20.73095386120774,20.42880219084988,20.15568703369253,20.37480181663643,21.60810486815266,21.55204750975321,21.30615499584251,21.30585905700752,20.80426988669024,20.21648974275648,20.17670247847615,20.62046790838911,20.47018410218471,21.14954927465114,20.35310243279308,20.28496015102724,20.49843538486482,20.08665040935995,20.2722670266363,20.445404530519,20.90127222427407,21.40727388103105,21.19226478479377,20.83628747690553,20.69961008595422,21.24922089327071,21.2184905866586,20.03687581130719,20.26840124006828,20.21424533297093,20.94057213097536,20.42368034169181,20.95934988411121,20.47470369949304,20.36877305036952,20.3229319122711,20.32511142198044,20.08663372176661,20.61598653492822,20.43614615832157,20.90531057542971,20.12022549864292,20.42986019876421,20.43614615832157,20.46139366618095,20.79276793009134,20.80987928593986,20.86683070684358,21.39134513521112,21.54933381688176,20.09863990841177,20.32338119602665,21.23537953958251,20.96737522895778,21.36470100178305,21.67552755463291,21.15971708350677,20.75044768442909,20.58203667292781,20.77519028981154,20.55660016156986,21.57079771394959,21.2711586008218,21.56820367824947,21.64483479842599,20.67051055226641,20.54466454617319,20.32587142745734,20.82133798445845,21.1855716003776,21.51080967608629,20.23059107510217,20.72757703137836,20.28336240588526,20.04010001646119,20.63486861976006,20.0374572489253,20.10747324599816,21.12121791411806,20.45235149047959,20.3143042362261,20.29599947360518,20.10887937158177,20.18672805736577,20.38376007824611,21.40125522745258,20.05245875373761,20.90273947142329,21.86150292474227,20.35919926352727,20.60852104751709,20.45406836540559,21.24663695329767,20.46291802956213,20.87871981796473,20.88364396561444,20.31539098674052,20.29666422393274,20.83741803307528,20.58820471259298,20.82279792738507,20.65327824052747,20.22539047867049,20.76451760150229,20.40157323308777,20.04282169999756,20.09526245743019,20.16682042031863,20.22369600837577,20.50949296956215,20.06630937604998,20.74359068080496,20.3117640984934,20.05108634982748,20.51035856074793,20.462902952581,20.03765349605066,20.22199078757397,20.03800687839547,21.17023497957267,20.57816188958621,21.36587294884675,20.23524095112512,20.27318506463173,20.31892467747128,20.91952609955056,20.23249217540313,20.20855648793999,20.06192833902896,20.24128862723369,20.09761468416162,20.7265229916541,20.244470960882,20.25725735247131,20.93231473648862,20.28754633439853,20.09707094329615,20.42252695817903,21.37776840389586,20.46887981013297,20.78367214222764,20.53742076907168,20.34835272265317,20.21068540440372,20.39564318974315,20.35619992627449,20.97515083131242,20.17553510707189,20.1871321384821,20.06366611857986,20.56075792268209,20.12930859110799,20.24467460113286,20.28742756868229,20.16281280236781,20.48986177744152,20.74992277946468,20.12612726314299,20.2655080088755,20.29858160906843,20.69738800243294,21.16171360928247,21.36151666885495,21.17748486729744,20.28606935166398,20.20573681552984,20.31691309751009,20.05337016083523,20.43216613103283,21.02630047557883,20.36698727586618,20.88056936474949,20.27606339208258,20.58158549161244,20.34815768916589,21.08213227819977,21.07240784835775,21.01993516451405,20.13713130891426,20.67821606483078,20.07533110434541,20.41663225097834,20.44795089530491,21.33830412842476,20.24185420234806,20.1785371184001,20.34294431192126,20.17049508470907,20.60237725469319,20.73692359767154,20.20182305341293,20.17766253298863,20.55072297409864,20.28708978245346,20.66952438194188,20.42045191332075,20.41477607148908,20.25061633285894,20.50449025091716,20.31440825590368,21.24611691937402,20.88684270463018,20.63875942935412,20.13324362286528,20.08867181655983,21.27386471330303,20.96003279875331,21.67922082436361,20.27042428986327,20.49995027708958,20.2101547067325,21.23460723907587,20.94722882523042,20.28946292988371,20.04916104771768,20.8696697706405,20.08071502457736,20.52122381776065,20.06485109884344,20.87930224196152,20.65342992698808,20.47962868014056,20.07277125273231,22.21452865550435,20.87639968683443,21.24971287360786,21.23558062974958,21.8471907349103,22.1111373639361,20.81184378879995,21.98389864854504,20.81939042957202,21.59835188233308,20.4073357380377,21.14657961887476,20.60665765612773,21.06581093919201,21.00722765382101,20.71622796512399,21.24735051723521,21.36540886762829,21.34884387881642,21.7620960920334,21.46202705789231,21.2125033478371,21.11860894333347,20.30826133213008,21.02671102191762,21.2141121945525,21.45170146326634,20.46205108623475,20.45927550304431,20.50571239804848,21.49868092589111,21.31248796829564,20.57699091856364,21.64327675394282,21.54075237874536,21.99625685203826,20.93449796569951,21.22374768241494,21.60064715581636,20.69872821274472,20.92941227548966,20.64902336467103,21.13503813948698,21.2273840184316,20.7178558463013,21.08211420448801,21.29122038401751,20.40059874055756,20.49887271774733,20.25634386890147,21.17755717841478,20.39619175816484,21.04956007083489,20.0464878255171,21.53204848924167,21.25012511552299,20.52894711591231,21.68082543116052,21.63367985632215,21.42316960229245,20.91661183894526,20.88393630639406,20.91109251935793,20.41826828240701,20.84006903538572,20.64344515862253,21.02440848598509,21.04956007083489,20.0464878255171,20.90894158630841,21.81221846091385,20.71267795967371,20.08808419963205,20.43304062812958,20.24275864754039,20.64208139182199,20.06205070239183,20.17867811902147,20.53107835274922,20.89181096130336,20.22385042673097,20.46439685963952,20.45266875595625,20.19322738651765,20.07245496295725,20.44393720383325,20.08717713601094,20.22115425043452,20.56497021788159,20.22639633685439,20.4668152085146,20.85424783951091,20.42094788191532,20.72937469780257,20.51531255336235,20.04993801295447,20.16636699152775,20.09731180213818,20.43833429830596,20.59632859901614,20.23163869559953,20.04489321902702,20.96525411456316,20.2363502676195,20.60629292317766,20.31558763926104,20.32236356823581,21.17920346279711,20.31126378651045,20.51422545058021,20.774688333487,20.71921978872144,20.44391421771754,20.18833543328255,20.66752410502095,20.55670806228288,20.0818912885733,20.87524344765404,20.64391965405982,21.63235772480932,21.86244160320215,21.00549705997411,21.00219192187799,21.59526621189587,20.81548025892437,20.45913178212344,20.73178603178101,20.84451005889193,21.33583685332019,21.31922365629613,21.59830470775426,21.37132457682175,20.96724248992587,20.6293327125659,20.88527767219363,21.22593748683949,21.50512961964782,20.9672747267576,20.40364888317165,20.26343295624028,21.22242794923898,20.83550656457059,20.09806477008025,20.25415257440658,20.55833155518538,21.02696623082108,21.06637137308212,21.2055008438501,20.96735009789143,20.48941936947024,21.04194030951794,21.66866936481999,20.28896893093999,20.42669867271281,20.95537560651895,20.64408596334114,20.39690138353457,20.2773374121729,21.148964606893,21.34362125346289,21.44164682898804,21.35100106650662,20.28438586957067,20.05829970802362,20.05740148804652,20.15335197312903,20.11189755078444,20.21956334830911,20.51840196338804,20.05875924690936,21.62486082703007,21.08972434684372,20.47641675927438,20.84198286829299,20.69965151566595,20.78859185761232,20.58227132727217,20.43542199407717,20.17688830386171,20.86418162555881,20.78329652147583,20.29027059392394,20.32491576532756,20.84930041303342,20.85299340293668,20.24961617218396,20.60559378663093,20.67400235372919,20.20702589383768,20.08540910121367,20.35021051268138,20.22649216378334,20.30867166545261,20.53836072805397,21.06882139430554,20.20346435206069,20.31616432515978,20.24788834151187,21.2958954242907,20.67352495168487,20.58546036688054,20.35062136328333],[282,282,63,416,63,63,63,470,129,410,178,81,178,178,81,63,341,165,821,165,290,332,440,440,543,756,129,81,955,734,644,644,398,1062,688,679,1285,129,81,817,778,81,919,398,611,737,231,1330,1770,947,81,81,267,165,129,1248,416,231,309,416,81,267,1018,488,944,423,178,631,1044,636,423,309,231,981,231,636,488,545,55,55,85,54,543,55,715,108,769,474,694,54,257,55,55,55,55,55,1249,55,257,54,257,257,543,322,257,322,543,200,200,200,200,401,550,389,708,389,1125,1032,389,204,791,937,1656,621,1439,1367,468,475,706,25,25,25,25,25,25,25,25,25,25,25,579,279,138,138,138,25,78,25,295,722,1356,279,905,2096,89,666,119,92,92,92,119,352,352,388,770,600,1070,822,592,778,197,663,114,253,1657,418,59,388,59,921,114,253,59,601,25,23,107,3,257,58,3,5,3,3,8,8,8,69,45,5,107,51,45,61,3,3,5,3,48,525,7,7,7,58,3,69,45,85,5,5,5,5,5,5,5,8,58,5,23,5,23,23,85,22,157,98,3,3,3,77,45,45,119,129,3,205,47,37,98,38,22,160,18,1101,227,3,78,57,525,69,205,340,57,57,57,676,85,59,5,3,22,205,3,58,66,98,98,3,11,3,3,45,8,77,5,162,7,675,6,428,3,309,3,107,3,81,112,22,23,66,201,158,1260,13,214,13,1314,201,611,158,1465,214,1331,1464,1784,105,749,594,51,69,318,338,350,318,162,440,1043,350,338,513,257,259,516,259,463,1,251,100,100,1,1,1,1,1,1,339,251,257,1,1,321,321,428,1,317,428,428,309,13,1259,1,48,1,1,1,259,48,321,13,317,1,67,67,67,67,67,67,67,67,67,67,67,67,67,129,389,129,129,251,129,1064,251,387,389,387,67,129,152,480,165,422,117,165,291,132,291,680,958,132,1117,1575,348,326,1101,1077,132,488,488,117,628,629,333,1858,629,629,592,71,114,325,325,189,219,631,219,468,468,40,40,40,40,40,40,40,40,514,417,964,874,631,1682,778,135,201,135,77,135,135,77,77,475,1240,135,135,77,77,646,805,924,646,201,492,615,202,1719,1158,615,202,202,61,756,61,5,22,22,22,924,5,3,61,61,105,5,29,45,6,8,6,50,103,99,5,91,6,275,105,105,89,89,1094,6,6,6,6,6,382,826,6,614,617,110,132,67,67,1361,134,337,457,521,856,67,134,1183,304,753,1159,1078,1106,110,856,463,1002,71,337,290,1504,844,290,844,304,290,51,407,421,313,1492,808,1222,685,760,584,13,13,671,13,331,40,266,87,266,63,63,173,173,63,173,63,173,63,63,63,173,63,173,173,173,63,29,53,53,29,29,344,22,64,66,3,404,440,159,332,159,3,462,3,3,3,750,3,34,56,239,56,3,56,3,270,56,128,34,40,40,3,128,3,3,892,3,3,3,56,3,475,143,143,143,143,683,23,424,23,23,23,23,314,636,23,23,16,314,1662,636,16,16,16,132,1,150,58,224,2,2,82,13,530,1,1,1,1,1,116,1,3,1,1,13,1,1,4,4,58,2,21,3,3,3,3,2,58,3,18,66,847,968,1,1,1,473,26,18,1,21,167,22,22,1,22,22,1,1,18,18,31,2,4,4,145,58,1,22,360,1,58,1,1,18,69,406,552,258,258,258,258,161,268,268,1215,268,354,1081,1918,354,835,309,104,104,104,104,104,104,715,715,104,788,268,717,674,1112,21,21,21,137,137,549,975,170,170,170,901,170,63,63,63,538,597,18,18,18,18,18,18,165,18,820,118,118,118,18,18,165,836,165,144,231,18,214,183,1345,118,231,1178,598,831,171,213,213,783,30,231,18,331,553,214,30,214,224,180,147,419,841,327,327,32,32,145,145,107,100,100,100,1043,475,100,100,100,25,100,100,117,117,784,56,117,150,793,519,239,863,672,105,105,105,742,860,238,937,883,339],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0,0,0,0,1,1,1,1,0,0,0,1,1,1,1,1,0,1,1,1,1,0,1,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,1,0,1,1,0,0,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,0,0,1,1,0,1,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,1,1,1,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,1,1,0,1,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,3,4,4,3,4,3,3,3,3,3,4,4,4,4,4,4,4,3,3,4,3,4,4,4,4,4,4,3,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4,4,4,4,4,4,4,3,3,3,4,4,4,4,4,3,4,4,4,4,4,4,4,3,4,4,3,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,3,4,4,4,4,3,4,3,3,4,3,4,4,4,4,4,3,4,3,4,3,4,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,3,3,3,3,3,3,4,4,4,3,3,4,4,4,3,4,4,4,4,3,4,3,4,3,3,3,4,4,4,3,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,3,3,3,4,2,1,4,4,4,2,4,3,3,3,3,4,4,4,2,4,3,4,4,4,4,4,4,3,3,3,3,3,4,4,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,4,4,3,4,3,4,3,3,3,4,3,4,4,4,3,4,4,4,3,3,4,3,4,4,1,4,4,4,4,4,1,4,1,4,1,4,1,3,3,4,3,1,3,1,4,3,4,3,3,3,1,4,1,1,4,1,1,1,3,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,4,4,4,2,2,4,4,4,2,1,1,1,1,4,2,2,1,2,4,2,2,3,3,4,2,3,2,2,2,2,2,4,2,4,4,4,4,2,2,1,4,4,4,1,3,4,3,3,3,3,3,3,3,4,4,4,2,3,3,4,4,1,3,4,1,4,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,3,3,3,3,4,3,4,4,4,4,3,3,4,4,4,4,4,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>daily<\/th>\n      <th>daily1<\/th>\n      <th>monthly_listeners<\/th>\n      <th>artist_streams<\/th>\n      <th>streams<\/th>\n      <th>months_sincepk<\/th>\n      <th>explicit<\/th>\n      <th>popular_artist<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"daily","targets":1},{"name":"daily1","targets":2},{"name":"monthly_listeners","targets":3},{"name":"artist_streams","targets":4},{"name":"streams","targets":5},{"name":"months_sincepk","targets":6},{"name":"explicit","targets":7},{"name":"popular_artist","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p><br><br><br><br></p>
</div>
</div>
<div id="section-5" class="section level5">
<h5></h5>
</div>
</div>
<div id="boxcox-transformation" class="section level4">
<h4>boxCox transformation</h4>
<div id="section-6"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills"></h5>
<div id="original-view" class="section level6">
<h6>Original View</h6>
<p><br></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>dt<span class="sc">$</span>daily1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(dt<span class="sc">$</span>daily1)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>dt<span class="sc">$</span>monthly_listeners <span class="ot">&lt;-</span> <span class="fu">exp</span>(dt<span class="sc">$</span>monthly_listeners)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>mylm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(daily1 <span class="sc">~</span> monthly_listeners, dt)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="fu">boxCox</span>(mylm1)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="fu">plot</span>(dt<span class="sc">$</span>monthly_listeners, dt<span class="sc">$</span>daily1, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">xlab =</span> <span class="st">&quot;Monthly Listeners&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Daily Streams (Millions)&quot;</span>)</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/raw-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><br></p>
<p>After trying <code>daily1 ~ monthly_listeners</code> I got the above
boxCox suggestions (left). To the right you can see the plot in its
original format.</p>
<p>This suggestion is closer to a sqrt or log transformation. I tested
both, but even though sqrt got me a higher R<sup>2</sup>, I went ahead
and tried log. Next tab shows how the plot looked like after Y
transformation. As a note log y transformation took me to .78
r<sup>2</sup> while sqrt got me to .82 R<sup>2</sup>.</p>
<p><br><br><br><br></p>
</div>
<div id="y-transformation" class="section level6">
<h6>Y transformation</h6>
<p><br></p>
<p>This is how the data looked like after taking the log of Y.</p>
<p><br></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>dt<span class="sc">$</span>daily1 <span class="ot">&lt;-</span> <span class="fu">log</span>(dt<span class="sc">$</span>daily1)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>mylm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(daily1 <span class="sc">~</span> monthly_listeners, dt)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="fu">plot</span>(dt<span class="sc">$</span>monthly_listeners, dt<span class="sc">$</span>daily1, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">xlab =</span> <span class="st">&quot;Monthly Listeners&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Daily Streams (Log Millions)&quot;</span>)</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/y%20transformed-1.png" width="960" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><br></p>
<p>This is how the data looked like after taking the log of Y.</p>
<p>For the first Y transformation discussed in the previous tab, I chose
log even though sqrt had a higher R<sup>2</sup> because, when I looked
at the data plotted this way, it looked like it could support an x
transformation. If I followed the path of sqrt I would have lost
interpretability and the chance to support an x transformation. I tried
a log x transformation. See next.</p>
<p><br><br><br><br></p>
</div>
<div id="x-transformation" class="section level6">
<h6>X transformation</h6>
<p><br></p>
<p>This is how the plot looks after a double log.</p>
<p><br></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>dt<span class="sc">$</span>monthly_listeners <span class="ot">&lt;-</span> <span class="fu">log</span>(dt<span class="sc">$</span>monthly_listeners)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>mylm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(daily1 <span class="sc">~</span> monthly_listeners, dt)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="fu">plot</span>(dt<span class="sc">$</span>monthly_listeners, dt<span class="sc">$</span>daily1, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">xlab =</span> <span class="st">&quot;Monthly Listeners (Log)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Monthly Streams (Log Millions)&quot;</span>)</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/final%20transformed-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><br></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">summary</span>(mylm1))</span></code></pre></div>
<table style="width:96%;">
<colgroup>
<col width="33%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-23.49</td>
<td align="center">0.3017</td>
<td align="center">-77.86</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center"><strong>monthly_listeners</strong></td>
<td align="center">1.468</td>
<td align="center">0.01767</td>
<td align="center">83.11</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<table style="width:88%;">
<caption>Fitting linear model: daily1 ~ monthly_listeners</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span
class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">857</td>
<td align="center">0.4002</td>
<td align="center">0.8898</td>
<td align="center">0.8897</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>So, in the <strong>log world</strong>, there is an awesome
correlation between these two variables. I didn’t need to take out
outliers, nor filter many things to get to this point. And even though
this is not the final model, this how it began to be formed. The numbers
on the x Axis were later fixed to represent natural world
quantities.</p>
<p>Continue to model summary to keep on reading about this model, or
read about an alternative model where I tried
<code>daily ~ streams</code>. where the daily streams by song (instead
of by artist) was being explained by the total streams the song has
had.</p>
<p><br><br><br><br></p>
</div>
</div>
<div id="section-7" class="section level5">
<h5></h5>
</div>
</div>
<div id="alternative-model" class="section level4">
<h4>Alternative Model</h4>
<div id="section-8"
class="section level5 tabset tabset-fade tabset-pills">
<h5 class="tabset tabset-fade tabset-pills"></h5>
<div id="introduction-1" class="section level6">
<h6>Introduction</h6>
<p><br></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>dtas <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://github.com/Tonadeleon/Regression-Projects/raw/main/Datasets/dataset.csv&quot;</span>)<span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">filter</span>(popularity <span class="sc">&gt;</span> <span class="dv">59</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">title =</span> track_name,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>         <span class="at">artist =</span> artists,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>         <span class="at">title_id =</span> track_id,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>         <span class="at">album =</span> album_name,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>         <span class="at">loud =</span> loudness,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>         <span class="at">words =</span> speechiness,</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>         <span class="at">acoustics =</span> acousticness,</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>         <span class="at">instrumental =</span> instrumentalness,</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>         <span class="at">live =</span> liveness) <span class="sc">|&gt;</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  <span class="fu">inner_join</span>(df1, <span class="at">by=</span><span class="st">&quot;artist&quot;</span>, <span class="at">relationship =</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a>  <span class="fu">inner_join</span>(df2, <span class="at">by=</span><span class="st">&quot;artist&quot;</span>, <span class="at">relationship =</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>)</span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a>dtss <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(dtas, df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;artist&quot;</span>), <span class="at">relationship =</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">explicit =</span> <span class="fu">as.factor</span>(explicit),</span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>         <span class="at">genre =</span> <span class="fu">as.factor</span>(track_genre),</span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a>         <span class="at">daily =</span> daily,</span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a>         <span class="co">#streams = ifelse(streams&gt;3825666400, 942193161, streams),</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a>         <span class="co">#times = as.factor(time_signature),</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a>         <span class="co">#energy = ifelse(energy&gt;.5,1,0),</span></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a>         <span class="co">#duration = ifelse(between(duration_ms, 200000, 250000), 1, 0),</span></span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a>         <span class="co">#loud = ifelse(loud&gt;-9, 1, 0),</span></span>
<span id="cb15-30"><a href="#cb15-30" tabindex="-1"></a>         <span class="at">dance =</span> <span class="fu">ifelse</span>(danceability<span class="sc">&gt;</span>.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb15-31"><a href="#cb15-31" tabindex="-1"></a>         <span class="at">words =</span> <span class="fu">ifelse</span>(<span class="fu">between</span>(words, .<span class="dv">025</span>, .<span class="dv">06</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb15-32"><a href="#cb15-32" tabindex="-1"></a>         <span class="at">instrumental =</span> <span class="fu">ifelse</span>(instrumental<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb15-33"><a href="#cb15-33" tabindex="-1"></a>         <span class="co">#popularity = ifelse(popularity&gt;76,1,0),</span></span>
<span id="cb15-34"><a href="#cb15-34" tabindex="-1"></a>         <span class="at">live =</span> <span class="fu">ifelse</span>(live<span class="sc">&lt;</span>.<span class="dv">37</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb15-35"><a href="#cb15-35" tabindex="-1"></a>         <span class="at">key =</span> <span class="fu">case_when</span>(key <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb15-36"><a href="#cb15-36" tabindex="-1"></a>         <span class="at">explicit =</span> <span class="fu">case_when</span>(explicit <span class="sc">==</span> <span class="st">&quot;TRUE&quot;</span> <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb15-37"><a href="#cb15-37" tabindex="-1"></a>         <span class="at">genre =</span> <span class="fu">case_when</span>(genre <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;pop&quot;</span>, <span class="st">&quot;chill&quot;</span>, <span class="st">&quot;indie&quot;</span>, <span class="st">&quot;garage&quot;</span>, <span class="st">&quot;ambient&quot;</span>, <span class="st">&quot;folk&quot;</span>, <span class="st">&quot;indie-pop&quot;</span>, <span class="st">&quot;power-pop&quot;</span>, <span class="st">&quot;reggae&quot;</span>, <span class="st">&quot;soul&quot;</span>, <span class="st">&quot;synth-pop&quot;</span>, <span class="st">&quot;swedish&quot;</span>, <span class="st">&quot;country&quot;</span>, <span class="st">&quot;metal&quot;</span>, <span class="st">&quot;german&quot;</span>, <span class="st">&quot;funk&quot;</span>, <span class="st">&quot;alternative&quot;</span>, <span class="st">&quot;alt-rock&quot;</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb15-38"><a href="#cb15-38" tabindex="-1"></a>         <span class="at">peak_last_year =</span> <span class="fu">ifelse</span>(months_sincepk<span class="sc">&lt;</span><span class="dv">13</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb15-39"><a href="#cb15-39" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">ifelse</span>(popularity <span class="sc">&gt;</span><span class="dv">79</span> ,<span class="dv">1</span> ,<span class="dv">0</span>),</span>
<span id="cb15-40"><a href="#cb15-40" tabindex="-1"></a>         <span class="at">popularity0 =</span> <span class="fu">round</span>(popularity <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>,</span>
<span id="cb15-41"><a href="#cb15-41" tabindex="-1"></a>         <span class="at">popularity0 =</span> <span class="fu">case_when</span>( popularity0 <span class="sc">&gt;</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">1</span>, popularity <span class="sc">==</span> <span class="dv">80</span> <span class="sc">~</span> <span class="dv">2</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">3</span> ),</span>
<span id="cb15-42"><a href="#cb15-42" tabindex="-1"></a>         <span class="at">popularity1 =</span> <span class="fu">round</span>(popularity <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb15-43"><a href="#cb15-43" tabindex="-1"></a>         <span class="at">popularity1 =</span> <span class="fu">case_when</span>( popularity1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>, popularity1 <span class="sc">==</span> <span class="dv">70</span> <span class="sc">~</span> <span class="dv">2</span>, popularity1 <span class="sc">==</span> <span class="dv">80</span> <span class="sc">~</span> <span class="dv">3</span>,  popularity1 <span class="sc">==</span> <span class="dv">90</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">5</span> ),</span>
<span id="cb15-44"><a href="#cb15-44" tabindex="-1"></a>         <span class="at">times =</span> <span class="fu">case_when</span>(time_signature <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb15-45"><a href="#cb15-45" tabindex="-1"></a>         <span class="at">energy =</span> <span class="fu">round</span>(energy<span class="sc">*</span><span class="dv">10</span>),</span>
<span id="cb15-46"><a href="#cb15-46" tabindex="-1"></a>         <span class="at">popular_artist =</span> <span class="fu">case_when</span>(artist_streams <span class="sc">&gt;</span> <span class="dv">75000</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">between</span>(artist_streams, <span class="dv">50000</span>,<span class="dv">75000</span>) <span class="sc">~</span> <span class="dv">2</span>, <span class="fu">between</span>(artist_streams, <span class="dv">25000</span>,<span class="dv">50000</span>) <span class="sc">~</span> <span class="dv">3</span>, artist_streams <span class="sc">&lt;</span> <span class="dv">25000</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span> ),</span>
<span id="cb15-47"><a href="#cb15-47" tabindex="-1"></a>         <span class="at">diff =</span> peak_monthly_listeners <span class="sc">-</span> monthly_listeners,</span>
<span id="cb15-48"><a href="#cb15-48" tabindex="-1"></a>         <span class="at">current_hit =</span> <span class="fu">ifelse</span>(diff<span class="sc">&gt;</span><span class="dv">20000000</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb15-49"><a href="#cb15-49" tabindex="-1"></a>         <span class="at">current_trend =</span> <span class="fu">ifelse</span>(daily_average<span class="sc">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-50"><a href="#cb15-50" tabindex="-1"></a>         <span class="co">#popularity = ifelse(popularity&gt;76,1,0)) |&gt;</span></span>
<span id="cb15-51"><a href="#cb15-51" tabindex="-1"></a>  <span class="co">#distinct(artist, .keep_all = TRUE) |&gt;</span></span>
<span id="cb15-52"><a href="#cb15-52" tabindex="-1"></a>  <span class="fu">distinct</span>(title, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-53"><a href="#cb15-53" tabindex="-1"></a>  <span class="fu">filter</span>(months_sincepk <span class="sc">&lt;</span> <span class="dv">120</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-54"><a href="#cb15-54" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">159</span>))) <span class="sc">|&gt;</span></span>
<span id="cb15-55"><a href="#cb15-55" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">108</span>,<span class="dv">297</span>,<span class="dv">324</span>))) <span class="sc">|&gt;</span></span>
<span id="cb15-56"><a href="#cb15-56" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">278</span>))) <span class="sc">|&gt;</span></span>
<span id="cb15-57"><a href="#cb15-57" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">245</span>,<span class="dv">215</span>))) <span class="sc">|&gt;</span></span>
<span id="cb15-58"><a href="#cb15-58" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">200</span>))) <span class="sc">|&gt;</span></span>
<span id="cb15-59"><a href="#cb15-59" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">208</span>))) <span class="sc">|&gt;</span></span>
<span id="cb15-60"><a href="#cb15-60" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(daily1, streams, daily, popularity0, popularity1,  explicit, dance, energy, key, loud, mode, words, acoustics, instrumental, live, valence, tempo, times, genre, duration_ms, popular_artist, monthly_listeners, peak_monthly_listeners, months_sincepk, peak_last_year, daily_average, diff,current_hit,current_trend, artist_streams)</span>
<span id="cb15-61"><a href="#cb15-61" tabindex="-1"></a></span>
<span id="cb15-62"><a href="#cb15-62" tabindex="-1"></a></span>
<span id="cb15-63"><a href="#cb15-63" tabindex="-1"></a><span class="co">#dt$daily &lt;- sqrt(dt$daily)</span></span>
<span id="cb15-64"><a href="#cb15-64" tabindex="-1"></a><span class="co"># dt1$daily &lt;- sqrt(dt1$daily)</span></span>
<span id="cb15-65"><a href="#cb15-65" tabindex="-1"></a><span class="co"># dt2$daily &lt;- sqrt(dt2$daily)</span></span>
<span id="cb15-66"><a href="#cb15-66" tabindex="-1"></a><span class="co"># dt3$daily &lt;- sqrt(dt3$daily)</span></span>
<span id="cb15-67"><a href="#cb15-67" tabindex="-1"></a></span>
<span id="cb15-68"><a href="#cb15-68" tabindex="-1"></a>dtss1 <span class="ot">&lt;-</span> dtss <span class="sc">|&gt;</span></span>
<span id="cb15-69"><a href="#cb15-69" tabindex="-1"></a>  <span class="fu">filter</span>(popularity0 <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb15-70"><a href="#cb15-70" tabindex="-1"></a></span>
<span id="cb15-71"><a href="#cb15-71" tabindex="-1"></a>dtss2 <span class="ot">&lt;-</span> dtss <span class="sc">|&gt;</span></span>
<span id="cb15-72"><a href="#cb15-72" tabindex="-1"></a>  <span class="fu">filter</span>(popularity0 <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb15-73"><a href="#cb15-73" tabindex="-1"></a></span>
<span id="cb15-74"><a href="#cb15-74" tabindex="-1"></a>dtss3 <span class="ot">&lt;-</span> dtss <span class="sc">|&gt;</span></span>
<span id="cb15-75"><a href="#cb15-75" tabindex="-1"></a>  <span class="fu">filter</span>(popularity0 <span class="sc">==</span> <span class="dv">3</span>)</span>
<span id="cb15-76"><a href="#cb15-76" tabindex="-1"></a></span>
<span id="cb15-77"><a href="#cb15-77" tabindex="-1"></a><span class="co">#consider sqrt transf</span></span>
<span id="cb15-78"><a href="#cb15-78" tabindex="-1"></a></span>
<span id="cb15-79"><a href="#cb15-79" tabindex="-1"></a>mylms <span class="ot">&lt;-</span> <span class="fu">lm</span>(((daily)) <span class="sc">~</span></span>
<span id="cb15-80"><a href="#cb15-80" tabindex="-1"></a></span>
<span id="cb15-81"><a href="#cb15-81" tabindex="-1"></a>            <span class="co">#streams+ #x</span></span>
<span id="cb15-82"><a href="#cb15-82" tabindex="-1"></a></span>
<span id="cb15-83"><a href="#cb15-83" tabindex="-1"></a>             popularity0 <span class="sc">+</span></span>
<span id="cb15-84"><a href="#cb15-84" tabindex="-1"></a></span>
<span id="cb15-85"><a href="#cb15-85" tabindex="-1"></a>             popular_artist<span class="sc">:</span>current_trend <span class="sc">+</span></span>
<span id="cb15-86"><a href="#cb15-86" tabindex="-1"></a></span>
<span id="cb15-87"><a href="#cb15-87" tabindex="-1"></a>             popularity0<span class="sc">:</span>genre <span class="sc">+</span></span>
<span id="cb15-88"><a href="#cb15-88" tabindex="-1"></a></span>
<span id="cb15-89"><a href="#cb15-89" tabindex="-1"></a>             monthly_listeners <span class="sc">+</span></span>
<span id="cb15-90"><a href="#cb15-90" tabindex="-1"></a></span>
<span id="cb15-91"><a href="#cb15-91" tabindex="-1"></a>             months_sincepk <span class="sc">+</span></span>
<span id="cb15-92"><a href="#cb15-92" tabindex="-1"></a></span>
<span id="cb15-93"><a href="#cb15-93" tabindex="-1"></a>             streams<span class="sc">:</span>words <span class="sc">+</span></span>
<span id="cb15-94"><a href="#cb15-94" tabindex="-1"></a></span>
<span id="cb15-95"><a href="#cb15-95" tabindex="-1"></a>             streams<span class="sc">:</span>popular_artist <span class="sc">+</span></span>
<span id="cb15-96"><a href="#cb15-96" tabindex="-1"></a></span>
<span id="cb15-97"><a href="#cb15-97" tabindex="-1"></a>             streams<span class="sc">:</span>current_trend<span class="sc">:</span>peak_last_year</span>
<span id="cb15-98"><a href="#cb15-98" tabindex="-1"></a></span>
<span id="cb15-99"><a href="#cb15-99" tabindex="-1"></a>, dtss)</span>
<span id="cb15-100"><a href="#cb15-100" tabindex="-1"></a></span>
<span id="cb15-101"><a href="#cb15-101" tabindex="-1"></a></span>
<span id="cb15-102"><a href="#cb15-102" tabindex="-1"></a>c <span class="ot">&lt;-</span><span class="fu">coef</span>(mylms)</span>
<span id="cb15-103"><a href="#cb15-103" tabindex="-1"></a></span>
<span id="cb15-104"><a href="#cb15-104" tabindex="-1"></a></span>
<span id="cb15-105"><a href="#cb15-105" tabindex="-1"></a></span>
<span id="cb15-106"><a href="#cb15-106" tabindex="-1"></a></span>
<span id="cb15-107"><a href="#cb15-107" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dtss1, <span class="fu">aes</span>((streams),(daily)))<span class="sc">+</span></span>
<span id="cb15-108"><a href="#cb15-108" tabindex="-1"></a></span>
<span id="cb15-109"><a href="#cb15-109" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> T, <span class="at">col=</span><span class="st">&quot;orange&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-110"><a href="#cb15-110" tabindex="-1"></a></span>
<span id="cb15-111"><a href="#cb15-111" tabindex="-1"></a>  <span class="co">#geom_smooth(method = &quot;lm&quot;)+</span></span>
<span id="cb15-112"><a href="#cb15-112" tabindex="-1"></a></span>
<span id="cb15-113"><a href="#cb15-113" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(</span>
<span id="cb15-114"><a href="#cb15-114" tabindex="-1"></a>    x, <span class="at">popularity=</span><span class="dv">1</span>, <span class="at">monthly_listeners=</span> <span class="dv">55517581</span>, <span class="at">months_sincepk=</span> <span class="fl">36.50862</span>, <span class="at">popular_artist=</span> <span class="fl">3.232759</span>, <span class="at">current_trend=</span> <span class="fl">0.2327586</span>, <span class="at">genre=</span><span class="fl">0.4482759</span>, <span class="at">words=</span><span class="fl">0.5689655</span>, <span class="at">peak_last_year=</span> <span class="fl">0.3706897</span>)</span>
<span id="cb15-115"><a href="#cb15-115" tabindex="-1"></a>    </span>
<span id="cb15-116"><a href="#cb15-116" tabindex="-1"></a>    (b[<span class="dv">1</span>] <span class="sc">+</span> c[<span class="dv">2</span>]<span class="sc">*</span>popularity <span class="sc">+</span> c[<span class="dv">3</span>]<span class="sc">*</span>monthly_listeners <span class="sc">+</span> c[<span class="dv">4</span>]<span class="sc">*</span>months_sincepk <span class="sc">+</span> c[<span class="dv">5</span>]<span class="sc">*</span>popular_artist<span class="sc">*</span>current_trend <span class="sc">+</span> c[<span class="dv">6</span>]<span class="sc">*</span>popularity<span class="sc">*</span>genre) <span class="sc">+</span></span>
<span id="cb15-117"><a href="#cb15-117" tabindex="-1"></a>      </span>
<span id="cb15-118"><a href="#cb15-118" tabindex="-1"></a>    (c[<span class="dv">7</span>]<span class="sc">*</span>words <span class="sc">+</span> c[<span class="dv">8</span>]<span class="sc">*</span>popular_artist <span class="sc">+</span> c[<span class="dv">9</span>]<span class="sc">*</span>current_trend<span class="sc">*</span>peak_last_year)<span class="sc">*</span>(x), <span class="at">col=</span><span class="st">&quot;orange&quot;</span>, <span class="at">linewidth =</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb15-119"><a href="#cb15-119" tabindex="-1"></a></span>
<span id="cb15-120"><a href="#cb15-120" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2000000</span>, <span class="at">by=</span><span class="dv">500000</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;500,000&quot;</span>,<span class="st">&quot;1,000,000&quot;</span>,<span class="st">&quot;1,500,000&quot;</span>,<span class="st">&quot;2,000,000&quot;</span>))<span class="sc">+</span></span>
<span id="cb15-121"><a href="#cb15-121" tabindex="-1"></a></span>
<span id="cb15-122"><a href="#cb15-122" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1000000000</span>, <span class="dv">2000000000</span>, <span class="dv">3000000000</span>, <span class="dv">4000000000</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1 B&quot;</span>, <span class="st">&quot;2 B&quot;</span>, <span class="st">&quot;3 B&quot;</span>, <span class="st">&quot;4 B&quot;</span>))<span class="sc">+</span></span>
<span id="cb15-123"><a href="#cb15-123" tabindex="-1"></a></span>
<span id="cb15-124"><a href="#cb15-124" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb15-125"><a href="#cb15-125" tabindex="-1"></a></span>
<span id="cb15-126"><a href="#cb15-126" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-127"><a href="#cb15-127" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Popularity group: 1&quot;</span>,</span>
<span id="cb15-128"><a href="#cb15-128" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Monthly listeners: 55mill, Months since artist peak: 36, </span><span class="sc">\n</span><span class="st">Artist peaked last year: .4, artist popularity: 3, </span><span class="sc">\n</span><span class="st">Current Trend: .25, Genre: .45, words: .6&quot;</span>,</span>
<span id="cb15-129"><a href="#cb15-129" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb15-130"><a href="#cb15-130" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-131"><a href="#cb15-131" tabindex="-1"></a></span>
<span id="cb15-132"><a href="#cb15-132" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-133"><a href="#cb15-133" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>),</span>
<span id="cb15-134"><a href="#cb15-134" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>),</span>
<span id="cb15-135"><a href="#cb15-135" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>),</span>
<span id="cb15-136"><a href="#cb15-136" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb15-137"><a href="#cb15-137" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb15-138"><a href="#cb15-138" tabindex="-1"></a></span>
<span id="cb15-139"><a href="#cb15-139" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dtss2, <span class="fu">aes</span>((streams),(daily)))<span class="sc">+</span></span>
<span id="cb15-140"><a href="#cb15-140" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">show.legend =</span> T, <span class="at">col=</span><span class="st">&quot;#9EA1F9&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-141"><a href="#cb15-141" tabindex="-1"></a>   <span class="co">#geom_smooth(method = &quot;lm&quot;)+</span></span>
<span id="cb15-142"><a href="#cb15-142" tabindex="-1"></a></span>
<span id="cb15-143"><a href="#cb15-143" tabindex="-1"></a>   <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x, <span class="at">popularity=</span><span class="dv">2</span>, <span class="at">monthly_listeners=</span> <span class="dv">48407097</span>, <span class="at">months_sincepk=</span> <span class="fl">49.54783</span>, <span class="at">popular_artist=</span> <span class="fl">3.565217</span>, <span class="at">current_trend=</span> <span class="fl">0.2608696</span>, <span class="at">genre=</span><span class="fl">0.2782609</span>, <span class="at">words=</span><span class="fl">0.6</span>, <span class="at">peak_last_year=</span> <span class="fl">0.2956522</span>)</span>
<span id="cb15-144"><a href="#cb15-144" tabindex="-1"></a></span>
<span id="cb15-145"><a href="#cb15-145" tabindex="-1"></a>     (c[<span class="dv">1</span>] <span class="sc">+</span> c[<span class="dv">2</span>]<span class="sc">*</span>popularity <span class="sc">+</span> c[<span class="dv">3</span>]<span class="sc">*</span>monthly_listeners <span class="sc">+</span> c[<span class="dv">4</span>]<span class="sc">*</span>months_sincepk <span class="sc">+</span> c[<span class="dv">5</span>]<span class="sc">*</span>popular_artist<span class="sc">*</span>current_trend <span class="sc">+</span>c[<span class="dv">6</span>]<span class="sc">*</span>popularity<span class="sc">*</span>genre) <span class="sc">+</span></span>
<span id="cb15-146"><a href="#cb15-146" tabindex="-1"></a></span>
<span id="cb15-147"><a href="#cb15-147" tabindex="-1"></a>     (c[<span class="dv">7</span>]<span class="sc">*</span>words <span class="sc">+</span> c[<span class="dv">8</span>]<span class="sc">*</span>popular_artist <span class="sc">+</span> c[<span class="dv">9</span>]<span class="sc">*</span>current_trend<span class="sc">*</span>peak_last_year)<span class="sc">*</span>(x), <span class="at">col=</span><span class="st">&quot;#9EA1F9&quot;</span>, <span class="at">linewidth =</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb15-148"><a href="#cb15-148" tabindex="-1"></a></span>
<span id="cb15-149"><a href="#cb15-149" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">300000</span>, <span class="dv">1200000</span>, <span class="at">by=</span><span class="dv">300000</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;300,000&quot;</span>, <span class="st">&quot;600,000&quot;</span>,<span class="st">&quot;900,000&quot;</span>, <span class="st">&quot;1,200,000&quot;</span>))<span class="sc">+</span></span>
<span id="cb15-150"><a href="#cb15-150" tabindex="-1"></a></span>
<span id="cb15-151"><a href="#cb15-151" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">500000000</span>, <span class="dv">1000000000</span>, <span class="dv">1500000000</span>, <span class="dv">2000000000</span>, <span class="dv">2500000000</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;.5 B&quot;</span>, <span class="st">&quot;1 B&quot;</span>, <span class="st">&quot;1.5 B&quot;</span>, <span class="st">&quot;2 B&quot;</span>, <span class="st">&quot;2.5 B&quot;</span>))<span class="sc">+</span></span>
<span id="cb15-152"><a href="#cb15-152" tabindex="-1"></a></span>
<span id="cb15-153"><a href="#cb15-153" tabindex="-1"></a>   <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb15-154"><a href="#cb15-154" tabindex="-1"></a></span>
<span id="cb15-155"><a href="#cb15-155" tabindex="-1"></a>   <span class="fu">labs</span>(</span>
<span id="cb15-156"><a href="#cb15-156" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">&quot;Popularity group: 2&quot;</span>,</span>
<span id="cb15-157"><a href="#cb15-157" tabindex="-1"></a>     <span class="at">subtitle =</span> <span class="st">&quot;Monthly listeners: 48 mill, Months since artist peak: 50, </span><span class="sc">\n</span><span class="st">Artist peaked last year: .3, artist popularity: 3.5, </span><span class="sc">\n</span><span class="st">Current Trend: .26, Genre: .28, words: .6&quot;</span>,</span>
<span id="cb15-158"><a href="#cb15-158" tabindex="-1"></a>     <span class="at">x=</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb15-159"><a href="#cb15-159" tabindex="-1"></a>     <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-160"><a href="#cb15-160" tabindex="-1"></a></span>
<span id="cb15-161"><a href="#cb15-161" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-162"><a href="#cb15-162" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>),</span>
<span id="cb15-163"><a href="#cb15-163" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>),</span>
<span id="cb15-164"><a href="#cb15-164" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>),</span>
<span id="cb15-165"><a href="#cb15-165" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb15-166"><a href="#cb15-166" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb15-167"><a href="#cb15-167" tabindex="-1"></a></span>
<span id="cb15-168"><a href="#cb15-168" tabindex="-1"></a> <span class="do">## 3</span></span>
<span id="cb15-169"><a href="#cb15-169" tabindex="-1"></a></span>
<span id="cb15-170"><a href="#cb15-170" tabindex="-1"></a></span>
<span id="cb15-171"><a href="#cb15-171" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dtss3, <span class="fu">aes</span>((streams),(daily)))<span class="sc">+</span></span>
<span id="cb15-172"><a href="#cb15-172" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">show.legend =</span> T, <span class="at">col=</span><span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-173"><a href="#cb15-173" tabindex="-1"></a>   <span class="co">#geom_smooth(method = &quot;lm&quot;)+</span></span>
<span id="cb15-174"><a href="#cb15-174" tabindex="-1"></a></span>
<span id="cb15-175"><a href="#cb15-175" tabindex="-1"></a>   <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x, <span class="at">popularity=</span><span class="dv">3</span>, <span class="at">monthly_listeners=</span> <span class="dv">46092154</span>, <span class="at">months_sincepk=</span> <span class="fl">45.65</span>, <span class="at">popular_artist=</span> <span class="fl">3.67</span>, <span class="at">current_trend=</span> <span class="fl">0.44</span>, <span class="at">genre=</span><span class="fl">0.19</span>, <span class="at">words=</span><span class="fl">0.57</span>, <span class="at">peak_last_year=</span> <span class="fl">0.17</span>)</span>
<span id="cb15-176"><a href="#cb15-176" tabindex="-1"></a></span>
<span id="cb15-177"><a href="#cb15-177" tabindex="-1"></a>     (c[<span class="dv">1</span>] <span class="sc">+</span> c[<span class="dv">2</span>]<span class="sc">*</span>popularity <span class="sc">+</span> c[<span class="dv">3</span>]<span class="sc">*</span>monthly_listeners <span class="sc">+</span> c[<span class="dv">4</span>]<span class="sc">*</span>months_sincepk <span class="sc">+</span> c[<span class="dv">5</span>]<span class="sc">*</span>popular_artist<span class="sc">*</span>current_trend <span class="sc">+</span>c[<span class="dv">6</span>]<span class="sc">*</span>popularity<span class="sc">*</span>genre) <span class="sc">+</span></span>
<span id="cb15-178"><a href="#cb15-178" tabindex="-1"></a></span>
<span id="cb15-179"><a href="#cb15-179" tabindex="-1"></a>     (c[<span class="dv">7</span>]<span class="sc">*</span>words <span class="sc">+</span> c[<span class="dv">8</span>]<span class="sc">*</span>popular_artist <span class="sc">+</span> c[<span class="dv">9</span>]<span class="sc">*</span>current_trend<span class="sc">*</span>peak_last_year)<span class="sc">*</span>(x), <span class="at">col=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">linewidth =</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb15-180"><a href="#cb15-180" tabindex="-1"></a></span>
<span id="cb15-181"><a href="#cb15-181" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1500000</span>, <span class="at">by=</span><span class="dv">500000</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;500,000&quot;</span>,<span class="st">&quot;1,000,000&quot;</span>,<span class="st">&quot;1,500,000&quot;</span>))<span class="sc">+</span></span>
<span id="cb15-182"><a href="#cb15-182" tabindex="-1"></a></span>
<span id="cb15-183"><a href="#cb15-183" tabindex="-1"></a>     <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">500000000</span>, <span class="dv">1000000000</span>, <span class="dv">1500000000</span>, <span class="dv">2000000000</span>, <span class="dv">2500000000</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;.5 B&quot;</span>, <span class="st">&quot;1 B&quot;</span>, <span class="st">&quot;1.5 B&quot;</span>, <span class="st">&quot;2 B&quot;</span>, <span class="st">&quot;2.5 B&quot;</span>))<span class="sc">+</span></span>
<span id="cb15-184"><a href="#cb15-184" tabindex="-1"></a></span>
<span id="cb15-185"><a href="#cb15-185" tabindex="-1"></a>   <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb15-186"><a href="#cb15-186" tabindex="-1"></a></span>
<span id="cb15-187"><a href="#cb15-187" tabindex="-1"></a>   <span class="fu">labs</span>(</span>
<span id="cb15-188"><a href="#cb15-188" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">&quot;Popularity group: 3&quot;</span>,</span>
<span id="cb15-189"><a href="#cb15-189" tabindex="-1"></a>     <span class="at">subtitle =</span> <span class="st">&quot;Monthly listeners: 46 mill, Months since artist peak: 45, </span><span class="sc">\n</span><span class="st">Artist peaked last year: .2, artist popularity: 3.6, </span><span class="sc">\n</span><span class="st">Current Trend: .44, Genre: .2, words: .6&quot;</span>,</span>
<span id="cb15-190"><a href="#cb15-190" tabindex="-1"></a>     <span class="at">x=</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb15-191"><a href="#cb15-191" tabindex="-1"></a>     <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-192"><a href="#cb15-192" tabindex="-1"></a></span>
<span id="cb15-193"><a href="#cb15-193" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb15-194"><a href="#cb15-194" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>),</span>
<span id="cb15-195"><a href="#cb15-195" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>),</span>
<span id="cb15-196"><a href="#cb15-196" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>),</span>
<span id="cb15-197"><a href="#cb15-197" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb15-198"><a href="#cb15-198" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>))</span>
<span id="cb15-199"><a href="#cb15-199" tabindex="-1"></a> </span>
<span id="cb15-200"><a href="#cb15-200" tabindex="-1"></a> <span class="fu">grid.arrange</span>(g1, g2, g3,</span>
<span id="cb15-201"><a href="#cb15-201" tabindex="-1"></a>              <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb15-202"><a href="#cb15-202" tabindex="-1"></a>              <span class="at">top =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Spotify&#39;s Streaming Correlation&quot;</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">12</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)),</span>
<span id="cb15-203"><a href="#cb15-203" tabindex="-1"></a>              <span class="at">left =</span> <span class="fu">textGrob</span>(<span class="st">&quot;Daily Streams&quot;</span>, <span class="at">rot =</span> <span class="dv">90</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">12</span>)),</span>
<span id="cb15-204"><a href="#cb15-204" tabindex="-1"></a>              <span class="at">bottom =</span> <span class="fu">textGrob</span>(<span class="st">&quot;All Time Streams&quot;</span>, <span class="at">gp =</span> <span class="fu">gpar</span>(<span class="at">fontsize =</span> <span class="dv">12</span>))</span>
<span id="cb15-205"><a href="#cb15-205" tabindex="-1"></a>              )</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/alternative%20model-1.png" width="1296" style="display: block; margin: auto;" /></p>
<p><br></p>
<p><span class="math display">\[\text{Math equation:} \\\ \\ \text{Song
daily streams} = \text{Popularity} + \text{monthly listeners} \\ +
\text{months since peak} \\ + \text{Popular artist influence} \times
\text{Current trend} \\ + \text{popularity} \times \text{genre} \\ +
\text{All time streams} \times \text{words} \\ + \text{All time streams}
\times \text{popular artist} \\ + \text{All time streams} \times
\text{Current trend} \times \text{Peak last year} \]</span></p>
<p><br></p>
<p>This was my initial model. Before I found any data from Kworb’s
project, I found some data in Kaggle that was interesting to check. This
dataset contained many variables that were available in SpotifyR (Tempo,
Keys, Loudness, etc..). but since SpotifyR is not being maintained
anymore; the get_all_artists function will only work for 50 artists,
which is not much. this is why I looked up for more information. But
before that I did some work and got a decent analysis on their data.</p>
<p>The model was trying to explain, song by song, what made a song more
or less popular, not only in their streamings, but also because the
model uses multiple variables. For example, song popularity, artist
popularity, current artist trend, use or swear words or not, all of
these, and others were useful for this model</p>
<p>Popularity had a big role in this model, Spotify offers an expert
rating on song popularity 0-100. I worked that rating up so that 3
popularity groups were considered. I wont test hypothesis on this model,
but feel free to check how it went overall in terms of significance.</p>
<p><br><br><br><br></p>
</div>
<div id="model-selection-2" class="section level6">
<h6>Model Selection</h6>
<p><br></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>dtag <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://github.com/Tonadeleon/Regression-Projects/raw/main/Datasets/dataset.csv&quot;</span>)<span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="co">#filter(popularity &gt; 59) |&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">title =</span> track_name,</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>         <span class="at">artist =</span> artists,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>         <span class="at">title_id =</span> track_id,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>         <span class="at">album =</span> album_name,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>         <span class="at">loud =</span> loudness,</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>         <span class="at">words =</span> speechiness,</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>         <span class="at">acoustics =</span> acousticness,</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>         <span class="at">instrumental =</span> instrumentalness,</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>         <span class="at">live =</span> liveness) <span class="sc">|&gt;</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>  <span class="fu">inner_join</span>(df1, <span class="at">by=</span><span class="st">&quot;artist&quot;</span>, <span class="at">relationship =</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  <span class="fu">inner_join</span>(df2, <span class="at">by=</span><span class="st">&quot;artist&quot;</span>, <span class="at">relationship =</span></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>)</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>dtssg <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(dtag, df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;artist&quot;</span>), <span class="at">relationship =</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">explicit =</span> <span class="fu">as.factor</span>(explicit),</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>         <span class="at">genre =</span> <span class="fu">as.factor</span>(track_genre),</span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>         <span class="at">daily =</span> daily,</span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>         <span class="co">#streams = ifelse(streams&gt;3825666400, 942193161, streams),</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>         <span class="co">#times = as.factor(time_signature),</span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>         <span class="co">#energy = ifelse(energy&gt;.5,1,0),</span></span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a>         <span class="co">#duration = ifelse(between(duration_ms, 200000, 250000), 1, 0),</span></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a>         <span class="co">#loud = ifelse(loud&gt;-9, 1, 0),</span></span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>         <span class="at">dance =</span> <span class="fu">ifelse</span>(danceability<span class="sc">&gt;</span>.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a>         <span class="at">words =</span> <span class="fu">ifelse</span>(<span class="fu">between</span>(words, .<span class="dv">025</span>, .<span class="dv">06</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a>         <span class="at">instrumental =</span> <span class="fu">ifelse</span>(instrumental<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a>         <span class="co">#popularity = ifelse(popularity&gt;76,1,0),</span></span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a>         <span class="at">live =</span> <span class="fu">ifelse</span>(live<span class="sc">&lt;</span>.<span class="dv">37</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a>         <span class="at">key =</span> <span class="fu">case_when</span>(key <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a>         <span class="at">explicit =</span> <span class="fu">case_when</span>(explicit <span class="sc">==</span> <span class="st">&quot;TRUE&quot;</span> <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb16-37"><a href="#cb16-37" tabindex="-1"></a>         <span class="at">genre =</span> <span class="fu">case_when</span>(genre <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;pop&quot;</span>, <span class="st">&quot;chill&quot;</span>, <span class="st">&quot;indie&quot;</span>, <span class="st">&quot;garage&quot;</span>, <span class="st">&quot;ambient&quot;</span>, <span class="st">&quot;folk&quot;</span>, <span class="st">&quot;indie-pop&quot;</span>, <span class="st">&quot;power-pop&quot;</span>, <span class="st">&quot;reggae&quot;</span>, <span class="st">&quot;soul&quot;</span>, <span class="st">&quot;synth-pop&quot;</span>, <span class="st">&quot;swedish&quot;</span>, <span class="st">&quot;country&quot;</span>, <span class="st">&quot;metal&quot;</span>, <span class="st">&quot;german&quot;</span>, <span class="st">&quot;funk&quot;</span>, <span class="st">&quot;alternative&quot;</span>, <span class="st">&quot;alt-rock&quot;</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb16-38"><a href="#cb16-38" tabindex="-1"></a>         <span class="at">peak_last_year =</span> <span class="fu">ifelse</span>(months_sincepk<span class="sc">&lt;</span><span class="dv">13</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb16-39"><a href="#cb16-39" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">ifelse</span>(popularity <span class="sc">&gt;</span><span class="dv">79</span> ,<span class="dv">1</span> ,<span class="dv">0</span>),</span>
<span id="cb16-40"><a href="#cb16-40" tabindex="-1"></a>         <span class="at">popularity0 =</span> <span class="fu">round</span>(popularity <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>,</span>
<span id="cb16-41"><a href="#cb16-41" tabindex="-1"></a>         <span class="at">popularity0 =</span> <span class="fu">case_when</span>( popularity0 <span class="sc">&gt;</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">1</span>, popularity <span class="sc">==</span> <span class="dv">80</span> <span class="sc">~</span> <span class="dv">2</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">3</span> ),</span>
<span id="cb16-42"><a href="#cb16-42" tabindex="-1"></a>         <span class="at">popularity1 =</span> <span class="fu">round</span>(popularity <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb16-43"><a href="#cb16-43" tabindex="-1"></a>         <span class="at">popularity1 =</span> <span class="fu">case_when</span>( popularity1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>, popularity1 <span class="sc">==</span> <span class="dv">70</span> <span class="sc">~</span> <span class="dv">2</span>, popularity1 <span class="sc">==</span> <span class="dv">80</span> <span class="sc">~</span> <span class="dv">3</span>,  popularity1 <span class="sc">==</span> <span class="dv">90</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">5</span> ),</span>
<span id="cb16-44"><a href="#cb16-44" tabindex="-1"></a>         <span class="at">times =</span> <span class="fu">case_when</span>(time_signature <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb16-45"><a href="#cb16-45" tabindex="-1"></a>         <span class="at">energy =</span> <span class="fu">round</span>(energy<span class="sc">*</span><span class="dv">10</span>),</span>
<span id="cb16-46"><a href="#cb16-46" tabindex="-1"></a>         <span class="at">popular_artist =</span> <span class="fu">case_when</span>(artist_streams <span class="sc">&gt;</span> <span class="dv">75000</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">between</span>(artist_streams, <span class="dv">50000</span>,<span class="dv">75000</span>) <span class="sc">~</span> <span class="dv">2</span>, <span class="fu">between</span>(artist_streams, <span class="dv">25000</span>,<span class="dv">50000</span>) <span class="sc">~</span> <span class="dv">3</span>, artist_streams <span class="sc">&lt;</span> <span class="dv">25000</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span> ),</span>
<span id="cb16-47"><a href="#cb16-47" tabindex="-1"></a>         <span class="at">diff =</span> peak_monthly_listeners <span class="sc">-</span> monthly_listeners,</span>
<span id="cb16-48"><a href="#cb16-48" tabindex="-1"></a>         <span class="at">current_hit =</span> <span class="fu">ifelse</span>(diff<span class="sc">&gt;</span><span class="dv">20000000</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb16-49"><a href="#cb16-49" tabindex="-1"></a>         <span class="at">current_trend =</span> <span class="fu">ifelse</span>(daily_average<span class="sc">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb16-50"><a href="#cb16-50" tabindex="-1"></a>         <span class="co">#popularity = ifelse(popularity&gt;76,1,0)) |&gt;</span></span>
<span id="cb16-51"><a href="#cb16-51" tabindex="-1"></a>  <span class="co">#distinct(artist, .keep_all = TRUE) |&gt;</span></span>
<span id="cb16-52"><a href="#cb16-52" tabindex="-1"></a>  <span class="fu">distinct</span>(title, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-53"><a href="#cb16-53" tabindex="-1"></a>  <span class="co">#filter(months_sincepk &lt; 120) |&gt;</span></span>
<span id="cb16-54"><a href="#cb16-54" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">159</span>))) <span class="sc">|&gt;</span></span>
<span id="cb16-55"><a href="#cb16-55" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">108</span>,<span class="dv">297</span>,<span class="dv">324</span>))) <span class="sc">|&gt;</span></span>
<span id="cb16-56"><a href="#cb16-56" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">278</span>))) <span class="sc">|&gt;</span></span>
<span id="cb16-57"><a href="#cb16-57" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">245</span>,<span class="dv">215</span>))) <span class="sc">|&gt;</span></span>
<span id="cb16-58"><a href="#cb16-58" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">200</span>))) <span class="sc">|&gt;</span></span>
<span id="cb16-59"><a href="#cb16-59" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">208</span>))) <span class="sc">|&gt;</span></span>
<span id="cb16-60"><a href="#cb16-60" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(daily1, streams, daily, popularity0, popularity1,  explicit, dance, energy, key, loud, mode, words, acoustics, instrumental, live, valence, tempo, times, genre, duration_ms, popular_artist, monthly_listeners, peak_monthly_listeners, months_sincepk, peak_last_year, daily_average, diff,current_hit,current_trend, artist_streams, popularity)</span>
<span id="cb16-61"><a href="#cb16-61" tabindex="-1"></a></span>
<span id="cb16-62"><a href="#cb16-62" tabindex="-1"></a></span>
<span id="cb16-63"><a href="#cb16-63" tabindex="-1"></a></span>
<span id="cb16-64"><a href="#cb16-64" tabindex="-1"></a></span>
<span id="cb16-65"><a href="#cb16-65" tabindex="-1"></a><span class="fu">ggplot</span>(dtssg, <span class="fu">aes</span>((popularity),(daily)))<span class="sc">+</span></span>
<span id="cb16-66"><a href="#cb16-66" tabindex="-1"></a></span>
<span id="cb16-67"><a href="#cb16-67" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> T, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-68"><a href="#cb16-68" tabindex="-1"></a></span>
<span id="cb16-69"><a href="#cb16-69" tabindex="-1"></a>  <span class="co">#geom_smooth(method = &quot;lm&quot;)+</span></span>
<span id="cb16-70"><a href="#cb16-70" tabindex="-1"></a></span>
<span id="cb16-71"><a href="#cb16-71" tabindex="-1"></a>    <span class="co"># stat_function(fun=function(</span></span>
<span id="cb16-72"><a href="#cb16-72" tabindex="-1"></a>    <span class="co"># x, popularity=1, monthly_listeners= 55517581, months_sincepk= 36.50862, popular_artist= 3.232759, current_trend= 0.2327586, genre=0.4482759, words=0.5689655, peak_last_year= 0.3706897)</span></span>
<span id="cb16-73"><a href="#cb16-73" tabindex="-1"></a>    </span>
<span id="cb16-74"><a href="#cb16-74" tabindex="-1"></a>    <span class="co"># (b[1] + c[2]*popularity + c[3]*monthly_listeners + c[4]*months_sincepk + c[5]*popular_artist*current_trend + c[6]*popularity*genre) +</span></span>
<span id="cb16-75"><a href="#cb16-75" tabindex="-1"></a>    <span class="co">#   </span></span>
<span id="cb16-76"><a href="#cb16-76" tabindex="-1"></a>    <span class="co"># (c[7]*words + c[8]*popular_artist + c[9]*current_trend*peak_last_year)*(x), col=&quot;orange&quot;, linewidth =1)+</span></span>
<span id="cb16-77"><a href="#cb16-77" tabindex="-1"></a></span>
<span id="cb16-78"><a href="#cb16-78" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2500000</span>, <span class="at">by=</span><span class="dv">500000</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;500,000&quot;</span>,<span class="st">&quot;1,000,000&quot;</span>,<span class="st">&quot;1,500,000&quot;</span>,<span class="st">&quot;2,000,000&quot;</span>,<span class="st">&quot;2,500,000&quot;</span>))<span class="sc">+</span></span>
<span id="cb16-79"><a href="#cb16-79" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb16-80"><a href="#cb16-80" tabindex="-1"></a>  <span class="co"># scale_x_continuous(breaks = c(1000000000, 2000000000, 3000000000, 4000000000), labels = c(&quot;1 B&quot;, &quot;2 B&quot;, &quot;3 B&quot;, &quot;4 B&quot;))+</span></span>
<span id="cb16-81"><a href="#cb16-81" tabindex="-1"></a></span>
<span id="cb16-82"><a href="#cb16-82" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb16-83"><a href="#cb16-83" tabindex="-1"></a></span>
<span id="cb16-84"><a href="#cb16-84" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-85"><a href="#cb16-85" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Popularity vs Streams&quot;</span>,</span>
<span id="cb16-86"><a href="#cb16-86" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Interesting segregation in popularity&#39;s expert rating&quot;</span>,</span>
<span id="cb16-87"><a href="#cb16-87" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">&quot;Popularity ranking&quot;</span>,</span>
<span id="cb16-88"><a href="#cb16-88" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Daily streams per song&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-89"><a href="#cb16-89" tabindex="-1"></a></span>
<span id="cb16-90"><a href="#cb16-90" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-91"><a href="#cb16-91" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">color =</span> <span class="st">&quot;grey30&quot;</span>),</span>
<span id="cb16-92"><a href="#cb16-92" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey45&quot;</span>),</span>
<span id="cb16-93"><a href="#cb16-93" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey45&quot;</span>),</span>
<span id="cb16-94"><a href="#cb16-94" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb16-95"><a href="#cb16-95" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/popularity%20segregation-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>Above is what the pair of daily ~ popularity looks like when plotted.
I spent a while considering why there was a big leap on popularity from
20 to around 60. I found that many songs were duplicated. The way they
were duplicated is that they had two versions (example, November Rain
(original), November Rain (Remastered)). It was the case that the
secondary versions of those duplicated songs where in the lower
popularity groups. And since the information I have is considering only
the most popular songs and artists for the last 10 years, I shouldn’t be
considering duplicates nor unpopular music.</p>
<p>So I filtered songs that are popular above 60, which is were a normal
trend is on sight. I focused on the popular songs because it’s I found
all of their information without NAs, However in my main model, I
consider all of them without filters.</p>
<p>After filtering the daily~streams plot looked like this. This is
colored by popularity group, where popularity 1 are the most popular
songs and 3 the lowest. This is considering that they are all popular
songs overall compared to the whole industry. And on the previous tab
you can see how it looks like with a couple representations of my model
with the popularity groups segregated.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>asd <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://github.com/Tonadeleon/Regression-Projects/raw/main/Datasets/dataset.csv&quot;</span>)<span class="sc">|&gt;</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  <span class="fu">filter</span>(popularity <span class="sc">&gt;</span> <span class="dv">59</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">title =</span> track_name,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>         <span class="at">artist =</span> artists,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>         <span class="at">title_id =</span> track_id,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>         <span class="at">album =</span> album_name,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>         <span class="at">loud =</span> loudness,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>         <span class="at">words =</span> speechiness,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>         <span class="at">acoustics =</span> acousticness,</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>         <span class="at">instrumental =</span> instrumentalness,</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>         <span class="at">live =</span> liveness) <span class="sc">|&gt;</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>  <span class="fu">inner_join</span>(df1, <span class="at">by=</span><span class="st">&quot;artist&quot;</span>, <span class="at">relationship =</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>  <span class="fu">inner_join</span>(df2, <span class="at">by=</span><span class="st">&quot;artist&quot;</span>, <span class="at">relationship =</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>)</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>asdf <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(asd, df, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;title&quot;</span>, <span class="st">&quot;artist&quot;</span>), <span class="at">relationship =</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>  <span class="st">&quot;many-to-many&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">explicit =</span> <span class="fu">as.factor</span>(explicit),</span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a>         <span class="at">genre =</span> <span class="fu">as.factor</span>(track_genre),</span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a>         <span class="at">daily =</span> daily,</span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a>         <span class="co">#streams = ifelse(streams&gt;3825666400, 942193161, streams),</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a>         <span class="co">#times = as.factor(time_signature),</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a>         <span class="co">#energy = ifelse(energy&gt;.5,1,0),</span></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a>         <span class="co">#duration = ifelse(between(duration_ms, 200000, 250000), 1, 0),</span></span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a>         <span class="co">#loud = ifelse(loud&gt;-9, 1, 0),</span></span>
<span id="cb17-30"><a href="#cb17-30" tabindex="-1"></a>         <span class="at">dance =</span> <span class="fu">ifelse</span>(danceability<span class="sc">&gt;</span>.<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb17-31"><a href="#cb17-31" tabindex="-1"></a>         <span class="at">words =</span> <span class="fu">ifelse</span>(<span class="fu">between</span>(words, .<span class="dv">025</span>, .<span class="dv">06</span>), <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb17-32"><a href="#cb17-32" tabindex="-1"></a>         <span class="at">instrumental =</span> <span class="fu">ifelse</span>(instrumental<span class="sc">&gt;</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb17-33"><a href="#cb17-33" tabindex="-1"></a>         <span class="co">#popularity = ifelse(popularity&gt;76,1,0),</span></span>
<span id="cb17-34"><a href="#cb17-34" tabindex="-1"></a>         <span class="at">live =</span> <span class="fu">ifelse</span>(live<span class="sc">&lt;</span>.<span class="dv">37</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb17-35"><a href="#cb17-35" tabindex="-1"></a>         <span class="at">key =</span> <span class="fu">case_when</span>(key <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">11</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb17-36"><a href="#cb17-36" tabindex="-1"></a>         <span class="at">explicit =</span> <span class="fu">case_when</span>(explicit <span class="sc">==</span> <span class="st">&quot;TRUE&quot;</span> <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb17-37"><a href="#cb17-37" tabindex="-1"></a>         <span class="at">genre =</span> <span class="fu">case_when</span>(genre <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;pop&quot;</span>, <span class="st">&quot;chill&quot;</span>, <span class="st">&quot;indie&quot;</span>, <span class="st">&quot;garage&quot;</span>, <span class="st">&quot;ambient&quot;</span>, <span class="st">&quot;folk&quot;</span>, <span class="st">&quot;indie-pop&quot;</span>, <span class="st">&quot;power-pop&quot;</span>, <span class="st">&quot;reggae&quot;</span>, <span class="st">&quot;soul&quot;</span>, <span class="st">&quot;synth-pop&quot;</span>, <span class="st">&quot;swedish&quot;</span>, <span class="st">&quot;country&quot;</span>, <span class="st">&quot;metal&quot;</span>, <span class="st">&quot;german&quot;</span>, <span class="st">&quot;funk&quot;</span>, <span class="st">&quot;alternative&quot;</span>, <span class="st">&quot;alt-rock&quot;</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb17-38"><a href="#cb17-38" tabindex="-1"></a>         <span class="at">peak_last_year =</span> <span class="fu">ifelse</span>(months_sincepk<span class="sc">&lt;</span><span class="dv">13</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb17-39"><a href="#cb17-39" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">ifelse</span>(popularity <span class="sc">&gt;</span><span class="dv">79</span> ,<span class="dv">1</span> ,<span class="dv">0</span>),</span>
<span id="cb17-40"><a href="#cb17-40" tabindex="-1"></a>         <span class="at">popularity0 =</span> <span class="fu">round</span>(popularity <span class="sc">/</span> <span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>,</span>
<span id="cb17-41"><a href="#cb17-41" tabindex="-1"></a>         <span class="at">popularity0 =</span> <span class="fu">case_when</span>( popularity0 <span class="sc">&gt;</span> <span class="dv">84</span> <span class="sc">~</span> <span class="dv">1</span>, popularity <span class="sc">==</span> <span class="dv">80</span> <span class="sc">~</span> <span class="dv">2</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">3</span> ),</span>
<span id="cb17-42"><a href="#cb17-42" tabindex="-1"></a>         <span class="at">popularity1 =</span> <span class="fu">round</span>(popularity <span class="sc">/</span> <span class="dv">10</span>) <span class="sc">*</span> <span class="dv">10</span>,</span>
<span id="cb17-43"><a href="#cb17-43" tabindex="-1"></a>         <span class="at">popularity1 =</span> <span class="fu">case_when</span>( popularity1 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">1</span>, popularity1 <span class="sc">==</span> <span class="dv">70</span> <span class="sc">~</span> <span class="dv">2</span>, popularity1 <span class="sc">==</span> <span class="dv">80</span> <span class="sc">~</span> <span class="dv">3</span>,  popularity1 <span class="sc">==</span> <span class="dv">90</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">5</span> ),</span>
<span id="cb17-44"><a href="#cb17-44" tabindex="-1"></a>         <span class="at">times =</span> <span class="fu">case_when</span>(time_signature <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">4</span>) <span class="sc">~</span> <span class="dv">1</span>,<span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb17-45"><a href="#cb17-45" tabindex="-1"></a>         <span class="at">energy =</span> <span class="fu">round</span>(energy<span class="sc">*</span><span class="dv">10</span>),</span>
<span id="cb17-46"><a href="#cb17-46" tabindex="-1"></a>         <span class="at">popular_artist =</span> <span class="fu">case_when</span>(artist_streams <span class="sc">&gt;</span> <span class="dv">75000</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="fu">between</span>(artist_streams, <span class="dv">50000</span>,<span class="dv">75000</span>) <span class="sc">~</span> <span class="dv">2</span>, <span class="fu">between</span>(artist_streams, <span class="dv">25000</span>,<span class="dv">50000</span>) <span class="sc">~</span> <span class="dv">3</span>, artist_streams <span class="sc">&lt;</span> <span class="dv">25000</span> <span class="sc">~</span> <span class="dv">4</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span> ),</span>
<span id="cb17-47"><a href="#cb17-47" tabindex="-1"></a>         <span class="at">diff =</span> peak_monthly_listeners <span class="sc">-</span> monthly_listeners,</span>
<span id="cb17-48"><a href="#cb17-48" tabindex="-1"></a>         <span class="at">current_hit =</span> <span class="fu">ifelse</span>(diff<span class="sc">&gt;</span><span class="dv">20000000</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb17-49"><a href="#cb17-49" tabindex="-1"></a>         <span class="at">current_trend =</span> <span class="fu">ifelse</span>(daily_average<span class="sc">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">|&gt;</span></span>
<span id="cb17-50"><a href="#cb17-50" tabindex="-1"></a>         <span class="co">#popularity = ifelse(popularity&gt;76,1,0)) |&gt;</span></span>
<span id="cb17-51"><a href="#cb17-51" tabindex="-1"></a>  <span class="co">#distinct(artist, .keep_all = TRUE) |&gt;</span></span>
<span id="cb17-52"><a href="#cb17-52" tabindex="-1"></a>  <span class="fu">distinct</span>(title, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb17-53"><a href="#cb17-53" tabindex="-1"></a>  <span class="co">#filter(months_sincepk &lt; 120) |&gt;</span></span>
<span id="cb17-54"><a href="#cb17-54" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">159</span>))) <span class="sc">|&gt;</span></span>
<span id="cb17-55"><a href="#cb17-55" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">108</span>,<span class="dv">297</span>,<span class="dv">324</span>))) <span class="sc">|&gt;</span></span>
<span id="cb17-56"><a href="#cb17-56" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">278</span>))) <span class="sc">|&gt;</span></span>
<span id="cb17-57"><a href="#cb17-57" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">245</span>,<span class="dv">215</span>))) <span class="sc">|&gt;</span></span>
<span id="cb17-58"><a href="#cb17-58" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">200</span>))) <span class="sc">|&gt;</span></span>
<span id="cb17-59"><a href="#cb17-59" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">208</span>))) <span class="sc">|&gt;</span></span>
<span id="cb17-60"><a href="#cb17-60" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(daily1, streams, daily, popularity0, popularity1,  explicit, dance, energy, key, loud, mode, words, acoustics, instrumental, live, valence, tempo, times, genre, duration_ms, popular_artist, monthly_listeners, peak_monthly_listeners, months_sincepk, peak_last_year, daily_average, diff,current_hit,current_trend, artist_streams, popularity)</span>
<span id="cb17-61"><a href="#cb17-61" tabindex="-1"></a></span>
<span id="cb17-62"><a href="#cb17-62" tabindex="-1"></a><span class="fu">ggplot</span>(asdf, <span class="fu">aes</span>((streams),(daily), <span class="at">col=</span><span class="fu">as.factor</span>(popularity0)))<span class="sc">+</span></span>
<span id="cb17-63"><a href="#cb17-63" tabindex="-1"></a></span>
<span id="cb17-64"><a href="#cb17-64" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> T) <span class="sc">+</span></span>
<span id="cb17-65"><a href="#cb17-65" tabindex="-1"></a></span>
<span id="cb17-66"><a href="#cb17-66" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">2500000</span>, <span class="at">by=</span><span class="dv">500000</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;0&quot;</span>,<span class="st">&quot;500,000&quot;</span>,<span class="st">&quot;1,000,000&quot;</span>,<span class="st">&quot;1,500,000&quot;</span>,<span class="st">&quot;2,000,000&quot;</span>,<span class="st">&quot;2,500,000&quot;</span>))<span class="sc">+</span></span>
<span id="cb17-67"><a href="#cb17-67" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb17-68"><a href="#cb17-68" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1000000000</span>, <span class="dv">2000000000</span>, <span class="dv">3000000000</span>, <span class="dv">4000000000</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;1 B&quot;</span>, <span class="st">&quot;2 B&quot;</span>, <span class="st">&quot;3 B&quot;</span>, <span class="st">&quot;4 B&quot;</span>))<span class="sc">+</span></span>
<span id="cb17-69"><a href="#cb17-69" tabindex="-1"></a></span>
<span id="cb17-70"><a href="#cb17-70" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb17-71"><a href="#cb17-71" tabindex="-1"></a></span>
<span id="cb17-72"><a href="#cb17-72" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-73"><a href="#cb17-73" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;All time streams vs Daily streams&quot;</span>,</span>
<span id="cb17-74"><a href="#cb17-74" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Popularity as grouping factor&quot;</span>,</span>
<span id="cb17-75"><a href="#cb17-75" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">&quot;All time streams per song&quot;</span>,</span>
<span id="cb17-76"><a href="#cb17-76" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Daily streams&quot;</span>,</span>
<span id="cb17-77"><a href="#cb17-77" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;Popularity groups&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-78"><a href="#cb17-78" tabindex="-1"></a></span>
<span id="cb17-79"><a href="#cb17-79" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-80"><a href="#cb17-80" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>),</span>
<span id="cb17-81"><a href="#cb17-81" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>),</span>
<span id="cb17-82"><a href="#cb17-82" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>),</span>
<span id="cb17-83"><a href="#cb17-83" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb17-84"><a href="#cb17-84" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>))</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><br><br><br><br></p>
</div>
<div id="variables-used" class="section level6">
<h6>Variables Used</h6>
<p><br></p>
<p>This analysis, even when having a lower R<sup>2</sup> was a little
more involved when considering the final variables that were going to
play a role in it. In a summary these were the variables.</p>
<p><br></p>
<p><strong>Response:</strong></p>
<p><br></p>
<ol style="list-style-type: decimal">
<li><span style="color: #0047AB;"><strong>daily</strong> - Max count of
streams per song</span></li>
</ol>
<p><br></p>
<p><strong>Explanatory:</strong></p>
<p><br></p>
<ol start="2" style="list-style-type: decimal">
<li><p><span style="color: #0047AB;"><strong>streams</strong> - Total
artist streams in Spotify for March 2023. (Main quantitative
variable)</span></p></li>
<li><p><span style="color: #0047AB;"><strong>popularity0</strong> - 1-3
categorical variable. Originally a categorical variable 0-100, but then
filtered to avoid duplicates, and then rounded in three groups, thus
finding more significance.</span></p></li>
<li><p><span style="color: #0047AB;"><strong>words</strong> - 1-0
categorical variable. Expert rating where 1 means the song has too many
words, 0 means it has less words on average.</span></p></li>
<li><p><span style="color: #0047AB;"><strong>months_sincepk</strong> -
quantitative variable that counts the number of months since the max
daily streams per song</span></p></li>
<li><p><span style="color: #0047AB;"><strong>peak_last_year</strong> -
0-1 categorical variable derived from months_sincepk, where the peak
happened in at least 12 months before March 2023. One means the artist
is on at least one year of popularity, 0 means the artist’s popularity
is fading (1 year span)</span></p></li>
<li><p><span style="color: #0047AB;"><strong>current_trend</strong>- 0-1
categorical variable. Mutation from average streams, where the numbers
where positive or negative, meaning that the artist is losing or getting
more streams daily as compared to their career daily average. 1 =
postive trend, 0 means negative trend.</span></p></li>
<li><p><span style="color: #0047AB;"><strong>popular_artist</strong> -
0-1 categorical variable. Mutation Where the artist is above the
75<sup>th</sup> percentile of total streams in Spotify.</span></p></li>
<li><p><span style="color: #0047AB;"><strong>popular_artist</strong> -
0-1 categorical variable. Mutation Where the artist is above the
75<sup>th</sup> percentile of total streams in Spotify.</span></p></li>
<li><p><span style="color: #0047AB;"><strong>monthly_listeners</strong>
- Numerical variable with the amount of followers the artist has on
spotify as of March 2023</span></p></li>
<li><p><span style="color: #0047AB;"><strong>genre</strong> - 0-1
categorical variable. 1 means the song’s genre is within this group, and
0 is where it’s a different less current popular genre by distributions.
1 = “pop”, “chill”, “indie”, “garage”, “ambient”, “folk”, “indie-pop”,
“power-pop”, “reggae”, “soul”, “synth-pop”, “swedish”, “country”,
“metal”, “german”, “funk”, “alternative”, “alt-rock”. </span></p></li>
</ol>
<p><br></p>
<p>When considering all this variables in the model, its significance
got better little by little. This model wasn’t making much sense to me,
but I worked on it so I figured that I could share it. And disregarding
that, good insights can be made from this, such as what genres are the
most popular ones today, as well as the importance of the amounts of
words in a song, “less words being prefered by the current consumers”.
Also, songs that peaked one year ago or more start to lose popularity
rather fast, most songs now are short lived instead of being classic
“legend songs”, this can lead to consumers wanting more songs, and too
many being created that they are lesser in quality throughout
generations.</p>
<p><br><br><br><br></p>
</div>
<div id="summary" class="section level6">
<h6>Summary</h6>
<p><br></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">summary</span>(mylms))</span></code></pre></div>
<table>
<caption>Table continues below</caption>
<colgroup>
<col width="52%" />
<col width="15%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-3630</td>
<td align="center">113193</td>
<td align="center">-0.03207</td>
</tr>
<tr class="even">
<td align="center"><strong>popularity0</strong></td>
<td align="center">-131396</td>
<td align="center">20372</td>
<td align="center">-6.45</td>
</tr>
<tr class="odd">
<td align="center"><strong>monthly_listeners</strong></td>
<td align="center">0.006554</td>
<td align="center">0.001253</td>
<td align="center">5.229</td>
</tr>
<tr class="even">
<td align="center"><strong>months_sincepk</strong></td>
<td align="center">2063</td>
<td align="center">775.5</td>
<td align="center">2.66</td>
</tr>
<tr class="odd">
<td align="center"><strong>popular_artist:current_trend</strong></td>
<td align="center">40661</td>
<td align="center">10744</td>
<td align="center">3.785</td>
</tr>
<tr class="even">
<td align="center"><strong>popularity0:genre</strong></td>
<td align="center">77177</td>
<td align="center">18469</td>
<td align="center">4.179</td>
</tr>
<tr class="odd">
<td align="center"><strong>streams:words</strong></td>
<td align="center">0.0001321</td>
<td align="center">2.512e-05</td>
<td align="center">5.259</td>
</tr>
<tr class="even">
<td align="center"><strong>popular_artist:streams</strong></td>
<td align="center">8.781e-05</td>
<td align="center">9.514e-06</td>
<td align="center">9.23</td>
</tr>
<tr class="odd">
<td
align="center"><strong>current_trend:streams:peak_last_year</strong></td>
<td align="center">-2.153e-05</td>
<td align="center">3.479e-05</td>
<td align="center">-0.6187</td>
</tr>
</tbody>
</table>
<table style="width:76%;">
<colgroup>
<col width="59%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">0.9744</td>
</tr>
<tr class="even">
<td align="center"><strong>popularity0</strong></td>
<td align="center">4.01e-10</td>
</tr>
<tr class="odd">
<td align="center"><strong>monthly_listeners</strong></td>
<td align="center">3.035e-07</td>
</tr>
<tr class="even">
<td align="center"><strong>months_sincepk</strong></td>
<td align="center">0.008202</td>
</tr>
<tr class="odd">
<td align="center"><strong>popular_artist:current_trend</strong></td>
<td align="center">0.000183</td>
</tr>
<tr class="even">
<td align="center"><strong>popularity0:genre</strong></td>
<td align="center">3.764e-05</td>
</tr>
<tr class="odd">
<td align="center"><strong>streams:words</strong></td>
<td align="center">2.615e-07</td>
</tr>
<tr class="even">
<td align="center"><strong>popular_artist:streams</strong></td>
<td align="center">3.436e-18</td>
</tr>
<tr class="odd">
<td
align="center"><strong>current_trend:streams:peak_last_year</strong></td>
<td align="center">0.5366</td>
</tr>
</tbody>
</table>
<table style="width:88%;">
<caption>Fitting linear model: ((daily)) ~ popularity0 +
popular_artist:current_trend + popularity0:genre + monthly_listeners +
months_sincepk + streams:words + streams:popular_artist +
streams:current_trend:peak_last_year</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span
class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">337</td>
<td align="center">308153</td>
<td align="center">0.5977</td>
<td align="center">0.5879</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>This model’s summary looks decent for not 100% correlated variables.
R<sup>2</sup> of .62, and all significant values can help explain 62% of
the variance in this relationship between all time streams and daily
streams.</p>
<p><br><br><br><br></p>
</div>
<div id="diagnostics" class="section level6">
<h6>Diagnostics</h6>
<p><br></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">plot</span>(mylms,<span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">plot</span>(mylms<span class="sc">$</span>residuals)</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/alternative%20diagnostic-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>Diagnostics look good, only problem to appear to be presence is a
little of right skewness.</p>
<p><br><br><br><br></p>
</div>
<div id="validation" class="section level6">
<h6>Validation</h6>
<p><br></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a> </span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>num_rows <span class="ot">&lt;-</span> <span class="dv">250</span> <span class="co">#330 total</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dtss), num_rows)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a> </span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>mytrain <span class="ot">&lt;-</span> dtss[keep, ]</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a> </span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>mylms <span class="ot">&lt;-</span> <span class="fu">lm</span>(((daily)) <span class="sc">~</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>            <span class="co">#streams+ #x</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>             popularity0 <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>             popular_artist<span class="sc">:</span>current_trend <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>             popularity0<span class="sc">:</span>genre <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>             monthly_listeners <span class="sc">+</span></span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>             months_sincepk <span class="sc">+</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a></span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>             streams<span class="sc">:</span>words <span class="sc">+</span></span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>             streams<span class="sc">:</span>popular_artist <span class="sc">+</span></span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a>             streams<span class="sc">:</span>current_trend<span class="sc">:</span>peak_last_year</span>
<span id="cb20-27"><a href="#cb20-27" tabindex="-1"></a>, mytrain)</span>
<span id="cb20-28"><a href="#cb20-28" tabindex="-1"></a> </span>
<span id="cb20-29"><a href="#cb20-29" tabindex="-1"></a>mytest <span class="ot">&lt;-</span> dtss[<span class="sc">-</span>keep, ] <span class="co">#Use this in the predict(..., newdata=mytest)</span></span>
<span id="cb20-30"><a href="#cb20-30" tabindex="-1"></a> </span>
<span id="cb20-31"><a href="#cb20-31" tabindex="-1"></a>  yhcc <span class="ot">&lt;-</span> <span class="fu">predict</span>(mylms, <span class="at">newdata=</span>mytest)</span>
<span id="cb20-32"><a href="#cb20-32" tabindex="-1"></a>  ybarcc <span class="ot">&lt;-</span> <span class="fu">mean</span>(mytest<span class="sc">$</span>daily) </span>
<span id="cb20-33"><a href="#cb20-33" tabindex="-1"></a>  SSTOcc <span class="ot">&lt;-</span> <span class="fu">sum</span>( (mytest<span class="sc">$</span>daily <span class="sc">-</span> ybarcc)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb20-34"><a href="#cb20-34" tabindex="-1"></a>  SSEcc <span class="ot">&lt;-</span> <span class="fu">sum</span>( (mytest<span class="sc">$</span>daily <span class="sc">-</span> yhcc)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb20-35"><a href="#cb20-35" tabindex="-1"></a>  rscc <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSEcc<span class="sc">/</span>SSTOcc</span>
<span id="cb20-36"><a href="#cb20-36" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(mytest<span class="sc">$</span>daily) <span class="co">#sample size</span></span>
<span id="cb20-37"><a href="#cb20-37" tabindex="-1"></a>  pcc  <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(mylms)) <span class="co">#num. parameters in model</span></span>
<span id="cb20-38"><a href="#cb20-38" tabindex="-1"></a>  rscca <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="sc">-</span>pcc)<span class="sc">*</span>SSEcc<span class="sc">/</span>SSTOcc</span>
<span id="cb20-39"><a href="#cb20-39" tabindex="-1"></a>my_output_table2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-40"><a href="#cb20-40" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(</span>
<span id="cb20-41"><a href="#cb20-41" tabindex="-1"></a>    <span class="st">&quot;Monthly Followers Model&quot;</span>),</span>
<span id="cb20-42"><a href="#cb20-42" tabindex="-1"></a>  <span class="st">`</span><span class="at">Original R2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb20-43"><a href="#cb20-43" tabindex="-1"></a>    <span class="fu">summary</span>(mylms)<span class="sc">$</span>r.squared),</span>
<span id="cb20-44"><a href="#cb20-44" tabindex="-1"></a>    <span class="co">#summary(bsalm)$r.squared), </span></span>
<span id="cb20-45"><a href="#cb20-45" tabindex="-1"></a>  <span class="st">`</span><span class="at">Orig. Adj. R-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb20-46"><a href="#cb20-46" tabindex="-1"></a>    <span class="fu">summary</span>(mylms)<span class="sc">$</span>adj.r.squared),</span>
<span id="cb20-47"><a href="#cb20-47" tabindex="-1"></a>    <span class="co">#summary(bsalm)$adj.r.squared,</span></span>
<span id="cb20-48"><a href="#cb20-48" tabindex="-1"></a> </span>
<span id="cb20-49"><a href="#cb20-49" tabindex="-1"></a>  </span>
<span id="cb20-50"><a href="#cb20-50" tabindex="-1"></a>  <span class="st">`</span><span class="at">Validation R-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb20-51"><a href="#cb20-51" tabindex="-1"></a>    rscc),</span>
<span id="cb20-52"><a href="#cb20-52" tabindex="-1"></a>  <span class="st">`</span><span class="at">Validation Adj. R^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb20-53"><a href="#cb20-53" tabindex="-1"></a>    rscca))</span>
<span id="cb20-54"><a href="#cb20-54" tabindex="-1"></a> </span>
<span id="cb20-55"><a href="#cb20-55" tabindex="-1"></a> </span>
<span id="cb20-56"><a href="#cb20-56" tabindex="-1"></a><span class="fu">colnames</span>(my_output_table2) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb20-57"><a href="#cb20-57" tabindex="-1"></a>  <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;Original $R^2$&quot;</span>, </span>
<span id="cb20-58"><a href="#cb20-58" tabindex="-1"></a>  <span class="st">&quot;Original Adj. $R^2$&quot;</span>, </span>
<span id="cb20-59"><a href="#cb20-59" tabindex="-1"></a>  <span class="st">&quot;Validation $R^2$&quot;</span>, </span>
<span id="cb20-60"><a href="#cb20-60" tabindex="-1"></a>  <span class="st">&quot;Validation Adj. $R^2$&quot;</span>)</span>
<span id="cb20-61"><a href="#cb20-61" tabindex="-1"></a> </span>
<span id="cb20-62"><a href="#cb20-62" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(my_output_table2, <span class="at">escape=</span><span class="cn">TRUE</span>, <span class="at">digits=</span><span class="dv">5</span>)</span></code></pre></div>
<table>
<colgroup>
<col width="24%" />
<col width="15%" />
<col width="20%" />
<col width="17%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="right">Original <span class="math inline">\(R^2\)</span></th>
<th align="right">Original Adj. <span
class="math inline">\(R^2\)</span></th>
<th align="right">Validation <span
class="math inline">\(R^2\)</span></th>
<th align="right">Validation Adj. <span
class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Monthly Followers Model</td>
<td align="right">0.60073</td>
<td align="right">0.58748</td>
<td align="right">0.56563</td>
<td align="right">0.52108</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Validations look decent in this model. Only problem I see is that the
validation results have a lot of variance. Whereas in my actual model
they’re always close to .93 R<sup>2</sup></p>
<p><br><br><br><br></p>
</div>
</div>
</div>
</div>
<div id="section-9" class="section level3">
<h3></h3>
<div id="section-10" class="section level4">
<h4></h4>
</div>
</div>
</div>
<div id="model-summary" class="section level2">
<h2>Model Summary</h2>
<p><br></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">summary</span>(mylm))</span></code></pre></div>
<table style="width:99%;">
<colgroup>
<col width="33%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-14.81</td>
<td align="center">0.5785</td>
<td align="center">-25.6</td>
<td align="center">1.192e-107</td>
</tr>
<tr class="even">
<td align="center"><strong>explicit</strong></td>
<td align="center">0.0901</td>
<td align="center">0.03013</td>
<td align="center">2.99</td>
<td align="center">0.002872</td>
</tr>
<tr class="odd">
<td align="center"><strong>monthly_listeners</strong></td>
<td align="center">0.953</td>
<td align="center">0.03392</td>
<td align="center">28.09</td>
<td align="center">1.96e-123</td>
</tr>
<tr class="even">
<td align="center"><strong>artist_streams</strong></td>
<td align="center">0.4339</td>
<td align="center">0.02387</td>
<td align="center">18.18</td>
<td align="center">1.121e-62</td>
</tr>
<tr class="odd">
<td align="center"><strong>streams</strong></td>
<td align="center">-0.1877</td>
<td align="center">0.02649</td>
<td align="center">-7.085</td>
<td align="center">2.912e-12</td>
</tr>
</tbody>
</table>
<table style="width:88%;">
<caption>Fitting linear model: (daily1) ~ explicit + (monthly_listeners)
+ (artist_streams) + (streams)</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span
class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">857</td>
<td align="center">0.3245</td>
<td align="center">0.9278</td>
<td align="center">0.9275</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>After carefully considering the slope and intercept coefficients, and
many tries of adding correlated variables to get a better fit, I ended
up using the model above to try to predict daily streams per artist.</p>
<p>Multiple variables were used, and all of them are significant to the
model. All the variables supported a log transformation, and these
transformations brought the model pretty high up in significance.</p>
<p>This model abilitates the user to test the assumption of streams
increase per follower gained, as well as test different scenarios and
aim for goal setting, and insight gathering. (See interpretation)</p>
<p><br><br><br><br></p>
</div>
<div id="diagnostics-1" class="section level2">
<h2>Diagnostics</h2>
<p><br></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">plot</span>(mylm,<span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="fu">plot</span>(mylm<span class="sc">$</span>residuals)</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/original%20diagnostic-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>All diagnostics look good. Normality may appear to be right skewed on
the residuals; another curious thing is that the residual vs fitted plot
shows some linear patterns, it is uncertain if this is is a concern for
the model, the reason behind it maybe that some artists have a couple
different songs in this set; and being that there’s a large sample size
of almost a thousand unique songs an artists, we will proceed with the
analysis.</p>
<p><br><br><br><br></p>
</div>
<div id="interpretation" class="section level2">
<h2>Interpretation</h2>
<div id="section-11"
class="section level3 tabset tabset-fade tabset-panel">
<h3 class="tabset tabset-fade tabset-panel"></h3>
<p><br></p>
<p>Even when this is a High Dimensional model, it can still be
interpreted in a scenario by scenario basis. Slopes may vary according
to each scenario. They help predict with a high accuracy the amount of
streams an artist can have for a given scenario.</p>
<p>This tool can be useful to set goals (if you were the artist, how
many followers would you need to meet certain goal on streams); Or for
curious people that want to estimate streams in the industry, as well as
competitors wanting to estimate others’ streams and wit this, estimate
their monthly earnings too.</p>
<p>Here are a couple examples on how to interpret this model, and how to
think about it.</p>
<p><br></p>
<div id="predictions" class="section level4">
<h4>Predictions</h4>
<p><br></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>average_monthly_followers <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>monthly_listeners)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>mean_artist_streams <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>artist_streams)</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>mean_streams <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>streams)</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>mean_daily <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>daily)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">monthly_listeners =</span> average_monthly_followers,</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>                       <span class="at">artist_streams =</span> mean_artist_streams,</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>                       <span class="at">streams =</span> mean_streams,</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>                       <span class="at">daily =</span> mean_daily,</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>                       <span class="at">explicit =</span> <span class="dv">0</span>,</span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a>                       <span class="at">popular_artist =</span> <span class="dv">4</span>)</span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(mylm, <span class="at">newdata =</span> new_data, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> (prediction[, <span class="dv">3</span>])</span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a>LCL <span class="ot">&lt;-</span> (prediction[, <span class="dv">2</span>])</span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a>Prediction <span class="ot">&lt;-</span> (prediction[, <span class="dv">1</span>])</span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">50000000</span>)</span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a>mean_artist_streams <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>artist_streams)</span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a>mean_streams <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>streams)</span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a>mean_daily <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>daily)</span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a>new_data1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">monthly_listeners =</span> x,</span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a>                       <span class="at">artist_streams =</span> mean_artist_streams,</span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a>                       <span class="at">streams =</span> mean_streams,</span>
<span id="cb23-29"><a href="#cb23-29" tabindex="-1"></a>                       <span class="at">daily =</span> mean_daily,</span>
<span id="cb23-30"><a href="#cb23-30" tabindex="-1"></a>                       <span class="at">explicit =</span> <span class="dv">0</span>,</span>
<span id="cb23-31"><a href="#cb23-31" tabindex="-1"></a>                       <span class="at">popular_artist =</span> <span class="dv">4</span>)</span>
<span id="cb23-32"><a href="#cb23-32" tabindex="-1"></a>Prediction2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(mylm, <span class="at">newdata =</span> new_data1, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)</span>
<span id="cb23-33"><a href="#cb23-33" tabindex="-1"></a></span>
<span id="cb23-34"><a href="#cb23-34" tabindex="-1"></a>UCL2 <span class="ot">&lt;-</span> (Prediction2[, <span class="dv">3</span>])</span>
<span id="cb23-35"><a href="#cb23-35" tabindex="-1"></a>LCL2 <span class="ot">&lt;-</span> (Prediction2[, <span class="dv">2</span>])</span>
<span id="cb23-36"><a href="#cb23-36" tabindex="-1"></a>Prediction2 <span class="ot">&lt;-</span> (Prediction2[, <span class="dv">1</span>])</span>
<span id="cb23-37"><a href="#cb23-37" tabindex="-1"></a></span>
<span id="cb23-38"><a href="#cb23-38" tabindex="-1"></a></span>
<span id="cb23-39"><a href="#cb23-39" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">y =</span> daily1, <span class="at">x =</span> monthly_listeners)) <span class="sc">+</span></span>
<span id="cb23-40"><a href="#cb23-40" tabindex="-1"></a>  </span>
<span id="cb23-41"><a href="#cb23-41" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-42"><a href="#cb23-42" tabindex="-1"></a>  </span>
<span id="cb23-43"><a href="#cb23-43" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> x, <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-44"><a href="#cb23-44" tabindex="-1"></a>  </span>
<span id="cb23-45"><a href="#cb23-45" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> average_monthly_followers, <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-46"><a href="#cb23-46" tabindex="-1"></a>  </span>
<span id="cb23-47"><a href="#cb23-47" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x)</span>
<span id="cb23-48"><a href="#cb23-48" tabindex="-1"></a></span>
<span id="cb23-49"><a href="#cb23-49" tabindex="-1"></a>      (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">0</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span><span class="fl">9.030</span> <span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">*</span><span class="fl">20.55</span> <span class="sc">+</span> b[<span class="dv">6</span>]<span class="sc">*</span><span class="fl">12.94</span>) <span class="sc">+</span></span>
<span id="cb23-50"><a href="#cb23-50" tabindex="-1"></a></span>
<span id="cb23-51"><a href="#cb23-51" tabindex="-1"></a>      (b[<span class="dv">3</span>])<span class="sc">*</span>x, <span class="at">linewidth =</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb23-52"><a href="#cb23-52" tabindex="-1"></a>  </span>
<span id="cb23-53"><a href="#cb23-53" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> LCL2, <span class="at">xend =</span> x, <span class="at">yend =</span> UCL2), <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-54"><a href="#cb23-54" tabindex="-1"></a>  </span>
<span id="cb23-55"><a href="#cb23-55" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> Prediction2), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-56"><a href="#cb23-56" tabindex="-1"></a>  </span>
<span id="cb23-57"><a href="#cb23-57" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> average_monthly_followers, <span class="at">y =</span> LCL, <span class="at">xend =</span> average_monthly_followers, <span class="at">yend =</span> UCL), <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">color =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-58"><a href="#cb23-58" tabindex="-1"></a>  </span>
<span id="cb23-59"><a href="#cb23-59" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> average_monthly_followers, <span class="at">y =</span> Prediction), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-60"><a href="#cb23-60" tabindex="-1"></a>  </span>
<span id="cb23-61"><a href="#cb23-61" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> Prediction2, <span class="at">label =</span> <span class="st">&quot;Prediction 2&quot;</span>), </span>
<span id="cb23-62"><a href="#cb23-62" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-63"><a href="#cb23-63" tabindex="-1"></a>  </span>
<span id="cb23-64"><a href="#cb23-64" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x =</span> average_monthly_followers, <span class="at">y =</span> Prediction, <span class="at">label =</span> <span class="st">&quot;Prediction 1&quot;</span>), </span>
<span id="cb23-65"><a href="#cb23-65" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb23-66"><a href="#cb23-66" tabindex="-1"></a>  </span>
<span id="cb23-67"><a href="#cb23-67" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">log</span>(<span class="fu">c</span>(<span class="dv">4500000</span>, <span class="dv">10000000</span>, <span class="dv">25000000</span>, <span class="dv">50000000</span>, <span class="dv">100000000</span>)), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;4.5 M&quot;</span>, <span class="st">&quot;10 M&quot;</span>, <span class="st">&quot;25 M&quot;</span>, <span class="st">&quot;50 M&quot;</span>, <span class="st">&quot;100 M&quot;</span>)) <span class="sc">+</span></span>
<span id="cb23-68"><a href="#cb23-68" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">log</span>(.<span class="dv">5</span>), <span class="fu">log</span>(<span class="fl">1.5</span>), <span class="fu">log</span>(<span class="dv">6</span>), <span class="fu">log</span>(<span class="dv">20</span>), <span class="fu">log</span>(<span class="dv">70</span>)), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;.5 M&quot;</span>,<span class="st">&quot;1.5 M&quot;</span>,<span class="st">&quot;6 M&quot;</span>,<span class="st">&quot;20 M&quot;</span> ,<span class="st">&quot;70 M&quot;</span>))<span class="sc">+</span></span>
<span id="cb23-69"><a href="#cb23-69" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb23-70"><a href="#cb23-70" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Artist Monthly Followers vs. Artist Daily Streams&quot;</span>,</span>
<span id="cb23-71"><a href="#cb23-71" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Pred1: All variable mean values in play </span><span class="sc">\n</span><span class="st">Pred 2: All variable mean values in play, but 50 M followers instead of the average 24 M&quot;</span>,</span>
<span id="cb23-72"><a href="#cb23-72" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Artist Monthly Followers&quot;</span>,</span>
<span id="cb23-73"><a href="#cb23-73" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Artist Daily Streams&quot;</span>,</span>
<span id="cb23-74"><a href="#cb23-74" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">&quot;Log Scale&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-75"><a href="#cb23-75" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb23-76"><a href="#cb23-76" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>),</span>
<span id="cb23-77"><a href="#cb23-77" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb23-78"><a href="#cb23-78" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb23-79"><a href="#cb23-79" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb23-80"><a href="#cb23-80" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/pred%201%20graph-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><br></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>prediction_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>  <span class="st">&quot;Name&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Prediction 1&quot;</span>, <span class="st">&quot;Prediction 2&quot;</span>),</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>  <span class="at">Predicted =</span> <span class="fu">round</span>((<span class="fu">exp</span>(<span class="fu">c</span>(Prediction, Prediction2))),<span class="dv">1</span>), </span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>  <span class="at">LCL1 =</span> <span class="fu">round</span>((<span class="fu">exp</span>(<span class="fu">c</span>(LCL, LCL2))),<span class="dv">1</span>), </span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>  <span class="at">UCL1 =</span> <span class="fu">round</span>((<span class="fu">exp</span>(<span class="fu">c</span>(UCL, UCL2))),<span class="dv">1</span>)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="co"># Print the table with kable and kable_styling</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a>prediction_df <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>, <span class="at">align =</span> <span class="st">&quot;c&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table class="table" style="color: black; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:center;">
Name
</th>
<th style="text-align:center;">
Predicted
</th>
<th style="text-align:center;">
LCL1
</th>
<th style="text-align:center;">
UCL1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
Prediction 1
</td>
<td style="text-align:center;">
4.7
</td>
<td style="text-align:center;">
2.5
</td>
<td style="text-align:center;">
8.8
</td>
</tr>
<tr>
<td style="text-align:center;">
Prediction 2
</td>
<td style="text-align:center;">
8.8
</td>
<td style="text-align:center;">
4.7
</td>
<td style="text-align:center;">
16.7
</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Recall to the first plot in this analysis, where the mean scenario
(middle line in Introduction tab), as well as the 1st and 3rd quartiles
scenarios where shown as examples. When the all average scenario is put
in play all, predictions made based on that assumption will follow the
same slope. Remember many scenarios can be predicted depending on
variables like, the artist has curse words in their music or not, what
is the max amount of streams the artist has had so far in a single
month, what is the artist most popular song and its max streams count,
and of course we need to predict for a certain a amount of followers to
get an accurate daily streams prediction.</p>
<p>In the plot above, the bigger dots represent two stream predictions,
and the colored lines represent their respective 95% prediction
intervals.</p>
<p>For the light blue prediction, all the average values for each
variable were used to predict the daily streams of an artist; such
artist has Spotify’s industry mean amount of followers as well as the
mean in all the other mentioned variables. Keep in mind that this is not
all Spotify’s mean, rather recall that we are analyzing top 1000 songs
and their artists.</p>
<p>The results are in the table above where the numbers are rounded to 1
decimal for simplicity, and they mean million streams.</p>
<p>If I predict for rather 50 Million followers (dark blue Prediction)
instead of the average. The prediction follows the same trend. Be
assured that when choosing your specifics for each variable, the
predictions will follow the same line even when the x values are
changed.</p>
<p>We can say that the slope of this line is of
<strong>2.5934979</strong>, this means that for every follower gained in
a month, we can expect around 2 additional streams. And, to be 95%
certain that this prediction is accurate, the prediction interval is
added. This means that we are 95% sure that for every new follower, the
artist will have between 5 and 8 extra streams.</p>
<p><br><br><br><br></p>
</div>
<div id="confidence-interval" class="section level4">
<h4>Confidence Interval</h4>
<p><br></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>get_prediction_intervals <span class="ot">&lt;-</span> <span class="cf">function</span>(model, data) {</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  prediction_intervals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">monthly_listeners =</span> <span class="fu">numeric</span>(),</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>                                     <span class="at">lower_bound =</span> <span class="fu">numeric</span>(),</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>                                     <span class="at">upper_bound =</span> <span class="fu">numeric</span>(),</span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>                                     <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>  <span class="cf">for</span> (x_val <span class="cf">in</span> data<span class="sc">$</span>monthly_listeners) {</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>    new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">monthly_listeners =</span> (x_val),</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>                           <span class="at">artist_streams =</span> (<span class="fu">mean</span>(data<span class="sc">$</span>artist_streams)),</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>                           <span class="at">streams =</span> (<span class="fu">mean</span>(data<span class="sc">$</span>streams)),</span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>                           <span class="at">daily =</span> (<span class="fu">mean</span>(data<span class="sc">$</span>daily)),</span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a>                           <span class="at">explicit =</span> <span class="dv">0</span>,</span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a>                           <span class="at">popular_artist =</span> <span class="dv">4</span>)</span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a>    </span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a>    predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> new_data, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a>    </span>
<span id="cb25-20"><a href="#cb25-20" tabindex="-1"></a>    prediction_intervals <span class="ot">&lt;-</span> <span class="fu">rbind</span>(prediction_intervals, </span>
<span id="cb25-21"><a href="#cb25-21" tabindex="-1"></a>                                  <span class="fu">data.frame</span>(<span class="at">monthly_listeners =</span> (x_val),</span>
<span id="cb25-22"><a href="#cb25-22" tabindex="-1"></a>                                             <span class="at">lower_bound =</span> predictions[, <span class="st">&quot;lwr&quot;</span>],</span>
<span id="cb25-23"><a href="#cb25-23" tabindex="-1"></a>                                             <span class="at">upper_bound =</span> predictions[, <span class="st">&quot;upr&quot;</span>],</span>
<span id="cb25-24"><a href="#cb25-24" tabindex="-1"></a>                                             <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>))</span>
<span id="cb25-25"><a href="#cb25-25" tabindex="-1"></a>  }</span>
<span id="cb25-26"><a href="#cb25-26" tabindex="-1"></a>  </span>
<span id="cb25-27"><a href="#cb25-27" tabindex="-1"></a>  <span class="fu">return</span>(prediction_intervals)</span>
<span id="cb25-28"><a href="#cb25-28" tabindex="-1"></a>}</span>
<span id="cb25-29"><a href="#cb25-29" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" tabindex="-1"></a></span>
<span id="cb25-31"><a href="#cb25-31" tabindex="-1"></a></span>
<span id="cb25-32"><a href="#cb25-32" tabindex="-1"></a>prediction_intervals <span class="ot">&lt;-</span> <span class="fu">get_prediction_intervals</span>(mylm, dt) <span class="sc">|&gt;</span> </span>
<span id="cb25-33"><a href="#cb25-33" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">monthly_listeners =</span> (monthly_listeners),</span>
<span id="cb25-34"><a href="#cb25-34" tabindex="-1"></a>         <span class="at">up =</span> (upper_bound),</span>
<span id="cb25-35"><a href="#cb25-35" tabindex="-1"></a>         <span class="at">low =</span> (lower_bound))</span>
<span id="cb25-36"><a href="#cb25-36" tabindex="-1"></a></span>
<span id="cb25-37"><a href="#cb25-37" tabindex="-1"></a>dt123 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(dt,prediction_intervals,<span class="at">by=</span><span class="st">&quot;monthly_listeners&quot;</span>)</span>
<span id="cb25-38"><a href="#cb25-38" tabindex="-1"></a></span>
<span id="cb25-39"><a href="#cb25-39" tabindex="-1"></a><span class="fu">ggplot</span>(dt123, <span class="fu">aes</span>(<span class="at">x =</span> monthly_listeners, <span class="at">y =</span> daily1)) <span class="sc">+</span></span>
<span id="cb25-40"><a href="#cb25-40" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;orange&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-41"><a href="#cb25-41" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun=</span><span class="cf">function</span>(x)</span>
<span id="cb25-42"><a href="#cb25-42" tabindex="-1"></a></span>
<span id="cb25-43"><a href="#cb25-43" tabindex="-1"></a>      (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">0</span> <span class="sc">+</span> b[<span class="dv">4</span>]<span class="sc">*</span><span class="fl">9.030</span> <span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">*</span><span class="fl">20.55</span> <span class="sc">+</span> b[<span class="dv">6</span>]<span class="sc">*</span><span class="fl">12.94</span>) <span class="sc">+</span></span>
<span id="cb25-44"><a href="#cb25-44" tabindex="-1"></a></span>
<span id="cb25-45"><a href="#cb25-45" tabindex="-1"></a>      (b[<span class="dv">3</span>])<span class="sc">*</span>x, <span class="at">linewidth =</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">&quot;steelblue4&quot;</span>)<span class="sc">+</span></span>
<span id="cb25-46"><a href="#cb25-46" tabindex="-1"></a>  </span>
<span id="cb25-47"><a href="#cb25-47" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> low, <span class="at">ymax =</span> up), <span class="at">fill =</span> <span class="st">&quot;skyblue1&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb25-48"><a href="#cb25-48" tabindex="-1"></a>  </span>
<span id="cb25-49"><a href="#cb25-49" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="dv">4500000</span>), <span class="fu">log</span>(<span class="dv">10000000</span>), <span class="fu">log</span>(<span class="dv">25000000</span>), <span class="fu">log</span>(<span class="dv">50000000</span>), <span class="fu">log</span>(<span class="dv">100000000</span>)),</span>
<span id="cb25-50"><a href="#cb25-50" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;4.5 M&quot;</span>, <span class="st">&quot;10 M&quot;</span>, <span class="st">&quot;25 M&quot;</span>, <span class="st">&quot;50 M&quot;</span>, <span class="st">&quot;100 M&quot;</span>)) <span class="sc">+</span></span>
<span id="cb25-51"><a href="#cb25-51" tabindex="-1"></a>  </span>
<span id="cb25-52"><a href="#cb25-52" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="fl">0.5</span>), <span class="fu">log</span>(<span class="fl">1.5</span>), <span class="fu">log</span>(<span class="dv">6</span>), <span class="fu">log</span>(<span class="dv">20</span>), <span class="fu">log</span>(<span class="dv">70</span>)),</span>
<span id="cb25-53"><a href="#cb25-53" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0.5 M&quot;</span>, <span class="st">&quot;1.5 M&quot;</span>, <span class="st">&quot;6 M&quot;</span>, <span class="st">&quot;20 M&quot;</span>, <span class="st">&quot;70 M&quot;</span>)) <span class="sc">+</span></span>
<span id="cb25-54"><a href="#cb25-54" tabindex="-1"></a>  </span>
<span id="cb25-55"><a href="#cb25-55" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb25-56"><a href="#cb25-56" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb25-57"><a href="#cb25-57" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Artist Monthly Followers vs. Artist Daily Streams&quot;</span>,</span>
<span id="cb25-58"><a href="#cb25-58" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;The light blue ribbon represents the confidence interval for this specific scenario </span><span class="sc">\n</span><span class="st"> Scenario when all the mean values for all variables are present&quot;</span>,</span>
<span id="cb25-59"><a href="#cb25-59" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Artist Monthly Followers&quot;</span>,</span>
<span id="cb25-60"><a href="#cb25-60" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Artist Daily Streams&quot;</span>,</span>
<span id="cb25-61"><a href="#cb25-61" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Log scale&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-62"><a href="#cb25-62" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb25-63"><a href="#cb25-63" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>),</span>
<span id="cb25-64"><a href="#cb25-64" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb25-65"><a href="#cb25-65" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb25-66"><a href="#cb25-66" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb25-67"><a href="#cb25-67" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>Consider this graph to be a 2D representation of a higher dimensional
model’s confidence interval. You can see a ribbon representing a
confidence interval for this situation. This confidence interval takes
place when the mean of all other variables is used to get predictions;
In reality, there is not a “one single confidence interval fits all
lines” situation, but a confidence interval for each line; The lines
then would go in the middle of each of those confidence intervals.
However since the amount of lines is near to infinite, it suffices to
show one for the purpose of this analysis, still we should remember this
is not the only confidence interval in existence.</p>
<p>This is an understandable representation because if this graphing
tool were to graph every ribbon of every line (If it had the capacity to
do so all at once), the plot would then be filled with infinite ribbons
for all the lines that this model could portray; and almost all the area
where the dots are (and even possibly the whole plot) would be filled
with confidence interval ribbons.</p>
<p>This would also be a good thing, it means that most data points can
be explained by this model.</p>
<p><br><br><br><br></p>
</div>
<div id="total-artist-streams" class="section level4">
<h4>Total Artist Streams</h4>
<p><br></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(<span class="at">y=</span>(daily1), <span class="at">x=</span>(artist_streams)))<span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> F, <span class="at">col=</span><span class="st">&quot;firebrick&quot;</span>)<span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  </span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="dv">1000</span>), <span class="fu">log</span>(<span class="dv">3000</span>), <span class="fu">log</span>(<span class="dv">8000</span>), <span class="fu">log</span>(<span class="dv">22000</span>), <span class="fu">log</span>(<span class="dv">60000</span>)), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;1 B&quot;</span>, <span class="st">&quot;3 B&quot;</span>, <span class="st">&quot;8 B&quot;</span>,<span class="st">&quot;22 B&quot;</span>,<span class="st">&quot;60 B&quot;</span>)) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>   </span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="fu">log</span>(.<span class="dv">5</span>), <span class="fu">log</span>(<span class="fl">1.5</span>), <span class="fu">log</span>(<span class="dv">6</span>), <span class="fu">log</span>(<span class="dv">20</span>), <span class="fu">log</span>(<span class="dv">70</span>)), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;.5 M&quot;</span>,<span class="st">&quot;1.5 M&quot;</span>,<span class="st">&quot;6 M&quot;</span>,<span class="st">&quot;20 M&quot;</span> ,<span class="st">&quot;70 M&quot;</span>))<span class="sc">+</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a> </span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>  <span class="fu">labs</span>( </span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Artist Monthly Followers vs. Artist Daily Streams&quot;</span>, </span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Updated as of March 2023 | Spotify Measurements&quot;</span>,</span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a>    <span class="at">x=</span> <span class="st">&quot;Total artist streams (Spotify)&quot;</span>,</span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Artist Daily Streams&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>),</span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey35&quot;</span>, <span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;grey15&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="SpotifyRegression_files/figure-html/unnamed-chunk-7-1.png" width="960" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>As seen here, total artist streams (All time) is also a good
predictor of daily streams; however, since these are the all time
streams of an artist it’s not as good as using the artist followers to
predict streams. Interestingly enough, this variable also supported a
double log transformation, and is included in the model as an
explanatory variable.</p>
<p><br><br><br><br></p>
</div>
</div>
<div id="section-12" class="section level3">
<h3></h3>
</div>
</div>
<div id="validation-1" class="section level2">
<h2>Validation</h2>
<p><br></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">17</span>)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a> </span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>num_rows <span class="ot">&lt;-</span> <span class="dv">440</span> <span class="co">#882 total</span></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>keep <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dt), num_rows)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a> </span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>mytrain <span class="ot">&lt;-</span> dt[keep, ]</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a> </span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>((daily1) <span class="sc">~</span> </span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>             </span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>             explicit <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>             </span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>             <span class="do">###</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>             </span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>             (monthly_listeners) <span class="sc">+</span> </span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>             </span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>             (artist_streams) <span class="sc">+</span> </span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>             </span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>             (streams)</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>, mytrain)</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a> </span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a>mytest <span class="ot">&lt;-</span> dt[<span class="sc">-</span>keep, ] <span class="co">#Use this in the predict(..., newdata=mytest)</span></span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a> </span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>  yhcc <span class="ot">&lt;-</span> <span class="fu">predict</span>(mylm, <span class="at">newdata=</span>mytest)</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a>  ybarcc <span class="ot">&lt;-</span> <span class="fu">mean</span>(mytest<span class="sc">$</span>daily1) </span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a>  SSTOcc <span class="ot">&lt;-</span> <span class="fu">sum</span>( (mytest<span class="sc">$</span>daily1 <span class="sc">-</span> ybarcc)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a>  SSEcc <span class="ot">&lt;-</span> <span class="fu">sum</span>( (mytest<span class="sc">$</span>daily1 <span class="sc">-</span> yhcc)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a>  rscc <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSEcc<span class="sc">/</span>SSTOcc</span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(mytest<span class="sc">$</span>daily1) <span class="co">#sample size</span></span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a>  pcc  <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(mylm)) <span class="co">#num. parameters in model</span></span>
<span id="cb27-30"><a href="#cb27-30" tabindex="-1"></a>  rscca <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="sc">-</span>pcc)<span class="sc">*</span>SSEcc<span class="sc">/</span>SSTOcc</span>
<span id="cb27-31"><a href="#cb27-31" tabindex="-1"></a>my_output_table2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-32"><a href="#cb27-32" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(</span>
<span id="cb27-33"><a href="#cb27-33" tabindex="-1"></a>    <span class="st">&quot;Alternative Model&quot;</span>),</span>
<span id="cb27-34"><a href="#cb27-34" tabindex="-1"></a>  <span class="st">`</span><span class="at">Original R2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb27-35"><a href="#cb27-35" tabindex="-1"></a>    <span class="fu">summary</span>(mylm)<span class="sc">$</span>r.squared),</span>
<span id="cb27-36"><a href="#cb27-36" tabindex="-1"></a>    <span class="co">#summary(bsalm)$r.squared), </span></span>
<span id="cb27-37"><a href="#cb27-37" tabindex="-1"></a>  <span class="st">`</span><span class="at">Orig. Adj. R-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb27-38"><a href="#cb27-38" tabindex="-1"></a>    <span class="fu">summary</span>(mylm)<span class="sc">$</span>adj.r.squared),</span>
<span id="cb27-39"><a href="#cb27-39" tabindex="-1"></a>    <span class="co">#summary(bsalm)$adj.r.squared,</span></span>
<span id="cb27-40"><a href="#cb27-40" tabindex="-1"></a> </span>
<span id="cb27-41"><a href="#cb27-41" tabindex="-1"></a>  </span>
<span id="cb27-42"><a href="#cb27-42" tabindex="-1"></a>  <span class="st">`</span><span class="at">Validation R-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb27-43"><a href="#cb27-43" tabindex="-1"></a>    rscc),</span>
<span id="cb27-44"><a href="#cb27-44" tabindex="-1"></a>  <span class="st">`</span><span class="at">Validation Adj. R^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb27-45"><a href="#cb27-45" tabindex="-1"></a>    rscca))</span>
<span id="cb27-46"><a href="#cb27-46" tabindex="-1"></a> </span>
<span id="cb27-47"><a href="#cb27-47" tabindex="-1"></a> </span>
<span id="cb27-48"><a href="#cb27-48" tabindex="-1"></a><span class="fu">colnames</span>(my_output_table2) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb27-49"><a href="#cb27-49" tabindex="-1"></a>  <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;Original $R^2$&quot;</span>, </span>
<span id="cb27-50"><a href="#cb27-50" tabindex="-1"></a>  <span class="st">&quot;Original Adj. $R^2$&quot;</span>, </span>
<span id="cb27-51"><a href="#cb27-51" tabindex="-1"></a>  <span class="st">&quot;Validation $R^2$&quot;</span>, </span>
<span id="cb27-52"><a href="#cb27-52" tabindex="-1"></a>  <span class="st">&quot;Validation Adj. $R^2$&quot;</span>)</span>
<span id="cb27-53"><a href="#cb27-53" tabindex="-1"></a> </span>
<span id="cb27-54"><a href="#cb27-54" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(my_output_table2, <span class="at">escape=</span><span class="cn">TRUE</span>, <span class="at">digits=</span><span class="dv">5</span>)</span></code></pre></div>
<table>
<colgroup>
<col width="19%" />
<col width="16%" />
<col width="21%" />
<col width="18%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="right">Original <span class="math inline">\(R^2\)</span></th>
<th align="right">Original Adj. <span
class="math inline">\(R^2\)</span></th>
<th align="right">Validation <span
class="math inline">\(R^2\)</span></th>
<th align="right">Validation Adj. <span
class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alternative Model</td>
<td align="right">0.92721</td>
<td align="right">0.92654</td>
<td align="right">0.92799</td>
<td align="right">0.92729</td>
</tr>
</tbody>
</table>
<p><br></p>
<p>Validations are satisfying. Even when using a sample size less than
half of the original, the R<sup>2</sup> coefficient remained true to the
model. This assures that the model is good for describing the estimation
of daily artists’ streams in Spotify. We could use the streaming results
of this model to estimate how much an artist makes if we wanted to. The
use cases of this model are many, and can be proven useful for artists
when planning ahead and focusing efforts on some specific marketing
task.</p>
<p><br><br><br><br></p>
<!-- add datasets -->
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
