<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Tonatiuh De Leon" />


<title>Modeling the Milky Way… or something else?</title>

<script src="site_libs/header-attrs-2.26/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="styles.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Tonatiuh de Leon</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Regression Models
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="DecibelRegression.html">Song Decibel Levels</a>
    </li>
    <li>
      <a href="SpotifyRegression.html">Spotify Regression</a>
    </li>
    <li>
      <a href="CarAnalysis.html">Selling my Car Regression</a>
    </li>
    <li>
      <a href="HousePriceRegression.html">House Prices Predictions</a>
    </li>
    <li>
      <a href="LogisticRegression325.html">Who's Getting Good Grades?</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Modeling &amp; Simulations
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Whale.html">Recreated the Milky Way, or a Whale?</a>
    </li>
    <li>
      <a href="Temple.html">Modeled a Beatiful Building</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Inferential Statistics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="StephApartment.html">Finding an Apartment</a>
    </li>
    <li>
      <a href="TtestInternet.html">Boys or Girls; Who Uses More Internet?</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Visualizations
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="TimeSeries.html">Correlation</a>
    </li>
    <li>
      <a href="Distributions.html">Distribution</a>
    </li>
    <li>
      <a href="Maps.html">Spatial</a>
    </li>
    <li>
      <a href="BarGraphs.html">Quick Comparison</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Machine Learning
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Coming Soon</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Time Series
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Coming Soon</li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Modeling the Milky Way… or something
else?</h1>
<h4 class="author">Tonatiuh De Leon</h4>

</div>


<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<div id="section" class="section level1 tabset tabset-pills">
<h1 class="tabset tabset-pills"></h1>
<div id="instroduction" class="section level2">
<h2>Instroduction</h2>
<hr />
<p><span class="math display">\[ \text{This section in my portfolio is
to show my capabilities at statistical modeling} \\ \\ \text{(Monte
Carlo Simulations) by using functional programming.} \\ \\
\text{Simulations are useful when not enough data is available for
a  specific scenario} \\ \\ \text{but you have parameters and an idea to
infer about the variables&#39; behavior.} \\ \\ \text{Those inferetions
can be used by modeling your data and then get an overall} \\ \\
\text{idea on how to approach the data to get better understanding of
its escence}\]</span></p>
<hr />
<p>When I learned about regression models, my teacher taught us by using
simulation modeling. He made up a game for us to create a simulated data
set with specific parameters to create any laws/models that we wanted.
Then put us to compete against each other and see who could figure out
the other student’s model by using regression techniques.</p>
<p>Here I’ll show you one of my models with which I competed in the game
called Regression-Battleship. This model started as a simple
representation of a spiral galaxy, but quickly ended up turning into a
different (but still good) idea!</p>
</div>
<div id="desmos-model" class="section level2">
<h2>Desmos Model</h2>
<p>We started the game by designing our model in Desmos as a drawing,
each different color would represent a different regression line with
change in intercepts and slope based on my programming.</p>
<p><strong>This is the bluepritn for my model. I first started trying to
create the Milky way (See below), but didn’t convince me.</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;_site/images/bship.png&quot;</span>)</span></code></pre></div>
<p><img src="_site/Images/bship.png" width="356" style="display: block; margin: auto;" /></p>
<p><br></p>
<p><strong>Then, after designing what would be the Milky Way, and
tweaking things here and there, I ended up creating a beautiful
whale!</strong></p>
<p><strong>This was then the model I played the game with</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;_site/images/whale.png&quot;</span>)</span></code></pre></div>
<p><img src="_site/Images/whale.png" width="232" style="display: block; margin: auto;" /></p>
</div>
<div id="r-plot" class="section level2">
<h2>R Plot</h2>
<p>After designing it in Desmos, we had to re-create our models using
functional programming for statistics in R. Check out the code in the
<strong>Show</strong> button to the right.</p>
<p>The output is then show as the graphs below with their respective
regression lines which my peers had to figure out.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>) </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">8</span>))</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>( .<span class="dv">5</span>,.<span class="dv">5</span>))</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> T, <span class="at">prob =</span> <span class="fu">c</span>( .<span class="dv">4</span>,.<span class="dv">6</span>))</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> T, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">4</span>,.<span class="dv">6</span>))</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="fl">1.6</span>,<span class="fl">3.1</span>)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a> </span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span> </span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>beta3 <span class="ot">&lt;-</span> <span class="fl">7.3</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>beta4 <span class="ot">&lt;-</span> <span class="fl">2.2</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>beta5 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">8</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>beta6 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>beta7 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>beta8 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">4.7</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>beta9 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">3.3</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>beta10 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>beta11 <span class="ot">&lt;-</span> .<span class="dv">8</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>beta12 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a>beta13 <span class="ot">&lt;-</span> <span class="fl">2.2</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>beta14 <span class="ot">&lt;-</span> <span class="fl">2.1</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>beta15 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.2</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a>beta16 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">8</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>beta17 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a>beta18 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.3</span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a>beta19 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">9</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a>beta20 <span class="ot">&lt;-</span> <span class="fl">2.4</span></span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a> </span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#change to whatever positive number you want</span></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x6 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x6 <span class="sc">==</span> <span class="dv">0</span>), <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a> </span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x6 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x6 <span class="sc">==</span> <span class="dv">0</span>), <span class="sc">-</span><span class="fl">3.3</span>, <span class="dv">3</span>)</span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a></span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x6 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x6 <span class="sc">==</span> <span class="dv">0</span>), <span class="sc">-</span><span class="dv">1</span>, <span class="fl">3.1</span>)</span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a></span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x6<span class="sc">==</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span><span class="sc">&amp;</span> x6<span class="sc">==</span><span class="dv">0</span>), <span class="sc">-</span><span class="fl">1.51</span>, <span class="dv">1</span>)</span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a></span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span>  <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x6 <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x6 <span class="sc">==</span> <span class="dv">1</span>), <span class="dv">0</span>, .<span class="dv">9</span>)</span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a></span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a> </span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a> Y_i <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1<span class="sc">*</span>x1 <span class="sc">+</span> beta2<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a>  </span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a>  beta3<span class="sc">*</span>x2 <span class="sc">+</span> beta4<span class="sc">*</span>x1<span class="sc">*</span>x2 <span class="sc">+</span> beta5<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2 <span class="sc">+</span> beta6<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2 <span class="sc">+</span> beta7<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">4</span><span class="sc">*</span>x2 <span class="sc">+</span></span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a>  </span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a>    beta8<span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta9<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta10<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta11<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta12<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">4</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span></span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a>  </span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a>  beta13<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta14<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta15<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta16<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta17<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">4</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> </span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a>  </span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a>  beta18<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x6 <span class="sc">+</span> beta19<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x6 <span class="sc">+</span> beta20<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x6 </span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a></span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a> rbdatawhale <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>(Y_i), <span class="at">x1=</span>(x1), <span class="at">x2=</span>x2 ,<span class="at">x3=</span>x3, <span class="at">x4=</span>x4, <span class="at">x6=</span>x6) </span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a> </span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a> </span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a><span class="fu">ggplot</span>(rbdatawhale, <span class="fu">aes</span>(x1, y, <span class="at">col=</span>x1)) <span class="sc">+</span></span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a>  </span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a>  </span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a>  viridis<span class="sc">::</span><span class="fu">scale_color_viridis</span>(<span class="at">direction =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">option =</span> <span class="st">&quot;G&quot;</span>, <span class="at">alpha =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a>  </span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-77"><a href="#cb4-77" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;|Colorful Whale|</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="sc">+</span></span>
<span id="cb4-78"><a href="#cb4-78" tabindex="-1"></a></span>
<span id="cb4-79"><a href="#cb4-79" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb4-80"><a href="#cb4-80" tabindex="-1"></a>  </span>
<span id="cb4-81"><a href="#cb4-81" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-82"><a href="#cb4-82" tabindex="-1"></a>    <span class="co">#plot.subtitle = element_text(hjust = .3 ,color = &quot;grey40&quot;),</span></span>
<span id="cb4-83"><a href="#cb4-83" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span>.<span class="dv">05</span>, <span class="at">color =</span> <span class="st">&quot;grey25&quot;</span>),</span>
<span id="cb4-84"><a href="#cb4-84" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span>.<span class="dv">9</span>, <span class="at">vjust =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;grey40&quot;</span>, <span class="at">size=</span><span class="dv">10</span>))</span></code></pre></div>
<p><img src="Whale_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="do">#####################################################</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># I untransform first before plotting my final model</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="do">#####################################################</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#set.seed(16) #n 300</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8</span>) <span class="co">#404</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#set.seed(120) </span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#set.seed(13)</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#This ensures the randomness is the &quot;same&quot; everytime if you play the entire R-chunk as one entire piece of code. If you run lines separately, your data might not come out the same every time. You can pick any integer value you want for set.seed. Each choice produces a different sample, so you might want to play around with a few different choices.</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="do">## To begin, decide on your sample size. (You may have to revise it later to ensure all values in your lm(...) are significant.)</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>  </span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">404</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="do">## Then, create 10 X-variables using functions like rnorm(n, mean, sd), rchisq(n, df), rf(n, df1, df2), rt(n, df), rbeta(n, a, b), runif(n, a, b) or sample(c(1,0), n, replace=TRUE)... ## To see what any of these functions do, run codes like hist(rchisq(n, 3)). These functions are simply allowing you to get a random sample of x-values. But the way you choose your x-values can have quite an impact on what the final scatterplot of the data will look like.</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="do">################################</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#These belong to my true model</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="do">################################</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a> </span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>(.<span class="dv">3</span>,.<span class="dv">6</span>,.<span class="dv">1</span>))</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>( .<span class="dv">4</span>,.<span class="dv">4</span>))</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> T, <span class="at">prob =</span> <span class="fu">c</span>( .<span class="dv">1</span>,.<span class="dv">8</span>))</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,.<span class="dv">01</span>)</span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a><span class="do">##############################################</span></span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="co">#The next are designed to throw people off</span></span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a><span class="do">##############################################</span></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">15</span>,<span class="dv">1</span>)</span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a>x7 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>( .<span class="dv">48</span>,.<span class="dv">46</span>,.<span class="dv">03</span>))</span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a>x8 <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a></span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a>x9 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.01</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, .<span class="dv">5</span>)</span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a></span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a></span>
<span id="cb5-47"><a href="#cb5-47" tabindex="-1"></a></span>
<span id="cb5-48"><a href="#cb5-48" tabindex="-1"></a> </span>
<span id="cb5-49"><a href="#cb5-49" tabindex="-1"></a><span class="do">## Then, create betas, sigma, normal error terms and y</span></span>
<span id="cb5-50"><a href="#cb5-50" tabindex="-1"></a> </span>
<span id="cb5-51"><a href="#cb5-51" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span> </span>
<span id="cb5-52"><a href="#cb5-52" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb5-53"><a href="#cb5-53" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb5-54"><a href="#cb5-54" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb5-55"><a href="#cb5-55" tabindex="-1"></a>beta3 <span class="ot">&lt;-</span> <span class="fl">7.3</span></span>
<span id="cb5-56"><a href="#cb5-56" tabindex="-1"></a>beta4 <span class="ot">&lt;-</span> <span class="fl">2.2</span></span>
<span id="cb5-57"><a href="#cb5-57" tabindex="-1"></a>beta5 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">8</span></span>
<span id="cb5-58"><a href="#cb5-58" tabindex="-1"></a>beta6 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb5-59"><a href="#cb5-59" tabindex="-1"></a>beta7 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-60"><a href="#cb5-60" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb5-61"><a href="#cb5-61" tabindex="-1"></a>beta8 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">4.7</span></span>
<span id="cb5-62"><a href="#cb5-62" tabindex="-1"></a>beta9 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">3.3</span></span>
<span id="cb5-63"><a href="#cb5-63" tabindex="-1"></a>beta10 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-64"><a href="#cb5-64" tabindex="-1"></a>beta11 <span class="ot">&lt;-</span> .<span class="dv">8</span></span>
<span id="cb5-65"><a href="#cb5-65" tabindex="-1"></a>beta12 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb5-66"><a href="#cb5-66" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb5-67"><a href="#cb5-67" tabindex="-1"></a>beta13 <span class="ot">&lt;-</span> <span class="fl">2.2</span></span>
<span id="cb5-68"><a href="#cb5-68" tabindex="-1"></a>beta14 <span class="ot">&lt;-</span> <span class="fl">2.1</span></span>
<span id="cb5-69"><a href="#cb5-69" tabindex="-1"></a>beta15 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.2</span></span>
<span id="cb5-70"><a href="#cb5-70" tabindex="-1"></a>beta16 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">8</span></span>
<span id="cb5-71"><a href="#cb5-71" tabindex="-1"></a>beta17 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb5-72"><a href="#cb5-72" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb5-73"><a href="#cb5-73" tabindex="-1"></a>beta18 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.3</span></span>
<span id="cb5-74"><a href="#cb5-74" tabindex="-1"></a>beta19 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">9</span></span>
<span id="cb5-75"><a href="#cb5-75" tabindex="-1"></a>beta20 <span class="ot">&lt;-</span> <span class="fl">2.4</span></span>
<span id="cb5-76"><a href="#cb5-76" tabindex="-1"></a></span>
<span id="cb5-77"><a href="#cb5-77" tabindex="-1"></a> </span>
<span id="cb5-78"><a href="#cb5-78" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> .<span class="dv">05</span> <span class="co">#change to whatever positive number you want</span></span>
<span id="cb5-79"><a href="#cb5-79" tabindex="-1"></a></span>
<span id="cb5-80"><a href="#cb5-80" tabindex="-1"></a><span class="do">#########################################################################</span></span>
<span id="cb5-81"><a href="#cb5-81" tabindex="-1"></a><span class="co">#These are also part of the design that limits the domain of each line</span></span>
<span id="cb5-82"><a href="#cb5-82" tabindex="-1"></a><span class="co">#These also make it so that most points are in the center of the eye</span></span>
<span id="cb5-83"><a href="#cb5-83" tabindex="-1"></a><span class="co">#Even though it looks like the eye of Sauron, it&#39;s actually the milky way</span></span>
<span id="cb5-84"><a href="#cb5-84" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb5-85"><a href="#cb5-85" tabindex="-1"></a></span>
<span id="cb5-86"><a href="#cb5-86" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ), <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb5-87"><a href="#cb5-87" tabindex="-1"></a> </span>
<span id="cb5-88"><a href="#cb5-88" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ), <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">1.01</span>)</span>
<span id="cb5-89"><a href="#cb5-89" tabindex="-1"></a></span>
<span id="cb5-90"><a href="#cb5-90" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ), <span class="sc">-</span><span class="fl">3.3</span>, <span class="dv">3</span>)</span>
<span id="cb5-91"><a href="#cb5-91" tabindex="-1"></a></span>
<span id="cb5-92"><a href="#cb5-92" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span>  ), <span class="sc">-</span><span class="fl">1.01</span>, <span class="sc">-</span><span class="fl">1.01</span>)</span>
<span id="cb5-93"><a href="#cb5-93" tabindex="-1"></a></span>
<span id="cb5-94"><a href="#cb5-94" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span>  ), <span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">3.1</span>)</span>
<span id="cb5-95"><a href="#cb5-95" tabindex="-1"></a></span>
<span id="cb5-96"><a href="#cb5-96" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span>), <span class="sc">--</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb5-97"><a href="#cb5-97" tabindex="-1"></a></span>
<span id="cb5-98"><a href="#cb5-98" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span>), <span class="sc">-</span>.<span class="dv">5</span>, <span class="fl">1.15</span>)</span>
<span id="cb5-99"><a href="#cb5-99" tabindex="-1"></a></span>
<span id="cb5-100"><a href="#cb5-100" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span>), <span class="sc">--</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb5-101"><a href="#cb5-101" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span>), <span class="dv">1</span>, <span class="fl">1.1</span>)</span>
<span id="cb5-102"><a href="#cb5-102" tabindex="-1"></a></span>
<span id="cb5-103"><a href="#cb5-103" tabindex="-1"></a></span>
<span id="cb5-104"><a href="#cb5-104" tabindex="-1"></a> <span class="do">################################</span></span>
<span id="cb5-105"><a href="#cb5-105" tabindex="-1"></a> <span class="co"># You ARE NOT ALLOWED to change this part:</span></span>
<span id="cb5-106"><a href="#cb5-106" tabindex="-1"></a>epsilon_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma) </span>
<span id="cb5-107"><a href="#cb5-107" tabindex="-1"></a> <span class="do">################################ </span></span>
<span id="cb5-108"><a href="#cb5-108" tabindex="-1"></a> </span>
<span id="cb5-109"><a href="#cb5-109" tabindex="-1"></a> <span class="co">#An example of how to make Y...</span></span>
<span id="cb5-110"><a href="#cb5-110" tabindex="-1"></a> <span class="co"># y &lt;-  beta0 + beta1*X1 + beta2*X2 + beta3*X4*X2 + epsilon_i</span></span>
<span id="cb5-111"><a href="#cb5-111" tabindex="-1"></a> </span>
<span id="cb5-112"><a href="#cb5-112" tabindex="-1"></a> Y_i <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1<span class="sc">*</span>x1 <span class="sc">+</span> beta2<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb5-113"><a href="#cb5-113" tabindex="-1"></a>  </span>
<span id="cb5-114"><a href="#cb5-114" tabindex="-1"></a>  beta3<span class="sc">*</span>x2 <span class="sc">+</span> beta4<span class="sc">*</span>x1<span class="sc">*</span>x2 <span class="sc">+</span> beta5<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2 <span class="sc">+</span> beta6<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2 <span class="sc">+</span></span>
<span id="cb5-115"><a href="#cb5-115" tabindex="-1"></a>  </span>
<span id="cb5-116"><a href="#cb5-116" tabindex="-1"></a>    beta8<span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta9<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta10<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta11<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta12<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">4</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span></span>
<span id="cb5-117"><a href="#cb5-117" tabindex="-1"></a>  </span>
<span id="cb5-118"><a href="#cb5-118" tabindex="-1"></a>  beta13<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta14<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta15<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta17<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span></span>
<span id="cb5-119"><a href="#cb5-119" tabindex="-1"></a>  </span>
<span id="cb5-120"><a href="#cb5-120" tabindex="-1"></a>  beta18<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x7 <span class="sc">+</span> beta19<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x7 <span class="sc">+</span> beta20<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x7 <span class="sc">+</span></span>
<span id="cb5-121"><a href="#cb5-121" tabindex="-1"></a>  </span>
<span id="cb5-122"><a href="#cb5-122" tabindex="-1"></a>  epsilon_i</span>
<span id="cb5-123"><a href="#cb5-123" tabindex="-1"></a></span>
<span id="cb5-124"><a href="#cb5-124" tabindex="-1"></a><span class="co">#...edit this code and replace it with your model. Don&#39;t forget the + epsilon_i!</span></span>
<span id="cb5-125"><a href="#cb5-125" tabindex="-1"></a></span>
<span id="cb5-126"><a href="#cb5-126" tabindex="-1"></a><span class="do">#################################################################</span></span>
<span id="cb5-127"><a href="#cb5-127" tabindex="-1"></a><span class="co">#These are the second part of the evil plan to throw people off, even though I used y_i to make x10 I didn&#39;t use x10 in my true model, and it won&#39;t make a difference, it&#39;s only to distract people in the first pairs plot</span></span>
<span id="cb5-128"><a href="#cb5-128" tabindex="-1"></a><span class="do">#################################################################</span></span>
<span id="cb5-129"><a href="#cb5-129" tabindex="-1"></a></span>
<span id="cb5-130"><a href="#cb5-130" tabindex="-1"></a></span>
<span id="cb5-131"><a href="#cb5-131" tabindex="-1"></a>x10 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>Y_i<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb5-132"><a href="#cb5-132" tabindex="-1"></a></span>
<span id="cb5-133"><a href="#cb5-133" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">15</span><span class="sc">*</span>x9<span class="sc">*</span>x5<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">rbeta</span>(n,<span class="dv">15</span>,<span class="dv">1</span>)))</span>
<span id="cb5-134"><a href="#cb5-134" tabindex="-1"></a></span>
<span id="cb5-135"><a href="#cb5-135" tabindex="-1"></a>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">15</span><span class="sc">*</span>x9<span class="sc">*</span>x5<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">rbeta</span>(n,<span class="dv">1</span>,<span class="dv">15</span>)))</span>
<span id="cb5-136"><a href="#cb5-136" tabindex="-1"></a></span>
<span id="cb5-137"><a href="#cb5-137" tabindex="-1"></a></span>
<span id="cb5-138"><a href="#cb5-138" tabindex="-1"></a>x9 <span class="ot">&lt;-</span> Y_i <span class="sc">+</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb5-139"><a href="#cb5-139" tabindex="-1"></a></span>
<span id="cb5-140"><a href="#cb5-140" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>( .<span class="dv">48</span>,.<span class="dv">001</span> ,.<span class="dv">47</span>))</span>
<span id="cb5-141"><a href="#cb5-141" tabindex="-1"></a></span>
<span id="cb5-142"><a href="#cb5-142" tabindex="-1"></a></span>
<span id="cb5-143"><a href="#cb5-143" tabindex="-1"></a></span>
<span id="cb5-144"><a href="#cb5-144" tabindex="-1"></a> <span class="do">## Now, you need to load your x-variables and y-variable </span></span>
<span id="cb5-145"><a href="#cb5-145" tabindex="-1"></a> <span class="do">## into a data set.</span></span>
<span id="cb5-146"><a href="#cb5-146" tabindex="-1"></a> <span class="co"># You can include Y&#39; or X&#39; instead of Y or X if you wish.</span></span>
<span id="cb5-147"><a href="#cb5-147" tabindex="-1"></a> <span class="co"># Remember, only these functions are allowed when transforming</span></span>
<span id="cb5-148"><a href="#cb5-148" tabindex="-1"></a> <span class="co"># variables: 1/Y^2, 1/Y, log(Y), sqrt(Y), sqrt(sqrt(Y)), Y^2, Y^3, 1/X^2, 1/X, log(X), sqrt(X), sqrt(sqrt(X)), X^2, X^3, X^4, X^5. </span></span>
<span id="cb5-149"><a href="#cb5-149" tabindex="-1"></a> <span class="do">#########################################################</span></span>
<span id="cb5-150"><a href="#cb5-150" tabindex="-1"></a> <span class="co"># ILLEGAL: Y = (beta0 + beta1*X5)^2 + epsilon_i #########</span></span>
<span id="cb5-151"><a href="#cb5-151" tabindex="-1"></a> <span class="do">#########################################################</span></span>
<span id="cb5-152"><a href="#cb5-152" tabindex="-1"></a> <span class="co"># Legal: sqrt(Y) = beta0 + beta1*X5^2 + epsilon_i #######</span></span>
<span id="cb5-153"><a href="#cb5-153" tabindex="-1"></a> <span class="do">#########################################################</span></span>
<span id="cb5-154"><a href="#cb5-154" tabindex="-1"></a> <span class="co"># You can only transform individual terms, not groups of terms.</span></span>
<span id="cb5-155"><a href="#cb5-155" tabindex="-1"></a> <span class="co"># And the beta&#39;s cannot be part of the x-transformations.</span></span>
<span id="cb5-156"><a href="#cb5-156" tabindex="-1"></a></span>
<span id="cb5-157"><a href="#cb5-157" tabindex="-1"></a> <span class="co"># This loads your data into a data set:</span></span>
<span id="cb5-158"><a href="#cb5-158" tabindex="-1"></a></span>
<span id="cb5-159"><a href="#cb5-159" tabindex="-1"></a></span>
<span id="cb5-160"><a href="#cb5-160" tabindex="-1"></a></span>
<span id="cb5-161"><a href="#cb5-161" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb5-162"><a href="#cb5-162" tabindex="-1"></a><span class="co">#I added my transformations here only y and x1 using 1/i</span></span>
<span id="cb5-163"><a href="#cb5-163" tabindex="-1"></a><span class="do">#######################################################################</span></span>
<span id="cb5-164"><a href="#cb5-164" tabindex="-1"></a></span>
<span id="cb5-165"><a href="#cb5-165" tabindex="-1"></a> rbdata1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>(<span class="dv">1</span><span class="sc">/</span>Y_i), <span class="at">x1=</span><span class="dv">1</span><span class="sc">/</span>(x1), <span class="at">x2=</span>x2 ,<span class="at">x3=</span>x3, <span class="at">x4=</span>x4, <span class="at">x5=</span><span class="dv">1</span><span class="sc">/</span>x5, <span class="at">x6=</span>x6, <span class="at">x7=</span>x7, <span class="at">x8=</span>x8<span class="sc">^</span><span class="dv">3</span>, <span class="at">x9=</span>(x9), <span class="at">x10=</span>(x10)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-166"><a href="#cb5-166" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb5-167"><a href="#cb5-167" tabindex="-1"></a> </span>
<span id="cb5-168"><a href="#cb5-168" tabindex="-1"></a></span>
<span id="cb5-169"><a href="#cb5-169" tabindex="-1"></a></span>
<span id="cb5-170"><a href="#cb5-170" tabindex="-1"></a></span>
<span id="cb5-171"><a href="#cb5-171" tabindex="-1"></a> <span class="co">#Now fit your model to make sure it comes out significant:</span></span>
<span id="cb5-172"><a href="#cb5-172" tabindex="-1"></a></span>
<span id="cb5-173"><a href="#cb5-173" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb5-174"><a href="#cb5-174" tabindex="-1"></a><span class="co">#My model is significant when untransformed; I&#39;d have to untransform my columns and then do the lm. it has .97 R^2 and *&#39;s in all p values</span></span>
<span id="cb5-175"><a href="#cb5-175" tabindex="-1"></a><span class="do">#############################################################################</span></span>
<span id="cb5-176"><a href="#cb5-176" tabindex="-1"></a></span>
<span id="cb5-177"><a href="#cb5-177" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb5-178"><a href="#cb5-178" tabindex="-1"></a><span class="do">## These are all the anti transformations needed ##</span></span>
<span id="cb5-179"><a href="#cb5-179" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb5-180"><a href="#cb5-180" tabindex="-1"></a></span>
<span id="cb5-181"><a href="#cb5-181" tabindex="-1"></a>rbdata1<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>y)     </span>
<span id="cb5-182"><a href="#cb5-182" tabindex="-1"></a>rbdata1<span class="sc">$</span>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>x1)</span>
<span id="cb5-183"><a href="#cb5-183" tabindex="-1"></a></span>
<span id="cb5-184"><a href="#cb5-184" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-185"><a href="#cb5-185" tabindex="-1"></a>             </span>
<span id="cb5-186"><a href="#cb5-186" tabindex="-1"></a>  x2 <span class="sc">+</span> x1<span class="sc">:</span>x2 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x2 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">3</span>)<span class="sc">:</span>x2  <span class="sc">+</span> </span>
<span id="cb5-187"><a href="#cb5-187" tabindex="-1"></a>    </span>
<span id="cb5-188"><a href="#cb5-188" tabindex="-1"></a>    x2<span class="sc">:</span>x3 <span class="sc">+</span> x1<span class="sc">:</span>x2<span class="sc">:</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">3</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">4</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3 <span class="sc">+</span></span>
<span id="cb5-189"><a href="#cb5-189" tabindex="-1"></a>    </span>
<span id="cb5-190"><a href="#cb5-190" tabindex="-1"></a>    x2<span class="sc">:</span>x3<span class="sc">:</span>x4 <span class="sc">+</span> x1<span class="sc">:</span>x2<span class="sc">:</span>x3<span class="sc">:</span>x4 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3<span class="sc">:</span>x4  <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">3</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3<span class="sc">:</span>x4 <span class="sc">+</span></span>
<span id="cb5-191"><a href="#cb5-191" tabindex="-1"></a>    </span>
<span id="cb5-192"><a href="#cb5-192" tabindex="-1"></a>    x2<span class="sc">:</span>x3<span class="sc">:</span>x4<span class="sc">:</span>x7 <span class="sc">+</span> x1<span class="sc">:</span>x2<span class="sc">:</span>x3<span class="sc">:</span>x4<span class="sc">:</span>x7 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3<span class="sc">:</span>x4<span class="sc">:</span>x7,</span>
<span id="cb5-193"><a href="#cb5-193" tabindex="-1"></a>              </span>
<span id="cb5-194"><a href="#cb5-194" tabindex="-1"></a>              <span class="at">data =</span> rbdata1)</span>
<span id="cb5-195"><a href="#cb5-195" tabindex="-1"></a></span>
<span id="cb5-196"><a href="#cb5-196" tabindex="-1"></a> <span class="co">#edit this code to be your true model</span></span>
<span id="cb5-197"><a href="#cb5-197" tabindex="-1"></a> <span class="co">#summary(mylm)</span></span>
<span id="cb5-198"><a href="#cb5-198" tabindex="-1"></a> <span class="co">#all p-values must be significant</span></span>
<span id="cb5-199"><a href="#cb5-199" tabindex="-1"></a> <span class="co">#the R^2 value must be greater than or equal to 0.30.</span></span>
<span id="cb5-200"><a href="#cb5-200" tabindex="-1"></a></span>
<span id="cb5-201"><a href="#cb5-201" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb5-202"><a href="#cb5-202" tabindex="-1"></a><span class="co">#Retransforming before writing CSV</span></span>
<span id="cb5-203"><a href="#cb5-203" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb5-204"><a href="#cb5-204" tabindex="-1"></a> </span>
<span id="cb5-205"><a href="#cb5-205" tabindex="-1"></a> rbdata1<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>y)    </span>
<span id="cb5-206"><a href="#cb5-206" tabindex="-1"></a> rbdata1<span class="sc">$</span>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>x1)</span>
<span id="cb5-207"><a href="#cb5-207" tabindex="-1"></a></span>
<span id="cb5-208"><a href="#cb5-208" tabindex="-1"></a><span class="co"># Once you are done with creating your model, and have successfully</span></span>
<span id="cb5-209"><a href="#cb5-209" tabindex="-1"></a><span class="co"># graphed it (see below), un-comment the following `write.csv` code,</span></span>
<span id="cb5-210"><a href="#cb5-210" tabindex="-1"></a><span class="co"># then, PLAY this ENTIRE R-chunk to write your data to a csv.</span></span>
<span id="cb5-211"><a href="#cb5-211" tabindex="-1"></a></span>
<span id="cb5-212"><a href="#cb5-212" tabindex="-1"></a><span class="do">#############################################</span></span>
<span id="cb5-213"><a href="#cb5-213" tabindex="-1"></a><span class="co"># Here I change the columns orders and names</span></span>
<span id="cb5-214"><a href="#cb5-214" tabindex="-1"></a><span class="do">#############################################</span></span>
<span id="cb5-215"><a href="#cb5-215" tabindex="-1"></a> rbdata1 <span class="ot">&lt;-</span> rbdata1 <span class="sc">%&gt;%</span> </span>
<span id="cb5-216"><a href="#cb5-216" tabindex="-1"></a>   <span class="fu">rename</span>(<span class="at">x8 =</span> x1,</span>
<span id="cb5-217"><a href="#cb5-217" tabindex="-1"></a>          <span class="at">x1 =</span> x2,</span>
<span id="cb5-218"><a href="#cb5-218" tabindex="-1"></a>          <span class="at">x7 =</span> x3,</span>
<span id="cb5-219"><a href="#cb5-219" tabindex="-1"></a>          <span class="at">x10 =</span> x4,</span>
<span id="cb5-220"><a href="#cb5-220" tabindex="-1"></a>          <span class="at">x3 =</span> x7,</span>
<span id="cb5-221"><a href="#cb5-221" tabindex="-1"></a>          <span class="at">x2 =</span> x8,</span>
<span id="cb5-222"><a href="#cb5-222" tabindex="-1"></a>          <span class="at">x4 =</span> x10) <span class="sc">%&gt;%</span> </span>
<span id="cb5-223"><a href="#cb5-223" tabindex="-1"></a>   <span class="fu">select</span>(</span>
<span id="cb5-224"><a href="#cb5-224" tabindex="-1"></a>     y,x1,x2,x3,x4,x5,</span>
<span id="cb5-225"><a href="#cb5-225" tabindex="-1"></a>     x6,x7,x8,x9,x10) <span class="sc">%&gt;%</span> </span>
<span id="cb5-226"><a href="#cb5-226" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb5-227"><a href="#cb5-227" tabindex="-1"></a> </span>
<span id="cb5-228"><a href="#cb5-228" tabindex="-1"></a> </span>
<span id="cb5-229"><a href="#cb5-229" tabindex="-1"></a><span class="co">#write.csv(rbdata1, &quot;rbdata1.csv&quot;, row.names=FALSE)</span></span>
<span id="cb5-230"><a href="#cb5-230" tabindex="-1"></a></span>
<span id="cb5-231"><a href="#cb5-231" tabindex="-1"></a></span>
<span id="cb5-232"><a href="#cb5-232" tabindex="-1"></a><span class="co"># The above code writes the dataset to your &quot;current directory&quot;</span></span>
<span id="cb5-233"><a href="#cb5-233" tabindex="-1"></a><span class="co"># # To see where that is, use: getwd() in your Console.</span></span>
<span id="cb5-234"><a href="#cb5-234" tabindex="-1"></a><span class="co"># # Find the rbdata.csv data set and upload it to I-Learn.</span></span>
<span id="cb5-235"><a href="#cb5-235" tabindex="-1"></a><span class="co">#  rbdata1$y &lt;- 1/(rbdata1$y)     </span></span>
<span id="cb5-236"><a href="#cb5-236" tabindex="-1"></a><span class="co">#  rbdata1$x8 &lt;- 1/(rbdata1$x8)</span></span>
<span id="cb5-237"><a href="#cb5-237" tabindex="-1"></a><span class="co"># # ggplot(rbdata1, aes(x8,y))+</span></span>
<span id="cb5-238"><a href="#cb5-238" tabindex="-1"></a><span class="co"># #   geom_point()</span></span>
<span id="cb5-239"><a href="#cb5-239" tabindex="-1"></a><span class="co"># pairs(rbdata1, panel=panel.smooth)</span></span>
<span id="cb5-240"><a href="#cb5-240" tabindex="-1"></a></span>
<span id="cb5-241"><a href="#cb5-241" tabindex="-1"></a>  rbdata1<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>y)    </span>
<span id="cb5-242"><a href="#cb5-242" tabindex="-1"></a>  rbdata1<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>x8)</span>
<span id="cb5-243"><a href="#cb5-243" tabindex="-1"></a></span>
<span id="cb5-244"><a href="#cb5-244" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(mylm)</span>
<span id="cb5-245"><a href="#cb5-245" tabindex="-1"></a></span>
<span id="cb5-246"><a href="#cb5-246" tabindex="-1"></a><span class="fu">ggplot</span>(rbdata1, <span class="fu">aes</span>(x8,y, <span class="at">col=</span><span class="fu">interaction</span>(x1,x3,x7,x10)))<span class="sc">+</span></span>
<span id="cb5-247"><a href="#cb5-247" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="at">show.legend =</span> F, <span class="at">pch=</span><span class="dv">1</span>, <span class="at">alpha=</span>.<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb5-248"><a href="#cb5-248" tabindex="-1"></a>  <span class="co"># geom_point(aes(y=mylm$fit), cex=1)+</span></span>
<span id="cb5-249"><a href="#cb5-249" tabindex="-1"></a>   <span class="co">#facet_wrap(~interaction(x1,x3,x7,x10)) +</span></span>
<span id="cb5-250"><a href="#cb5-250" tabindex="-1"></a>  </span>
<span id="cb5-251"><a href="#cb5-251" tabindex="-1"></a>  <span class="co">#viridis::scale_color_viridis(direction = -1, option = &quot;G&quot;, alpha = .1)+</span></span>
<span id="cb5-252"><a href="#cb5-252" tabindex="-1"></a>  </span>
<span id="cb5-253"><a href="#cb5-253" tabindex="-1"></a>  <span class="co">#geom_vline(xintercept = 0, linetype = &quot;solid&quot;, col=&quot;grey50&quot;) +  </span></span>
<span id="cb5-254"><a href="#cb5-254" tabindex="-1"></a>  <span class="co">#geom_hline(yintercept = 0, linetype = &quot;solid&quot;, col=&quot;grey50&quot;) +</span></span>
<span id="cb5-255"><a href="#cb5-255" tabindex="-1"></a>  </span>
<span id="cb5-256"><a href="#cb5-256" tabindex="-1"></a>  <span class="do">###### Betas</span></span>
<span id="cb5-257"><a href="#cb5-257" tabindex="-1"></a>  </span>
<span id="cb5-258"><a href="#cb5-258" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb5-259"><a href="#cb5-259" tabindex="-1"></a>     beta0 <span class="sc">+</span> beta1<span class="sc">*</span>x <span class="sc">+</span>beta2<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb5-260"><a href="#cb5-260" tabindex="-1"></a>     <span class="at">color =</span> <span class="st">&quot;purple&quot;</span>,</span>
<span id="cb5-261"><a href="#cb5-261" tabindex="-1"></a>     <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span>  <span class="co"># True line base</span></span>
<span id="cb5-262"><a href="#cb5-262" tabindex="-1"></a></span>
<span id="cb5-263"><a href="#cb5-263" tabindex="-1"></a>   <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb5-264"><a href="#cb5-264" tabindex="-1"></a>     (beta0 <span class="sc">+</span> beta3) <span class="sc">+</span> (beta1<span class="sc">+</span>beta4)<span class="sc">*</span>x <span class="sc">+</span> (beta2<span class="sc">+</span>beta5)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> beta6<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb5-265"><a href="#cb5-265" tabindex="-1"></a>     <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span>  <span class="co"># True 2 on</span></span>
<span id="cb5-266"><a href="#cb5-266" tabindex="-1"></a></span>
<span id="cb5-267"><a href="#cb5-267" tabindex="-1"></a>   <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb5-268"><a href="#cb5-268" tabindex="-1"></a>     (beta0 <span class="sc">+</span> beta3 <span class="sc">+</span> beta8) <span class="sc">+</span></span>
<span id="cb5-269"><a href="#cb5-269" tabindex="-1"></a>     (beta1 <span class="sc">+</span> beta4 <span class="sc">+</span> beta9)<span class="sc">*</span>x <span class="sc">+</span></span>
<span id="cb5-270"><a href="#cb5-270" tabindex="-1"></a>     (beta2 <span class="sc">+</span> beta5 <span class="sc">+</span> beta10)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb5-271"><a href="#cb5-271" tabindex="-1"></a>     (beta6 <span class="sc">+</span> beta11)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span> <span class="sc">+</span></span>
<span id="cb5-272"><a href="#cb5-272" tabindex="-1"></a>     beta12<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span>,</span>
<span id="cb5-273"><a href="#cb5-273" tabindex="-1"></a>     <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span>  <span class="co"># True 3 on</span></span>
<span id="cb5-274"><a href="#cb5-274" tabindex="-1"></a>  </span>
<span id="cb5-275"><a href="#cb5-275" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb5-276"><a href="#cb5-276" tabindex="-1"></a>     (beta0 <span class="sc">+</span> beta3 <span class="sc">+</span> beta8 <span class="sc">+</span> beta13) <span class="sc">+</span></span>
<span id="cb5-277"><a href="#cb5-277" tabindex="-1"></a>     (beta1 <span class="sc">+</span> beta4 <span class="sc">+</span> beta9 <span class="sc">+</span> beta14)<span class="sc">*</span>x <span class="sc">+</span></span>
<span id="cb5-278"><a href="#cb5-278" tabindex="-1"></a>     (beta2 <span class="sc">+</span> beta5 <span class="sc">+</span> beta10 <span class="sc">+</span> beta15)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb5-279"><a href="#cb5-279" tabindex="-1"></a>     (beta6 <span class="sc">+</span> beta11 <span class="sc">+</span> beta17)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb5-280"><a href="#cb5-280" tabindex="-1"></a>     <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span>      <span class="co"># True 4 on</span></span>
<span id="cb5-281"><a href="#cb5-281" tabindex="-1"></a>  </span>
<span id="cb5-282"><a href="#cb5-282" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb5-283"><a href="#cb5-283" tabindex="-1"></a>     (beta0 <span class="sc">+</span> beta3 <span class="sc">+</span> beta8 <span class="sc">+</span> <span class="sc">+</span>beta13 <span class="sc">+</span> beta18) <span class="sc">+</span></span>
<span id="cb5-284"><a href="#cb5-284" tabindex="-1"></a>     (beta1 <span class="sc">+</span> beta4 <span class="sc">+</span> beta9 <span class="sc">+</span> beta14 <span class="sc">+</span> beta19)<span class="sc">*</span>x <span class="sc">+</span></span>
<span id="cb5-285"><a href="#cb5-285" tabindex="-1"></a>     (beta2 <span class="sc">+</span> beta5 <span class="sc">+</span> beta10 <span class="sc">+</span> beta15 <span class="sc">+</span> beta20)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span></span>
<span id="cb5-286"><a href="#cb5-286" tabindex="-1"></a>     (beta6 <span class="sc">+</span> beta11 <span class="sc">+</span> beta17)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb5-287"><a href="#cb5-287" tabindex="-1"></a>     <span class="at">color =</span> <span class="st">&quot;green&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-288"><a href="#cb5-288" tabindex="-1"></a></span>
<span id="cb5-289"><a href="#cb5-289" tabindex="-1"></a>  <span class="do">######coefficients</span></span>
<span id="cb5-290"><a href="#cb5-290" tabindex="-1"></a></span>
<span id="cb5-291"><a href="#cb5-291" tabindex="-1"></a> <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb5-292"><a href="#cb5-292" tabindex="-1"></a>   b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb5-293"><a href="#cb5-293" tabindex="-1"></a>   <span class="at">color =</span> <span class="st">&quot;purple4&quot;</span>,</span>
<span id="cb5-294"><a href="#cb5-294" tabindex="-1"></a>   <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="sc">+</span>  <span class="co"># base line model</span></span>
<span id="cb5-295"><a href="#cb5-295" tabindex="-1"></a></span>
<span id="cb5-296"><a href="#cb5-296" tabindex="-1"></a> <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb5-297"><a href="#cb5-297" tabindex="-1"></a>   (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">4</span>]) <span class="sc">+</span> (b[<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">5</span>])<span class="sc">*</span>x <span class="sc">+</span> (b[<span class="dv">3</span>]<span class="sc">+</span>b[<span class="dv">6</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (b[<span class="dv">7</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb5-298"><a href="#cb5-298" tabindex="-1"></a>   <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="sc">+</span>  <span class="co"># model 2 on</span></span>
<span id="cb5-299"><a href="#cb5-299" tabindex="-1"></a></span>
<span id="cb5-300"><a href="#cb5-300" tabindex="-1"></a> <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb5-301"><a href="#cb5-301" tabindex="-1"></a>   (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">4</span>] <span class="sc">+</span> b[<span class="dv">8</span>]) <span class="sc">+</span></span>
<span id="cb5-302"><a href="#cb5-302" tabindex="-1"></a>   (b[<span class="dv">2</span>]<span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">+</span> b[<span class="dv">9</span>])<span class="sc">*</span>x <span class="sc">+</span></span>
<span id="cb5-303"><a href="#cb5-303" tabindex="-1"></a>   (b[<span class="dv">3</span>]<span class="sc">+</span>b[<span class="dv">6</span>]<span class="sc">+</span>b[<span class="dv">10</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb5-304"><a href="#cb5-304" tabindex="-1"></a>   (b[<span class="dv">7</span>]<span class="sc">+</span>b[<span class="dv">11</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span><span class="sc">+</span></span>
<span id="cb5-305"><a href="#cb5-305" tabindex="-1"></a>   b[<span class="dv">12</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span>,</span>
<span id="cb5-306"><a href="#cb5-306" tabindex="-1"></a>   <span class="at">color =</span> <span class="st">&quot;red4&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="sc">+</span>   <span class="co"># model 3 on</span></span>
<span id="cb5-307"><a href="#cb5-307" tabindex="-1"></a></span>
<span id="cb5-308"><a href="#cb5-308" tabindex="-1"></a> <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb5-309"><a href="#cb5-309" tabindex="-1"></a>   (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">4</span>] <span class="sc">+</span> b[<span class="dv">8</span>] <span class="sc">+</span>b[<span class="dv">13</span>]) <span class="sc">+</span></span>
<span id="cb5-310"><a href="#cb5-310" tabindex="-1"></a>   (b[<span class="dv">2</span>]<span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">+</span> b[<span class="dv">9</span>]<span class="sc">+</span>b[<span class="dv">14</span>])<span class="sc">*</span>x <span class="sc">+</span></span>
<span id="cb5-311"><a href="#cb5-311" tabindex="-1"></a>   (b[<span class="dv">3</span>]<span class="sc">+</span>b[<span class="dv">6</span>]<span class="sc">+</span>b[<span class="dv">10</span>]<span class="sc">+</span>b[<span class="dv">15</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb5-312"><a href="#cb5-312" tabindex="-1"></a>   (b[<span class="dv">7</span>]<span class="sc">+</span>b[<span class="dv">11</span>]<span class="sc">+</span>b[<span class="dv">16</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb5-313"><a href="#cb5-313" tabindex="-1"></a>     <span class="at">color =</span> <span class="st">&quot;blue4&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="sc">+</span>   <span class="co"># model 3 on</span></span>
<span id="cb5-314"><a href="#cb5-314" tabindex="-1"></a>  </span>
<span id="cb5-315"><a href="#cb5-315" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb5-316"><a href="#cb5-316" tabindex="-1"></a>   (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">4</span>] <span class="sc">+</span> b[<span class="dv">8</span>] <span class="sc">+</span>b[<span class="dv">13</span>] <span class="sc">+</span>b[<span class="dv">17</span>]) <span class="sc">+</span></span>
<span id="cb5-317"><a href="#cb5-317" tabindex="-1"></a>   (b[<span class="dv">2</span>]<span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">+</span> b[<span class="dv">9</span>]<span class="sc">+</span>b[<span class="dv">14</span>]<span class="sc">+</span>b[<span class="dv">18</span>])<span class="sc">*</span>x <span class="sc">+</span></span>
<span id="cb5-318"><a href="#cb5-318" tabindex="-1"></a>   (b[<span class="dv">3</span>]<span class="sc">+</span>b[<span class="dv">6</span>]<span class="sc">+</span>b[<span class="dv">10</span>]<span class="sc">+</span>b[<span class="dv">15</span>]<span class="sc">+</span>b[<span class="dv">19</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span></span>
<span id="cb5-319"><a href="#cb5-319" tabindex="-1"></a>   (b[<span class="dv">7</span>]<span class="sc">+</span>b[<span class="dv">11</span>]<span class="sc">+</span>b[<span class="dv">16</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb5-320"><a href="#cb5-320" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;green4&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-321"><a href="#cb5-321" tabindex="-1"></a></span>
<span id="cb5-322"><a href="#cb5-322" tabindex="-1"></a>  </span>
<span id="cb5-323"><a href="#cb5-323" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;|Whale With Regression Lines|</span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-324"><a href="#cb5-324" tabindex="-1"></a>  </span>
<span id="cb5-325"><a href="#cb5-325" tabindex="-1"></a>  </span>
<span id="cb5-326"><a href="#cb5-326" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb5-327"><a href="#cb5-327" tabindex="-1"></a></span>
<span id="cb5-328"><a href="#cb5-328" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="Whale_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a> rbdata1<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>y)     </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a> rbdata1<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>x8)</span></code></pre></div>
<p><br><br></p>
</div>
<div id="code" class="section level2">
<h2>Code</h2>
<p>Here is the code again, and the summary output showing that after
created, all terms are significant even at the <strong>.01</strong>
level.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co">#set.seed(16) #n 300</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8</span>) <span class="co">#404</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#set.seed(120) </span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#set.seed(13)</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#This ensures the randomness is the &quot;same&quot; everytime if you play the entire R-chunk as one entire piece of code. If you run lines separately, your data might not come out the same every time. You can pick any integer value you want for set.seed. Each choice produces a different sample, so you might want to play around with a few different choices.</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="do">## To begin, decide on your sample size. (You may have to revise it later to ensure all values in your lm(...) are significant.)</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>  </span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">404</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="do">## Then, create 10 X-variables using functions like rnorm(n, mean, sd), rchisq(n, df), rf(n, df1, df2), rt(n, df), rbeta(n, a, b), runif(n, a, b) or sample(c(1,0), n, replace=TRUE)... ## To see what any of these functions do, run codes like hist(rchisq(n, 3)). These functions are simply allowing you to get a random sample of x-values. But the way you choose your x-values can have quite an impact on what the final scatterplot of the data will look like.</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="do">################################</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">#These belong to my true model</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="do">################################</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a> </span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>(.<span class="dv">3</span>,.<span class="dv">6</span>,.<span class="dv">1</span>))</span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>( .<span class="dv">4</span>,.<span class="dv">4</span>))</span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> T, <span class="at">prob =</span> <span class="fu">c</span>( .<span class="dv">1</span>,.<span class="dv">8</span>))</span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,.<span class="dv">01</span>)</span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="do">##############################################</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="co">#The next are designed to throw people off</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="do">##############################################</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">15</span>,<span class="dv">1</span>)</span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a>x7 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>( .<span class="dv">48</span>,.<span class="dv">46</span>,.<span class="dv">03</span>))</span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a>x8 <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a>x9 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.01</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, .<span class="dv">5</span>)</span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a></span>
<span id="cb7-42"><a href="#cb7-42" tabindex="-1"></a></span>
<span id="cb7-43"><a href="#cb7-43" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" tabindex="-1"></a> </span>
<span id="cb7-45"><a href="#cb7-45" tabindex="-1"></a><span class="do">## Then, create betas, sigma, normal error terms and y</span></span>
<span id="cb7-46"><a href="#cb7-46" tabindex="-1"></a> </span>
<span id="cb7-47"><a href="#cb7-47" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span> </span>
<span id="cb7-48"><a href="#cb7-48" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb7-49"><a href="#cb7-49" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb7-50"><a href="#cb7-50" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-51"><a href="#cb7-51" tabindex="-1"></a>beta3 <span class="ot">&lt;-</span> <span class="fl">7.3</span></span>
<span id="cb7-52"><a href="#cb7-52" tabindex="-1"></a>beta4 <span class="ot">&lt;-</span> <span class="fl">2.2</span></span>
<span id="cb7-53"><a href="#cb7-53" tabindex="-1"></a>beta5 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">8</span></span>
<span id="cb7-54"><a href="#cb7-54" tabindex="-1"></a>beta6 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb7-55"><a href="#cb7-55" tabindex="-1"></a>beta7 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-56"><a href="#cb7-56" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-57"><a href="#cb7-57" tabindex="-1"></a>beta8 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">4.7</span></span>
<span id="cb7-58"><a href="#cb7-58" tabindex="-1"></a>beta9 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">3.3</span></span>
<span id="cb7-59"><a href="#cb7-59" tabindex="-1"></a>beta10 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-60"><a href="#cb7-60" tabindex="-1"></a>beta11 <span class="ot">&lt;-</span> .<span class="dv">8</span></span>
<span id="cb7-61"><a href="#cb7-61" tabindex="-1"></a>beta12 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb7-62"><a href="#cb7-62" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-63"><a href="#cb7-63" tabindex="-1"></a>beta13 <span class="ot">&lt;-</span> <span class="fl">2.2</span></span>
<span id="cb7-64"><a href="#cb7-64" tabindex="-1"></a>beta14 <span class="ot">&lt;-</span> <span class="fl">2.1</span></span>
<span id="cb7-65"><a href="#cb7-65" tabindex="-1"></a>beta15 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.2</span></span>
<span id="cb7-66"><a href="#cb7-66" tabindex="-1"></a>beta16 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">8</span></span>
<span id="cb7-67"><a href="#cb7-67" tabindex="-1"></a>beta17 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb7-68"><a href="#cb7-68" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-69"><a href="#cb7-69" tabindex="-1"></a>beta18 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.3</span></span>
<span id="cb7-70"><a href="#cb7-70" tabindex="-1"></a>beta19 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">9</span></span>
<span id="cb7-71"><a href="#cb7-71" tabindex="-1"></a>beta20 <span class="ot">&lt;-</span> <span class="fl">2.4</span></span>
<span id="cb7-72"><a href="#cb7-72" tabindex="-1"></a></span>
<span id="cb7-73"><a href="#cb7-73" tabindex="-1"></a> </span>
<span id="cb7-74"><a href="#cb7-74" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> .<span class="dv">05</span> <span class="co">#change to whatever positive number you want</span></span>
<span id="cb7-75"><a href="#cb7-75" tabindex="-1"></a></span>
<span id="cb7-76"><a href="#cb7-76" tabindex="-1"></a><span class="do">#########################################################################</span></span>
<span id="cb7-77"><a href="#cb7-77" tabindex="-1"></a><span class="co">#These are also part of the design that limits the domain of each line</span></span>
<span id="cb7-78"><a href="#cb7-78" tabindex="-1"></a><span class="co">#These also make it so that most points are in the center of the eye</span></span>
<span id="cb7-79"><a href="#cb7-79" tabindex="-1"></a><span class="co">#Even though it looks like the eye of Sauron, it&#39;s actually the milky way</span></span>
<span id="cb7-80"><a href="#cb7-80" tabindex="-1"></a><span class="do">##########################################################################</span></span>
<span id="cb7-81"><a href="#cb7-81" tabindex="-1"></a></span>
<span id="cb7-82"><a href="#cb7-82" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ), <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb7-83"><a href="#cb7-83" tabindex="-1"></a> </span>
<span id="cb7-84"><a href="#cb7-84" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ), <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">1.01</span>)</span>
<span id="cb7-85"><a href="#cb7-85" tabindex="-1"></a></span>
<span id="cb7-86"><a href="#cb7-86" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ), <span class="sc">-</span><span class="fl">3.3</span>, <span class="dv">3</span>)</span>
<span id="cb7-87"><a href="#cb7-87" tabindex="-1"></a></span>
<span id="cb7-88"><a href="#cb7-88" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span>  ), <span class="sc">-</span><span class="fl">1.01</span>, <span class="sc">-</span><span class="fl">1.01</span>)</span>
<span id="cb7-89"><a href="#cb7-89" tabindex="-1"></a></span>
<span id="cb7-90"><a href="#cb7-90" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span>  ), <span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">3.1</span>)</span>
<span id="cb7-91"><a href="#cb7-91" tabindex="-1"></a></span>
<span id="cb7-92"><a href="#cb7-92" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span>), <span class="sc">--</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb7-93"><a href="#cb7-93" tabindex="-1"></a></span>
<span id="cb7-94"><a href="#cb7-94" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span>), <span class="sc">-</span>.<span class="dv">5</span>, <span class="fl">1.15</span>)</span>
<span id="cb7-95"><a href="#cb7-95" tabindex="-1"></a></span>
<span id="cb7-96"><a href="#cb7-96" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span>), <span class="sc">--</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb7-97"><a href="#cb7-97" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span>), <span class="dv">1</span>, <span class="fl">1.1</span>)</span>
<span id="cb7-98"><a href="#cb7-98" tabindex="-1"></a></span>
<span id="cb7-99"><a href="#cb7-99" tabindex="-1"></a></span>
<span id="cb7-100"><a href="#cb7-100" tabindex="-1"></a> <span class="do">################################</span></span>
<span id="cb7-101"><a href="#cb7-101" tabindex="-1"></a> <span class="co"># You ARE NOT ALLOWED to change this part:</span></span>
<span id="cb7-102"><a href="#cb7-102" tabindex="-1"></a>epsilon_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma) </span>
<span id="cb7-103"><a href="#cb7-103" tabindex="-1"></a> <span class="do">################################ </span></span>
<span id="cb7-104"><a href="#cb7-104" tabindex="-1"></a> </span>
<span id="cb7-105"><a href="#cb7-105" tabindex="-1"></a> <span class="co">#An example of how to make Y...</span></span>
<span id="cb7-106"><a href="#cb7-106" tabindex="-1"></a> <span class="co"># y &lt;-  beta0 + beta1*X1 + beta2*X2 + beta3*X4*X2 + epsilon_i</span></span>
<span id="cb7-107"><a href="#cb7-107" tabindex="-1"></a> </span>
<span id="cb7-108"><a href="#cb7-108" tabindex="-1"></a> Y_i <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1<span class="sc">*</span>x1 <span class="sc">+</span> beta2<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb7-109"><a href="#cb7-109" tabindex="-1"></a>  </span>
<span id="cb7-110"><a href="#cb7-110" tabindex="-1"></a>  beta3<span class="sc">*</span>x2 <span class="sc">+</span> beta4<span class="sc">*</span>x1<span class="sc">*</span>x2 <span class="sc">+</span> beta5<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2 <span class="sc">+</span> beta6<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2 <span class="sc">+</span></span>
<span id="cb7-111"><a href="#cb7-111" tabindex="-1"></a>  </span>
<span id="cb7-112"><a href="#cb7-112" tabindex="-1"></a>    beta8<span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta9<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta10<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta11<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta12<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">4</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span></span>
<span id="cb7-113"><a href="#cb7-113" tabindex="-1"></a>  </span>
<span id="cb7-114"><a href="#cb7-114" tabindex="-1"></a>  beta13<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta14<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta15<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta17<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span></span>
<span id="cb7-115"><a href="#cb7-115" tabindex="-1"></a>  </span>
<span id="cb7-116"><a href="#cb7-116" tabindex="-1"></a>  beta18<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x7 <span class="sc">+</span> beta19<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x7 <span class="sc">+</span> beta20<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x7 <span class="sc">+</span></span>
<span id="cb7-117"><a href="#cb7-117" tabindex="-1"></a>  </span>
<span id="cb7-118"><a href="#cb7-118" tabindex="-1"></a>  epsilon_i</span>
<span id="cb7-119"><a href="#cb7-119" tabindex="-1"></a></span>
<span id="cb7-120"><a href="#cb7-120" tabindex="-1"></a><span class="co">#...edit this code and replace it with your model. Don&#39;t forget the + epsilon_i!</span></span>
<span id="cb7-121"><a href="#cb7-121" tabindex="-1"></a></span>
<span id="cb7-122"><a href="#cb7-122" tabindex="-1"></a><span class="do">#################################################################</span></span>
<span id="cb7-123"><a href="#cb7-123" tabindex="-1"></a><span class="co">#These are the second part of the evil plan to throw people off, even though I used y_i to make x10 I didn&#39;t use x10 in my true model, and it won&#39;t make a difference, it&#39;s only to distract people in the first pairs plot</span></span>
<span id="cb7-124"><a href="#cb7-124" tabindex="-1"></a><span class="do">#################################################################</span></span>
<span id="cb7-125"><a href="#cb7-125" tabindex="-1"></a></span>
<span id="cb7-126"><a href="#cb7-126" tabindex="-1"></a></span>
<span id="cb7-127"><a href="#cb7-127" tabindex="-1"></a>x10 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>Y_i<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb7-128"><a href="#cb7-128" tabindex="-1"></a></span>
<span id="cb7-129"><a href="#cb7-129" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">15</span><span class="sc">*</span>x9<span class="sc">*</span>x5<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">rbeta</span>(n,<span class="dv">15</span>,<span class="dv">1</span>)))</span>
<span id="cb7-130"><a href="#cb7-130" tabindex="-1"></a></span>
<span id="cb7-131"><a href="#cb7-131" tabindex="-1"></a>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">15</span><span class="sc">*</span>x9<span class="sc">*</span>x5<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">rbeta</span>(n,<span class="dv">1</span>,<span class="dv">15</span>)))</span>
<span id="cb7-132"><a href="#cb7-132" tabindex="-1"></a></span>
<span id="cb7-133"><a href="#cb7-133" tabindex="-1"></a></span>
<span id="cb7-134"><a href="#cb7-134" tabindex="-1"></a>x9 <span class="ot">&lt;-</span> Y_i <span class="sc">+</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb7-135"><a href="#cb7-135" tabindex="-1"></a></span>
<span id="cb7-136"><a href="#cb7-136" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>( .<span class="dv">48</span>,.<span class="dv">001</span> ,.<span class="dv">47</span>))</span>
<span id="cb7-137"><a href="#cb7-137" tabindex="-1"></a></span>
<span id="cb7-138"><a href="#cb7-138" tabindex="-1"></a></span>
<span id="cb7-139"><a href="#cb7-139" tabindex="-1"></a></span>
<span id="cb7-140"><a href="#cb7-140" tabindex="-1"></a> <span class="do">## Now, you need to load your x-variables and y-variable </span></span>
<span id="cb7-141"><a href="#cb7-141" tabindex="-1"></a> <span class="do">## into a data set.</span></span>
<span id="cb7-142"><a href="#cb7-142" tabindex="-1"></a> <span class="co"># You can include Y&#39; or X&#39; instead of Y or X if you wish.</span></span>
<span id="cb7-143"><a href="#cb7-143" tabindex="-1"></a> <span class="co"># Remember, only these functions are allowed when transforming</span></span>
<span id="cb7-144"><a href="#cb7-144" tabindex="-1"></a> <span class="co"># variables: 1/Y^2, 1/Y, log(Y), sqrt(Y), sqrt(sqrt(Y)), Y^2, Y^3, 1/X^2, 1/X, log(X), sqrt(X), sqrt(sqrt(X)), X^2, X^3, X^4, X^5. </span></span>
<span id="cb7-145"><a href="#cb7-145" tabindex="-1"></a> <span class="do">#########################################################</span></span>
<span id="cb7-146"><a href="#cb7-146" tabindex="-1"></a> <span class="co"># ILLEGAL: Y = (beta0 + beta1*X5)^2 + epsilon_i #########</span></span>
<span id="cb7-147"><a href="#cb7-147" tabindex="-1"></a> <span class="do">#########################################################</span></span>
<span id="cb7-148"><a href="#cb7-148" tabindex="-1"></a> <span class="co"># Legal: sqrt(Y) = beta0 + beta1*X5^2 + epsilon_i #######</span></span>
<span id="cb7-149"><a href="#cb7-149" tabindex="-1"></a> <span class="do">#########################################################</span></span>
<span id="cb7-150"><a href="#cb7-150" tabindex="-1"></a> <span class="co"># You can only transform individual terms, not groups of terms.</span></span>
<span id="cb7-151"><a href="#cb7-151" tabindex="-1"></a> <span class="co"># And the beta&#39;s cannot be part of the x-transformations.</span></span>
<span id="cb7-152"><a href="#cb7-152" tabindex="-1"></a></span>
<span id="cb7-153"><a href="#cb7-153" tabindex="-1"></a> <span class="co"># This loads your data into a data set:</span></span>
<span id="cb7-154"><a href="#cb7-154" tabindex="-1"></a></span>
<span id="cb7-155"><a href="#cb7-155" tabindex="-1"></a></span>
<span id="cb7-156"><a href="#cb7-156" tabindex="-1"></a></span>
<span id="cb7-157"><a href="#cb7-157" tabindex="-1"></a><span class="do">######################################################################</span></span>
<span id="cb7-158"><a href="#cb7-158" tabindex="-1"></a><span class="co">#I added my transformations here only y and x1 using 1/i</span></span>
<span id="cb7-159"><a href="#cb7-159" tabindex="-1"></a><span class="do">#######################################################################</span></span>
<span id="cb7-160"><a href="#cb7-160" tabindex="-1"></a></span>
<span id="cb7-161"><a href="#cb7-161" tabindex="-1"></a> rbdata1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>(<span class="dv">1</span><span class="sc">/</span>Y_i), <span class="at">x1=</span><span class="dv">1</span><span class="sc">/</span>(x1), <span class="at">x2=</span>x2 ,<span class="at">x3=</span>x3, <span class="at">x4=</span>x4, <span class="at">x5=</span><span class="dv">1</span><span class="sc">/</span>x5, <span class="at">x6=</span>x6, <span class="at">x7=</span>x7, <span class="at">x8=</span>x8<span class="sc">^</span><span class="dv">3</span>, <span class="at">x9=</span>(x9), <span class="at">x10=</span>(x10)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-162"><a href="#cb7-162" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb7-163"><a href="#cb7-163" tabindex="-1"></a> </span>
<span id="cb7-164"><a href="#cb7-164" tabindex="-1"></a></span>
<span id="cb7-165"><a href="#cb7-165" tabindex="-1"></a></span>
<span id="cb7-166"><a href="#cb7-166" tabindex="-1"></a></span>
<span id="cb7-167"><a href="#cb7-167" tabindex="-1"></a> <span class="co">#Now fit your model to make sure it comes out significant:</span></span>
<span id="cb7-168"><a href="#cb7-168" tabindex="-1"></a></span>
<span id="cb7-169"><a href="#cb7-169" tabindex="-1"></a><span class="do">############################################################################</span></span>
<span id="cb7-170"><a href="#cb7-170" tabindex="-1"></a><span class="co">#My model is significant when untransformed; I&#39;d have to untransform my columns and then do the lm. it has .97 R^2 and *&#39;s in all p values</span></span>
<span id="cb7-171"><a href="#cb7-171" tabindex="-1"></a><span class="do">#############################################################################</span></span>
<span id="cb7-172"><a href="#cb7-172" tabindex="-1"></a></span>
<span id="cb7-173"><a href="#cb7-173" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb7-174"><a href="#cb7-174" tabindex="-1"></a><span class="do">## These are all the anti transformations needed ##</span></span>
<span id="cb7-175"><a href="#cb7-175" tabindex="-1"></a><span class="do">##################################################</span></span>
<span id="cb7-176"><a href="#cb7-176" tabindex="-1"></a></span>
<span id="cb7-177"><a href="#cb7-177" tabindex="-1"></a>rbdata1<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>y)     </span>
<span id="cb7-178"><a href="#cb7-178" tabindex="-1"></a>rbdata1<span class="sc">$</span>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>x1)</span>
<span id="cb7-179"><a href="#cb7-179" tabindex="-1"></a></span>
<span id="cb7-180"><a href="#cb7-180" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb7-181"><a href="#cb7-181" tabindex="-1"></a>             </span>
<span id="cb7-182"><a href="#cb7-182" tabindex="-1"></a>  x2 <span class="sc">+</span> x1<span class="sc">:</span>x2 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x2 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">3</span>)<span class="sc">:</span>x2  <span class="sc">+</span> </span>
<span id="cb7-183"><a href="#cb7-183" tabindex="-1"></a>    </span>
<span id="cb7-184"><a href="#cb7-184" tabindex="-1"></a>    x2<span class="sc">:</span>x3 <span class="sc">+</span> x1<span class="sc">:</span>x2<span class="sc">:</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">3</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">4</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3 <span class="sc">+</span></span>
<span id="cb7-185"><a href="#cb7-185" tabindex="-1"></a>    </span>
<span id="cb7-186"><a href="#cb7-186" tabindex="-1"></a>    x2<span class="sc">:</span>x3<span class="sc">:</span>x4 <span class="sc">+</span> x1<span class="sc">:</span>x2<span class="sc">:</span>x3<span class="sc">:</span>x4 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3<span class="sc">:</span>x4  <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">3</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3<span class="sc">:</span>x4 <span class="sc">+</span></span>
<span id="cb7-187"><a href="#cb7-187" tabindex="-1"></a>    </span>
<span id="cb7-188"><a href="#cb7-188" tabindex="-1"></a>    x2<span class="sc">:</span>x3<span class="sc">:</span>x4<span class="sc">:</span>x7 <span class="sc">+</span> x1<span class="sc">:</span>x2<span class="sc">:</span>x3<span class="sc">:</span>x4<span class="sc">:</span>x7 <span class="sc">+</span> <span class="fu">I</span>(x1<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x2<span class="sc">:</span>x3<span class="sc">:</span>x4<span class="sc">:</span>x7,</span>
<span id="cb7-189"><a href="#cb7-189" tabindex="-1"></a>              </span>
<span id="cb7-190"><a href="#cb7-190" tabindex="-1"></a>              <span class="at">data =</span> rbdata1)</span>
<span id="cb7-191"><a href="#cb7-191" tabindex="-1"></a></span>
<span id="cb7-192"><a href="#cb7-192" tabindex="-1"></a> <span class="co">#edit this code to be your true model</span></span>
<span id="cb7-193"><a href="#cb7-193" tabindex="-1"></a> <span class="fu">summary</span>(mylm)</span></code></pre></div>
<pre><code>
Call:
lm(formula = y ~ x1 + I(x1^2) + x2 + x1:x2 + I(x1^2):x2 + I(x1^3):x2 + 
    x2:x3 + x1:x2:x3 + I(x1^2):x2:x3 + I(x1^3):x2:x3 + I(x1^4):x2:x3 + 
    x2:x3:x4 + x1:x2:x3:x4 + I(x1^2):x2:x3:x4 + I(x1^3):x2:x3:x4 + 
    x2:x3:x4:x7 + x1:x2:x3:x4:x7 + I(x1^2):x2:x3:x4:x7, data = rbdata1)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.180654 -0.030371  0.003631  0.030518  0.146469 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         -3.998429   0.006810 -587.12   &lt;2e-16 ***
x1                   1.304312   0.012022  108.50   &lt;2e-16 ***
I(x1^2)              0.594526   0.007260   81.89   &lt;2e-16 ***
x2                   7.298180   0.010320  707.17   &lt;2e-16 ***
x1:x2                2.201367   0.017855  123.29   &lt;2e-16 ***
I(x1^2):x2          -0.797888   0.007812 -102.13   &lt;2e-16 ***
x2:I(x1^3)          -0.201652   0.002100  -96.05   &lt;2e-16 ***
x2:x3               -4.704924   0.019061 -246.84   &lt;2e-16 ***
x1:x2:x3            -3.298426   0.026433 -124.78   &lt;2e-16 ***
I(x1^2):x2:x3        1.015687   0.017432   58.27   &lt;2e-16 ***
x2:I(x1^3):x3        0.784375   0.015539   50.48   &lt;2e-16 ***
x2:x3:I(x1^4)       -0.196453   0.004585  -42.85   &lt;2e-16 ***
x2:x3:x4             2.211406   0.020363  108.60   &lt;2e-16 ***
x1:x2:x3:x4          2.087918   0.034083   61.26   &lt;2e-16 ***
I(x1^2):x2:x3:x4    -2.260970   0.068478  -33.02   &lt;2e-16 ***
x2:I(x1^3):x3:x4     0.649589   0.057141   11.37   &lt;2e-16 ***
x2:x3:x4:x7         -1.309712   0.011768 -111.29   &lt;2e-16 ***
x1:x2:x3:x4:x7      -0.908894   0.034754  -26.15   &lt;2e-16 ***
I(x1^2):x2:x3:x4:x7  2.446475   0.042568   57.47   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.04872 on 338 degrees of freedom
Multiple R-squared:  0.9998,    Adjusted R-squared:  0.9998 
F-statistic: 1.037e+05 on 18 and 338 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a> <span class="co">#all p-values must be significant</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a> <span class="co">#the R^2 value must be greater than or equal to 0.30.</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#Retransforming before writing CSV</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="do">###################</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a> </span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a> rbdata1<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>y)    </span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a> rbdata1<span class="sc">$</span>x1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>x1)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co"># Once you are done with creating your model, and have successfully</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co"># graphed it (see below), un-comment the following `write.csv` code,</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co"># then, PLAY this ENTIRE R-chunk to write your data to a csv.</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="do">#############################################</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co"># Here I change the columns orders and names</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="do">#############################################</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a> rbdata1 <span class="ot">&lt;-</span> rbdata1 <span class="sc">%&gt;%</span> </span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>   <span class="fu">rename</span>(<span class="at">x8 =</span> x1,</span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>          <span class="at">x1 =</span> x2,</span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>          <span class="at">x7 =</span> x3,</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>          <span class="at">x10 =</span> x4,</span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a>          <span class="at">x3 =</span> x7,</span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>          <span class="at">x2 =</span> x8,</span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a>          <span class="at">x4 =</span> x10) <span class="sc">%&gt;%</span> </span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a>   <span class="fu">select</span>(</span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a>     y,x1,x2,x3,x4,x5,</span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a>     x6,x7,x8,x9,x10) <span class="sc">%&gt;%</span> </span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a> </span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a> </span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#write.csv(rbdata1, &quot;rbdata1.csv&quot;, row.names=FALSE)</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co"># The above code writes the dataset to your &quot;current directory&quot;</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co"># # To see where that is, use: getwd() in your Console.</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co"># # Find the rbdata.csv data set and upload it to I-Learn.</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#  rbdata1$y &lt;- 1/(rbdata1$y)     </span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="co">#  rbdata1$x8 &lt;- 1/(rbdata1$x8)</span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co"># # ggplot(rbdata1, aes(x8,y))+</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="co"># #   geom_point()</span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="co"># pairs(rbdata1, panel=panel.smooth)</span></span></code></pre></div>
<p><code>This is how it'd look like after column name changes. Transform first, then:</code></p>
<p><br></p>
<p><code>mylm &lt;- lm(y ~ x8 + I(x8^2) +</code></p>
<p><code>x 1+ x8:x1 + I(x8^2):x1 + I(x8^3):x1 +</code></p>
<p><code>x1:x7 + x8:x1:x7 + I(x8^2):x1:x7 + I(x8^3):x1:x7 + I(x8^4):x1:x7 +</code></p>
<p><code>x1:x7:x10 + x8:x1:x7:x10 + I(x8^2):x1:x7:x10 + I(x8^4):x1:x7:x10 +</code></p>
<p><code>x1:x7:x10:x3 + x8:x1:x7:x10:x3 + I(x8^2):x1:x7:x10:x3,</code></p>
<p><code>data = rbdata1)</code></p>
<p><br><br></p>
</div>
<div id="math-model" class="section level2">
<h2>Math Model</h2>
<p>In case you are curious about the mathematical equation used for this
model:</p>
<p><br></p>
<p><span class="math display">\[
This \ is \ my \ actual \ formula \ before \ column \ names \ changes
\]</span> <br></p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 \, x_1 + \beta_2 \, x_1^2 + \\
  \beta_3 \, x_2 + \beta_4 \, x_1 \, x_2 + \beta_5 \, x_1^2 \, x_2 +
\beta_6 \, x_1^3 \, x_2 \\  \beta_8 \, x_2 \, x_3 + \beta_9 \, x_1 \,
x_2 \, x_3 + \beta_{10} \, x_1^2 \, x_2 \, x_3 + \beta_{11} \, x_1^3 \,
x_2 \, x_3 + \beta_{12} \, x_1^4 \, x_2 \, x_3 + \\  \beta_{13} \, x_2
\, x_3 \, x_4 + \beta_{14} \, x_1 \, x_2 \, x_3 \, x_4 + \beta_{15} \,
x_1^2 \, x_2 \, x_3 \, x_4 + \beta_{17} \, x_1^3 \, x_2 \, x_3 \, x_4 +
\\  \beta_{18} \, x_2 \, x_3 \, x_4 \, x_7 + \beta_{19} \, x_1 \, x_2 \,
x_3 \, x_4 \, x_7 + \beta_{20} \, x_1^2 \, x_2 \, x_3 \, x_4 \, x_7 \\\
\\
\]</span></p>
<p><span class="math display">\[
This \ would \ be \ after \ column \ re-arrengements
\]</span> <br></p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 \, x_8 + \beta_2 \, x_8^2 + \\ \beta_3 \, x_1 +
\beta_4 \, x_8 \, x_1 + \beta_5 \, x_8^2 \, x_1 + \beta_6 \, x_8^3 \,
x_1 \\ \beta_8 \, x_1 \, x_3 + \beta_9 \, x_8 \, x_1 \, x_7 + \beta_{10}
\, x_8^2 \, x_1 \, x_7 + \beta_{11} \, x_8^3 \, x_1 \, x_7 + \beta_{12}
\, x_8^4 \, x_1 \, x_7 + \\ \beta_{13} \, x_1 \, x_7 \, x_{10} +
\beta_{14} \, x_8 \, x_1 \, x_7 \, x_{10} + \beta_{15} \, x_8^2 \, x_1
\, x_7 \, x_{10} + \beta_{17} \, x_8^3 , x_1 \, x_7 \, x_{10} + \\
\beta_{18} , x_1 \, x_7 \, x_{10}\, x_3 + \beta_{19} \, x_8 \, x_1 \,
x_7 \, x_{10}\, x_3 + \beta_{20} \, x_8^2 \, x_1 \, x_7 \, x_{10}\, x_3
\]</span></p>
<p><br><br></p>
</div>
<div id="results" class="section level2">
<h2>Results</h2>
<p>Once the Regression Battleship competition was completed, we compared
the summary of our guesses. Whoever got the highest R<sup>2</sup> would
win!</p>
<p>Check out the pictures below, the first one is my original model
(What they were supposed to get), the second one is what one of them
guessed (It was the closest one).</p>
<p>The players’ names are private.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">15</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">404</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>(.<span class="dv">3</span>,.<span class="dv">6</span>,.<span class="dv">1</span>))</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>( .<span class="dv">4</span>,.<span class="dv">4</span>))</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), n, <span class="at">replace =</span> T, <span class="at">prob =</span> <span class="fu">c</span>( .<span class="dv">1</span>,.<span class="dv">8</span>))</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">+</span><span class="fu">rnorm</span>(n,<span class="dv">0</span>,.<span class="dv">01</span>)</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n,<span class="dv">15</span>,<span class="dv">1</span>)</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>x7 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>( .<span class="dv">48</span>,.<span class="dv">46</span>,.<span class="dv">03</span>))</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>x8 <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">10</span>,<span class="dv">1</span>)</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>x9 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.01</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, .<span class="dv">5</span>)</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a> </span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">4</span> </span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> <span class="fl">1.3</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a>beta2 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a>beta3 <span class="ot">&lt;-</span> <span class="fl">7.3</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a>beta4 <span class="ot">&lt;-</span> <span class="fl">2.2</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a>beta5 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">8</span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a>beta6 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a>beta7 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a>beta8 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">4.7</span></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a>beta9 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">3.3</span></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a>beta10 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a>beta11 <span class="ot">&lt;-</span> .<span class="dv">8</span></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a>beta12 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a>beta13 <span class="ot">&lt;-</span> <span class="fl">2.2</span></span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a>beta14 <span class="ot">&lt;-</span> <span class="fl">2.1</span></span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a>beta15 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">2.2</span></span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a>beta16 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">8</span></span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a>beta17 <span class="ot">&lt;-</span> .<span class="dv">6</span></span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a>beta18 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">1.3</span></span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a>beta19 <span class="ot">&lt;-</span> <span class="sc">-</span>.<span class="dv">9</span></span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a>beta20 <span class="ot">&lt;-</span> <span class="fl">2.4</span></span>
<span id="cb10-48"><a href="#cb10-48" tabindex="-1"></a></span>
<span id="cb10-49"><a href="#cb10-49" tabindex="-1"></a> </span>
<span id="cb10-50"><a href="#cb10-50" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> .<span class="dv">05</span> <span class="co">#change to whatever positive number you want</span></span>
<span id="cb10-51"><a href="#cb10-51" tabindex="-1"></a></span>
<span id="cb10-52"><a href="#cb10-52" tabindex="-1"></a></span>
<span id="cb10-53"><a href="#cb10-53" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ), <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb10-54"><a href="#cb10-54" tabindex="-1"></a> </span>
<span id="cb10-55"><a href="#cb10-55" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ), <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="fl">1.01</span>)</span>
<span id="cb10-56"><a href="#cb10-56" tabindex="-1"></a></span>
<span id="cb10-57"><a href="#cb10-57" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ), <span class="sc">-</span><span class="fl">3.3</span>, <span class="dv">3</span>)</span>
<span id="cb10-58"><a href="#cb10-58" tabindex="-1"></a></span>
<span id="cb10-59"><a href="#cb10-59" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span>  ), <span class="sc">-</span><span class="fl">1.01</span>, <span class="sc">-</span><span class="fl">1.01</span>)</span>
<span id="cb10-60"><a href="#cb10-60" tabindex="-1"></a></span>
<span id="cb10-61"><a href="#cb10-61" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span>  ), <span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">3.1</span>)</span>
<span id="cb10-62"><a href="#cb10-62" tabindex="-1"></a></span>
<span id="cb10-63"><a href="#cb10-63" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span>), <span class="sc">--</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb10-64"><a href="#cb10-64" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span>), <span class="sc">-</span>.<span class="dv">5</span>, <span class="fl">1.15</span>)</span>
<span id="cb10-66"><a href="#cb10-66" tabindex="-1"></a></span>
<span id="cb10-67"><a href="#cb10-67" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">1</span>), <span class="sc">--</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb10-68"><a href="#cb10-68" tabindex="-1"></a>x1[x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span><span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span> ] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">sum</span>(x2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> x3 <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> x4 <span class="sc">==</span> <span class="dv">0</span>), <span class="dv">1</span>, <span class="fl">1.1</span>)</span>
<span id="cb10-69"><a href="#cb10-69" tabindex="-1"></a></span>
<span id="cb10-70"><a href="#cb10-70" tabindex="-1"></a>epsilon_i <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma) </span>
<span id="cb10-71"><a href="#cb10-71" tabindex="-1"></a></span>
<span id="cb10-72"><a href="#cb10-72" tabindex="-1"></a> </span>
<span id="cb10-73"><a href="#cb10-73" tabindex="-1"></a> Y_i <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1<span class="sc">*</span>x1 <span class="sc">+</span> beta2<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb10-74"><a href="#cb10-74" tabindex="-1"></a>  </span>
<span id="cb10-75"><a href="#cb10-75" tabindex="-1"></a>  beta3<span class="sc">*</span>x2 <span class="sc">+</span> beta4<span class="sc">*</span>x1<span class="sc">*</span>x2 <span class="sc">+</span> beta5<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2 <span class="sc">+</span> beta6<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2 <span class="sc">+</span></span>
<span id="cb10-76"><a href="#cb10-76" tabindex="-1"></a>  </span>
<span id="cb10-77"><a href="#cb10-77" tabindex="-1"></a>    beta8<span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta9<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta10<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta11<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span> beta12<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">4</span><span class="sc">*</span>x2<span class="sc">*</span>x3 <span class="sc">+</span></span>
<span id="cb10-78"><a href="#cb10-78" tabindex="-1"></a>  </span>
<span id="cb10-79"><a href="#cb10-79" tabindex="-1"></a>  beta13<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta14<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta15<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span> beta17<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4 <span class="sc">+</span></span>
<span id="cb10-80"><a href="#cb10-80" tabindex="-1"></a>  </span>
<span id="cb10-81"><a href="#cb10-81" tabindex="-1"></a>  beta18<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x7 <span class="sc">+</span> beta19<span class="sc">*</span>x1<span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x7 <span class="sc">+</span> beta20<span class="sc">*</span>x1<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x2<span class="sc">*</span>x3<span class="sc">*</span>x4<span class="sc">*</span>x7 <span class="sc">+</span></span>
<span id="cb10-82"><a href="#cb10-82" tabindex="-1"></a>  </span>
<span id="cb10-83"><a href="#cb10-83" tabindex="-1"></a>  epsilon_i</span>
<span id="cb10-84"><a href="#cb10-84" tabindex="-1"></a></span>
<span id="cb10-85"><a href="#cb10-85" tabindex="-1"></a>x10 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>Y_i<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb10-86"><a href="#cb10-86" tabindex="-1"></a></span>
<span id="cb10-87"><a href="#cb10-87" tabindex="-1"></a>x5 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">15</span><span class="sc">*</span>x9<span class="sc">*</span>x5<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">rbeta</span>(n,<span class="dv">15</span>,<span class="dv">1</span>)))</span>
<span id="cb10-88"><a href="#cb10-88" tabindex="-1"></a></span>
<span id="cb10-89"><a href="#cb10-89" tabindex="-1"></a>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">15</span><span class="sc">*</span>x9<span class="sc">*</span>x5<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">I</span>(<span class="fu">rbeta</span>(n,<span class="dv">1</span>,<span class="dv">15</span>)))</span>
<span id="cb10-90"><a href="#cb10-90" tabindex="-1"></a></span>
<span id="cb10-91"><a href="#cb10-91" tabindex="-1"></a></span>
<span id="cb10-92"><a href="#cb10-92" tabindex="-1"></a>x9 <span class="ot">&lt;-</span> Y_i <span class="sc">+</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb10-93"><a href="#cb10-93" tabindex="-1"></a></span>
<span id="cb10-94"><a href="#cb10-94" tabindex="-1"></a>x6 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), n, <span class="at">replace =</span> T, <span class="at">prob=</span><span class="fu">c</span>( .<span class="dv">48</span>,.<span class="dv">001</span> ,.<span class="dv">47</span>))</span>
<span id="cb10-95"><a href="#cb10-95" tabindex="-1"></a></span>
<span id="cb10-96"><a href="#cb10-96" tabindex="-1"></a> rbdata2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">y=</span>(<span class="dv">1</span><span class="sc">/</span>Y_i), <span class="at">x1=</span><span class="dv">1</span><span class="sc">/</span>(x1), <span class="at">x2=</span>x2 ,<span class="at">x3=</span>x3, <span class="at">x4=</span>x4, <span class="at">x5=</span><span class="dv">1</span><span class="sc">/</span>x5, <span class="at">x6=</span>x6, <span class="at">x7=</span>x7, <span class="at">x8=</span>x8<span class="sc">^</span><span class="dv">3</span>, <span class="at">x9=</span>(x9), <span class="at">x10=</span>(x10)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-97"><a href="#cb10-97" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb10-98"><a href="#cb10-98" tabindex="-1"></a></span>
<span id="cb10-99"><a href="#cb10-99" tabindex="-1"></a></span>
<span id="cb10-100"><a href="#cb10-100" tabindex="-1"></a>dt <span class="ot">&lt;-</span> rbdata2 <span class="sc">%&gt;%</span> </span>
<span id="cb10-101"><a href="#cb10-101" tabindex="-1"></a>   <span class="fu">rename</span>(<span class="at">x8 =</span> x1,</span>
<span id="cb10-102"><a href="#cb10-102" tabindex="-1"></a>          <span class="at">x1 =</span> x2,</span>
<span id="cb10-103"><a href="#cb10-103" tabindex="-1"></a>          <span class="at">x7 =</span> x3,</span>
<span id="cb10-104"><a href="#cb10-104" tabindex="-1"></a>          <span class="at">x10 =</span> x4,</span>
<span id="cb10-105"><a href="#cb10-105" tabindex="-1"></a>          <span class="at">x3 =</span> x7,</span>
<span id="cb10-106"><a href="#cb10-106" tabindex="-1"></a>          <span class="at">x2 =</span> x8,</span>
<span id="cb10-107"><a href="#cb10-107" tabindex="-1"></a>          <span class="at">x4 =</span> x10) <span class="sc">%&gt;%</span> </span>
<span id="cb10-108"><a href="#cb10-108" tabindex="-1"></a>   <span class="fu">select</span>(</span>
<span id="cb10-109"><a href="#cb10-109" tabindex="-1"></a>     y,x1,x2,x3,x4,x5,</span>
<span id="cb10-110"><a href="#cb10-110" tabindex="-1"></a>     x6,x7,x8,x9,x10) <span class="sc">%&gt;%</span> </span>
<span id="cb10-111"><a href="#cb10-111" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb10-112"><a href="#cb10-112" tabindex="-1"></a></span>
<span id="cb10-113"><a href="#cb10-113" tabindex="-1"></a><span class="do">##################################################################</span></span>
<span id="cb10-114"><a href="#cb10-114" tabindex="-1"></a></span>
<span id="cb10-115"><a href="#cb10-115" tabindex="-1"></a><span class="do">#################################################################</span></span>
<span id="cb10-116"><a href="#cb10-116" tabindex="-1"></a></span>
<span id="cb10-117"><a href="#cb10-117" tabindex="-1"></a><span class="co">#Hans</span></span>
<span id="cb10-118"><a href="#cb10-118" tabindex="-1"></a></span>
<span id="cb10-119"><a href="#cb10-119" tabindex="-1"></a></span>
<span id="cb10-120"><a href="#cb10-120" tabindex="-1"></a>dt1 <span class="ot">&lt;-</span> rbdata1 <span class="sc">%&gt;%</span></span>
<span id="cb10-121"><a href="#cb10-121" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-122"><a href="#cb10-122" tabindex="-1"></a>    <span class="at">s1 =</span> <span class="fu">ifelse</span>(x1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x3<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> x6<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> x7<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x10<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb10-123"><a href="#cb10-123" tabindex="-1"></a>    <span class="at">s2 =</span> <span class="fu">ifelse</span>(x1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x3<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x6<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> x7<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x10<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb10-124"><a href="#cb10-124" tabindex="-1"></a>    <span class="at">s3 =</span> <span class="fu">ifelse</span>(x1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x3<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> x6<span class="sc">==</span><span class="dv">2</span> <span class="sc">&amp;</span> x7<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x10<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb10-125"><a href="#cb10-125" tabindex="-1"></a>    <span class="at">s4 =</span> <span class="fu">ifelse</span>(x1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x3<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x6<span class="sc">==</span><span class="dv">2</span> <span class="sc">&amp;</span> x7<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x10<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb10-126"><a href="#cb10-126" tabindex="-1"></a>  )</span>
<span id="cb10-127"><a href="#cb10-127" tabindex="-1"></a></span>
<span id="cb10-128"><a href="#cb10-128" tabindex="-1"></a>hlm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x4<span class="sc">+</span></span>
<span id="cb10-129"><a href="#cb10-129" tabindex="-1"></a>                s1<span class="sc">+</span>s1<span class="sc">:</span>x4<span class="sc">+</span></span>
<span id="cb10-130"><a href="#cb10-130" tabindex="-1"></a>                s2<span class="sc">:</span>x4<span class="sc">+</span>s2<span class="sc">:</span><span class="fu">I</span>(x4<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb10-131"><a href="#cb10-131" tabindex="-1"></a>                s3<span class="sc">+</span>s3<span class="sc">:</span>x4<span class="sc">+</span></span>
<span id="cb10-132"><a href="#cb10-132" tabindex="-1"></a>                s4<span class="sc">:</span>x4</span>
<span id="cb10-133"><a href="#cb10-133" tabindex="-1"></a>              , <span class="at">data =</span> dt1)</span>
<span id="cb10-134"><a href="#cb10-134" tabindex="-1"></a></span>
<span id="cb10-135"><a href="#cb10-135" tabindex="-1"></a></span>
<span id="cb10-136"><a href="#cb10-136" tabindex="-1"></a>dt2 <span class="ot">&lt;-</span> dt <span class="sc">%&gt;%</span></span>
<span id="cb10-137"><a href="#cb10-137" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-138"><a href="#cb10-138" tabindex="-1"></a>    <span class="at">s1 =</span> <span class="fu">ifelse</span>(x1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x3<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> x6<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> x7<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x10<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb10-139"><a href="#cb10-139" tabindex="-1"></a>    <span class="at">s2 =</span> <span class="fu">ifelse</span>(x1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x3<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x6<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> x7<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x10<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb10-140"><a href="#cb10-140" tabindex="-1"></a>    <span class="at">s3 =</span> <span class="fu">ifelse</span>(x1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x3<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> x6<span class="sc">==</span><span class="dv">2</span> <span class="sc">&amp;</span> x7<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x10<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb10-141"><a href="#cb10-141" tabindex="-1"></a>    <span class="at">s4 =</span> <span class="fu">ifelse</span>(x1<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x3<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x6<span class="sc">==</span><span class="dv">2</span> <span class="sc">&amp;</span> x7<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> x10<span class="sc">==</span><span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb10-142"><a href="#cb10-142" tabindex="-1"></a>  )</span>
<span id="cb10-143"><a href="#cb10-143" tabindex="-1"></a></span>
<span id="cb10-144"><a href="#cb10-144" tabindex="-1"></a>  yhc <span class="ot">&lt;-</span> <span class="fu">predict</span>(hlm, <span class="at">newdata=</span>dt2)</span>
<span id="cb10-145"><a href="#cb10-145" tabindex="-1"></a>  ybarc <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt2<span class="sc">$</span>y) </span>
<span id="cb10-146"><a href="#cb10-146" tabindex="-1"></a>  SSTOc <span class="ot">&lt;-</span> <span class="fu">sum</span>( (dt2<span class="sc">$</span>y <span class="sc">-</span> ybarc)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb10-147"><a href="#cb10-147" tabindex="-1"></a>  SSEc <span class="ot">&lt;-</span> <span class="fu">sum</span>( (dt2<span class="sc">$</span>y <span class="sc">-</span> yhc)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb10-148"><a href="#cb10-148" tabindex="-1"></a>  </span>
<span id="cb10-149"><a href="#cb10-149" tabindex="-1"></a></span>
<span id="cb10-150"><a href="#cb10-150" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb10-151"><a href="#cb10-151" tabindex="-1"></a></span>
<span id="cb10-152"><a href="#cb10-152" tabindex="-1"></a><span class="co">#youbin</span></span>
<span id="cb10-153"><a href="#cb10-153" tabindex="-1"></a></span>
<span id="cb10-154"><a href="#cb10-154" tabindex="-1"></a>ylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x4 <span class="sc">+</span> x5<span class="sc">:</span>x4<span class="sc">:</span>x9 <span class="sc">+</span> x4<span class="sc">:</span>x7 <span class="sc">+</span> x4<span class="sc">:</span>x3 <span class="sc">+</span>x4<span class="sc">:</span><span class="fu">I</span>(x6<span class="sc">^</span><span class="dv">4</span>), <span class="at">data =</span> rbdata1)</span>
<span id="cb10-155"><a href="#cb10-155" tabindex="-1"></a></span>
<span id="cb10-156"><a href="#cb10-156" tabindex="-1"></a></span>
<span id="cb10-157"><a href="#cb10-157" tabindex="-1"></a>  yhcc <span class="ot">&lt;-</span> <span class="fu">predict</span>(ylm, <span class="at">newdata=</span>dt)</span>
<span id="cb10-158"><a href="#cb10-158" tabindex="-1"></a>  ybarcc <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>y) </span>
<span id="cb10-159"><a href="#cb10-159" tabindex="-1"></a>  SSTOcc <span class="ot">&lt;-</span> <span class="fu">sum</span>( (dt<span class="sc">$</span>y <span class="sc">-</span> ybarcc)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb10-160"><a href="#cb10-160" tabindex="-1"></a>  SSEcc <span class="ot">&lt;-</span> <span class="fu">sum</span>( (dt<span class="sc">$</span>y <span class="sc">-</span> yhcc)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb10-161"><a href="#cb10-161" tabindex="-1"></a>  </span>
<span id="cb10-162"><a href="#cb10-162" tabindex="-1"></a></span>
<span id="cb10-163"><a href="#cb10-163" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb10-164"><a href="#cb10-164" tabindex="-1"></a></span>
<span id="cb10-165"><a href="#cb10-165" tabindex="-1"></a><span class="co">#B Saunders</span></span>
<span id="cb10-166"><a href="#cb10-166" tabindex="-1"></a></span>
<span id="cb10-167"><a href="#cb10-167" tabindex="-1"></a> rbdata1<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>y)     </span>
<span id="cb10-168"><a href="#cb10-168" tabindex="-1"></a> rbdata1<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>x8)</span>
<span id="cb10-169"><a href="#cb10-169" tabindex="-1"></a></span>
<span id="cb10-170"><a href="#cb10-170" tabindex="-1"></a>bsalm <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x7 <span class="sc">+</span> x3 <span class="sc">+</span> x8 <span class="sc">+</span> <span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x1<span class="sc">:</span>x7 <span class="sc">+</span> x1<span class="sc">:</span>x3 <span class="sc">+</span> </span>
<span id="cb10-171"><a href="#cb10-171" tabindex="-1"></a>    x7<span class="sc">:</span>x10 <span class="sc">+</span> x3<span class="sc">:</span>x10 <span class="sc">+</span> x1<span class="sc">:</span>x8 <span class="sc">+</span> x7<span class="sc">:</span>x8 <span class="sc">+</span> x3<span class="sc">:</span>x8 <span class="sc">+</span> x1<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x7<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb10-172"><a href="#cb10-172" tabindex="-1"></a>    x3<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x1<span class="sc">:</span>x7<span class="sc">:</span>x3 <span class="sc">+</span> x1<span class="sc">:</span>x7<span class="sc">:</span>x10 <span class="sc">+</span> x1<span class="sc">:</span>x3<span class="sc">:</span>x10 <span class="sc">+</span> x1<span class="sc">:</span>x7<span class="sc">:</span>x8 <span class="sc">+</span> </span>
<span id="cb10-173"><a href="#cb10-173" tabindex="-1"></a>    x1<span class="sc">:</span>x3<span class="sc">:</span>x8 <span class="sc">+</span> x7<span class="sc">:</span>x3<span class="sc">:</span>x8 <span class="sc">+</span> x7<span class="sc">:</span>x10<span class="sc">:</span>x8 <span class="sc">+</span> x3<span class="sc">:</span>x10<span class="sc">:</span>x8 <span class="sc">+</span> x1<span class="sc">:</span>x7<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb10-174"><a href="#cb10-174" tabindex="-1"></a>    x1<span class="sc">:</span>x3<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x7<span class="sc">:</span>x3<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x7<span class="sc">:</span>x10<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x3<span class="sc">:</span>x10<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb10-175"><a href="#cb10-175" tabindex="-1"></a>    x1<span class="sc">:</span>x8<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x7<span class="sc">:</span>x8<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x3<span class="sc">:</span>x8<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x1<span class="sc">:</span>x7<span class="sc">:</span>x3<span class="sc">:</span>x10 <span class="sc">+</span> </span>
<span id="cb10-176"><a href="#cb10-176" tabindex="-1"></a>    x1<span class="sc">:</span>x7<span class="sc">:</span>x3<span class="sc">:</span>x8 <span class="sc">+</span> x1<span class="sc">:</span>x7<span class="sc">:</span>x10<span class="sc">:</span>x8 <span class="sc">+</span> x1<span class="sc">:</span>x3<span class="sc">:</span>x10<span class="sc">:</span>x8 <span class="sc">+</span> x7<span class="sc">:</span>x3<span class="sc">:</span>x10<span class="sc">:</span>x8 <span class="sc">+</span> </span>
<span id="cb10-177"><a href="#cb10-177" tabindex="-1"></a>    x1<span class="sc">:</span>x7<span class="sc">:</span>x3<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x1<span class="sc">:</span>x7<span class="sc">:</span>x10<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x1<span class="sc">:</span>x3<span class="sc">:</span>x10<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb10-178"><a href="#cb10-178" tabindex="-1"></a>    x7<span class="sc">:</span>x3<span class="sc">:</span>x10<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x1<span class="sc">:</span>x7<span class="sc">:</span>x8<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x1<span class="sc">:</span>x3<span class="sc">:</span>x8<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb10-179"><a href="#cb10-179" tabindex="-1"></a>    x7<span class="sc">:</span>x10<span class="sc">:</span>x8<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x3<span class="sc">:</span>x10<span class="sc">:</span>x8<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x1<span class="sc">:</span>x7<span class="sc">:</span>x3<span class="sc">:</span>x10<span class="sc">:</span>x8 <span class="sc">+</span> </span>
<span id="cb10-180"><a href="#cb10-180" tabindex="-1"></a>    x1<span class="sc">:</span>x7<span class="sc">:</span>x10<span class="sc">:</span>x8<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> x1<span class="sc">:</span>x3<span class="sc">:</span>x10<span class="sc">:</span>x8<span class="sc">:</span><span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> rbdata1)</span>
<span id="cb10-181"><a href="#cb10-181" tabindex="-1"></a></span>
<span id="cb10-182"><a href="#cb10-182" tabindex="-1"></a> rbdata1<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>y)     </span>
<span id="cb10-183"><a href="#cb10-183" tabindex="-1"></a> rbdata1<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>x8)</span>
<span id="cb10-184"><a href="#cb10-184" tabindex="-1"></a> </span>
<span id="cb10-185"><a href="#cb10-185" tabindex="-1"></a> </span>
<span id="cb10-186"><a href="#cb10-186" tabindex="-1"></a> dt<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>y)     </span>
<span id="cb10-187"><a href="#cb10-187" tabindex="-1"></a> dt<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>x8)</span>
<span id="cb10-188"><a href="#cb10-188" tabindex="-1"></a> </span>
<span id="cb10-189"><a href="#cb10-189" tabindex="-1"></a>  yhs <span class="ot">&lt;-</span> <span class="fu">predict</span>(bsalm, <span class="at">newdata=</span>dt)</span>
<span id="cb10-190"><a href="#cb10-190" tabindex="-1"></a>  ybars <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>y) </span>
<span id="cb10-191"><a href="#cb10-191" tabindex="-1"></a>  SSTOs <span class="ot">&lt;-</span> <span class="fu">sum</span>( (dt<span class="sc">$</span>y <span class="sc">-</span> ybars)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb10-192"><a href="#cb10-192" tabindex="-1"></a>  SSEs <span class="ot">&lt;-</span> <span class="fu">sum</span>( (dt<span class="sc">$</span>y <span class="sc">-</span> yhs)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb10-193"><a href="#cb10-193" tabindex="-1"></a>  </span>
<span id="cb10-194"><a href="#cb10-194" tabindex="-1"></a>  </span>
<span id="cb10-195"><a href="#cb10-195" tabindex="-1"></a>  dt<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>y)     </span>
<span id="cb10-196"><a href="#cb10-196" tabindex="-1"></a> dt<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>x8)</span>
<span id="cb10-197"><a href="#cb10-197" tabindex="-1"></a></span>
<span id="cb10-198"><a href="#cb10-198" tabindex="-1"></a><span class="do">#################################################</span></span>
<span id="cb10-199"><a href="#cb10-199" tabindex="-1"></a></span>
<span id="cb10-200"><a href="#cb10-200" tabindex="-1"></a><span class="co">#mine</span></span>
<span id="cb10-201"><a href="#cb10-201" tabindex="-1"></a></span>
<span id="cb10-202"><a href="#cb10-202" tabindex="-1"></a> rbdata1<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>y)     </span>
<span id="cb10-203"><a href="#cb10-203" tabindex="-1"></a> rbdata1<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>x8)</span>
<span id="cb10-204"><a href="#cb10-204" tabindex="-1"></a></span>
<span id="cb10-205"><a href="#cb10-205" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x8 <span class="sc">+</span> <span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb10-206"><a href="#cb10-206" tabindex="-1"></a>             </span>
<span id="cb10-207"><a href="#cb10-207" tabindex="-1"></a>  x1 <span class="sc">+</span> x8<span class="sc">:</span>x1 <span class="sc">+</span> <span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x1 <span class="sc">+</span> <span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">3</span>)<span class="sc">:</span>x1  <span class="sc">+</span> </span>
<span id="cb10-208"><a href="#cb10-208" tabindex="-1"></a>    </span>
<span id="cb10-209"><a href="#cb10-209" tabindex="-1"></a>    x1<span class="sc">:</span>x7 <span class="sc">+</span> x8<span class="sc">:</span>x1<span class="sc">:</span>x7 <span class="sc">+</span> <span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x1<span class="sc">:</span>x7 <span class="sc">+</span> <span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">3</span>)<span class="sc">:</span>x1<span class="sc">:</span>x7 <span class="sc">+</span> <span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">4</span>)<span class="sc">:</span>x1<span class="sc">:</span>x7 <span class="sc">+</span></span>
<span id="cb10-210"><a href="#cb10-210" tabindex="-1"></a>    </span>
<span id="cb10-211"><a href="#cb10-211" tabindex="-1"></a>    x1<span class="sc">:</span>x7<span class="sc">:</span>x10 <span class="sc">+</span> x8<span class="sc">:</span>x1<span class="sc">:</span>x7<span class="sc">:</span>x10 <span class="sc">+</span> <span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x1<span class="sc">:</span>x7<span class="sc">:</span>x10  <span class="sc">+</span> <span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">3</span>)<span class="sc">:</span>x1<span class="sc">:</span>x7<span class="sc">:</span>x10 <span class="sc">+</span></span>
<span id="cb10-212"><a href="#cb10-212" tabindex="-1"></a>    </span>
<span id="cb10-213"><a href="#cb10-213" tabindex="-1"></a>    x1<span class="sc">:</span>x7<span class="sc">:</span>x10<span class="sc">:</span>x3 <span class="sc">+</span> x8<span class="sc">:</span>x1<span class="sc">:</span>x7<span class="sc">:</span>x10<span class="sc">:</span>x3 <span class="sc">+</span> <span class="fu">I</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>x1<span class="sc">:</span>x7<span class="sc">:</span>x10<span class="sc">:</span>x3,</span>
<span id="cb10-214"><a href="#cb10-214" tabindex="-1"></a>              </span>
<span id="cb10-215"><a href="#cb10-215" tabindex="-1"></a>              <span class="at">data =</span> rbdata1)</span>
<span id="cb10-216"><a href="#cb10-216" tabindex="-1"></a></span>
<span id="cb10-217"><a href="#cb10-217" tabindex="-1"></a> rbdata1<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>y)     </span>
<span id="cb10-218"><a href="#cb10-218" tabindex="-1"></a> rbdata1<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(rbdata1<span class="sc">$</span>x8)</span>
<span id="cb10-219"><a href="#cb10-219" tabindex="-1"></a></span>
<span id="cb10-220"><a href="#cb10-220" tabindex="-1"></a> dt<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>y)     </span>
<span id="cb10-221"><a href="#cb10-221" tabindex="-1"></a> dt<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>x8)</span>
<span id="cb10-222"><a href="#cb10-222" tabindex="-1"></a> </span>
<span id="cb10-223"><a href="#cb10-223" tabindex="-1"></a>  yht <span class="ot">&lt;-</span> <span class="fu">predict</span>(mylm, <span class="at">newdata=</span>dt)</span>
<span id="cb10-224"><a href="#cb10-224" tabindex="-1"></a>  ybart <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>y) </span>
<span id="cb10-225"><a href="#cb10-225" tabindex="-1"></a>  SSTOt <span class="ot">&lt;-</span> <span class="fu">sum</span>( (dt<span class="sc">$</span>y <span class="sc">-</span> ybart)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb10-226"><a href="#cb10-226" tabindex="-1"></a>  SSEt <span class="ot">&lt;-</span> <span class="fu">sum</span>( (dt<span class="sc">$</span>y <span class="sc">-</span> yht)<span class="sc">^</span><span class="dv">2</span> )</span>
<span id="cb10-227"><a href="#cb10-227" tabindex="-1"></a>  </span>
<span id="cb10-228"><a href="#cb10-228" tabindex="-1"></a>  dt<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>y)     </span>
<span id="cb10-229"><a href="#cb10-229" tabindex="-1"></a> dt<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>x8)</span>
<span id="cb10-230"><a href="#cb10-230" tabindex="-1"></a></span>
<span id="cb10-231"><a href="#cb10-231" tabindex="-1"></a></span>
<span id="cb10-232"><a href="#cb10-232" tabindex="-1"></a><span class="do">####################################################</span></span>
<span id="cb10-233"><a href="#cb10-233" tabindex="-1"></a> </span>
<span id="cb10-234"><a href="#cb10-234" tabindex="-1"></a><span class="do">################## validation</span></span>
<span id="cb10-235"><a href="#cb10-235" tabindex="-1"></a>  </span>
<span id="cb10-236"><a href="#cb10-236" tabindex="-1"></a>  <span class="co"># Compute R-squared for each</span></span>
<span id="cb10-237"><a href="#cb10-237" tabindex="-1"></a>  rst <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSEt<span class="sc">/</span>SSTOt</span>
<span id="cb10-238"><a href="#cb10-238" tabindex="-1"></a>  rss <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSEs<span class="sc">/</span>SSTOs</span>
<span id="cb10-239"><a href="#cb10-239" tabindex="-1"></a>  rsc <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSEc<span class="sc">/</span>SSTOc</span>
<span id="cb10-240"><a href="#cb10-240" tabindex="-1"></a>  rscc <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> SSEcc<span class="sc">/</span>SSTOcc</span>
<span id="cb10-241"><a href="#cb10-241" tabindex="-1"></a>  <span class="co"># Compute adjusted R-squared for each</span></span>
<span id="cb10-242"><a href="#cb10-242" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(dt<span class="sc">$</span>y) <span class="co">#sample size</span></span>
<span id="cb10-243"><a href="#cb10-243" tabindex="-1"></a>  pt <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(mylm)) <span class="co">#num. parameters in model</span></span>
<span id="cb10-244"><a href="#cb10-244" tabindex="-1"></a>  ps <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(bsalm))</span>
<span id="cb10-245"><a href="#cb10-245" tabindex="-1"></a>  pc <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(hlm))</span>
<span id="cb10-246"><a href="#cb10-246" tabindex="-1"></a>  pcc  <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(ylm)) <span class="co">#num. parameters in model</span></span>
<span id="cb10-247"><a href="#cb10-247" tabindex="-1"></a>  rsta <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="sc">-</span>pt)<span class="sc">*</span>SSEt<span class="sc">/</span>SSTOt</span>
<span id="cb10-248"><a href="#cb10-248" tabindex="-1"></a>  rssa <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="sc">-</span>ps)<span class="sc">*</span>SSEs<span class="sc">/</span>SSTOs</span>
<span id="cb10-249"><a href="#cb10-249" tabindex="-1"></a>  rsca <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="sc">-</span>pc)<span class="sc">*</span>SSEc<span class="sc">/</span>SSTOc</span>
<span id="cb10-250"><a href="#cb10-250" tabindex="-1"></a>  rscca <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (n<span class="dv">-1</span>)<span class="sc">/</span>(n<span class="sc">-</span>pcc)<span class="sc">*</span>SSEcc<span class="sc">/</span>SSTOcc</span>
<span id="cb10-251"><a href="#cb10-251" tabindex="-1"></a></span>
<span id="cb10-252"><a href="#cb10-252" tabindex="-1"></a>my_output_table2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-253"><a href="#cb10-253" tabindex="-1"></a>  </span>
<span id="cb10-254"><a href="#cb10-254" tabindex="-1"></a>  </span>
<span id="cb10-255"><a href="#cb10-255" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(</span>
<span id="cb10-256"><a href="#cb10-256" tabindex="-1"></a>    </span>
<span id="cb10-257"><a href="#cb10-257" tabindex="-1"></a>    <span class="st">&quot;Tona&quot;</span>, <span class="st">&quot;Person 1&quot;</span>, <span class="st">&quot;Person 2&quot;</span>, <span class="st">&quot;Person 3&quot;</span>),</span>
<span id="cb10-258"><a href="#cb10-258" tabindex="-1"></a>  </span>
<span id="cb10-259"><a href="#cb10-259" tabindex="-1"></a>  <span class="st">`</span><span class="at">Original R2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb10-260"><a href="#cb10-260" tabindex="-1"></a>    </span>
<span id="cb10-261"><a href="#cb10-261" tabindex="-1"></a>    <span class="fu">summary</span>(mylm)<span class="sc">$</span>r.squared,</span>
<span id="cb10-262"><a href="#cb10-262" tabindex="-1"></a>    </span>
<span id="cb10-263"><a href="#cb10-263" tabindex="-1"></a>    <span class="fu">summary</span>(bsalm)<span class="sc">$</span>r.squared, </span>
<span id="cb10-264"><a href="#cb10-264" tabindex="-1"></a>    </span>
<span id="cb10-265"><a href="#cb10-265" tabindex="-1"></a>    <span class="fu">summary</span>(hlm)<span class="sc">$</span>r.squared, </span>
<span id="cb10-266"><a href="#cb10-266" tabindex="-1"></a>    </span>
<span id="cb10-267"><a href="#cb10-267" tabindex="-1"></a>    <span class="fu">summary</span>(ylm)<span class="sc">$</span>r.squared), </span>
<span id="cb10-268"><a href="#cb10-268" tabindex="-1"></a>  </span>
<span id="cb10-269"><a href="#cb10-269" tabindex="-1"></a>  <span class="st">`</span><span class="at">Orig. Adj. R-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb10-270"><a href="#cb10-270" tabindex="-1"></a>    </span>
<span id="cb10-271"><a href="#cb10-271" tabindex="-1"></a>    <span class="fu">summary</span>(mylm)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb10-272"><a href="#cb10-272" tabindex="-1"></a>    </span>
<span id="cb10-273"><a href="#cb10-273" tabindex="-1"></a>    <span class="fu">summary</span>(bsalm)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb10-274"><a href="#cb10-274" tabindex="-1"></a>    </span>
<span id="cb10-275"><a href="#cb10-275" tabindex="-1"></a>    <span class="fu">summary</span>(hlm)<span class="sc">$</span>adj.r.squared,</span>
<span id="cb10-276"><a href="#cb10-276" tabindex="-1"></a>    </span>
<span id="cb10-277"><a href="#cb10-277" tabindex="-1"></a>    <span class="fu">summary</span>(ylm)<span class="sc">$</span>adj.r.squared),</span>
<span id="cb10-278"><a href="#cb10-278" tabindex="-1"></a>  </span>
<span id="cb10-279"><a href="#cb10-279" tabindex="-1"></a>  <span class="st">`</span><span class="at">Validation R-squared</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb10-280"><a href="#cb10-280" tabindex="-1"></a>    </span>
<span id="cb10-281"><a href="#cb10-281" tabindex="-1"></a>    rst, rss, rsc, rscc),</span>
<span id="cb10-282"><a href="#cb10-282" tabindex="-1"></a>  </span>
<span id="cb10-283"><a href="#cb10-283" tabindex="-1"></a>  <span class="st">`</span><span class="at">Validation Adj. R^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb10-284"><a href="#cb10-284" tabindex="-1"></a>    </span>
<span id="cb10-285"><a href="#cb10-285" tabindex="-1"></a>    rsta, rssa, rsca, rscca))</span>
<span id="cb10-286"><a href="#cb10-286" tabindex="-1"></a></span>
<span id="cb10-287"><a href="#cb10-287" tabindex="-1"></a></span>
<span id="cb10-288"><a href="#cb10-288" tabindex="-1"></a></span>
<span id="cb10-289"><a href="#cb10-289" tabindex="-1"></a><span class="fu">colnames</span>(my_output_table2) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb10-290"><a href="#cb10-290" tabindex="-1"></a>  </span>
<span id="cb10-291"><a href="#cb10-291" tabindex="-1"></a>  <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;Original $R^2$&quot;</span>, </span>
<span id="cb10-292"><a href="#cb10-292" tabindex="-1"></a>  </span>
<span id="cb10-293"><a href="#cb10-293" tabindex="-1"></a>  <span class="st">&quot;Original Adj. $R^2$&quot;</span>, </span>
<span id="cb10-294"><a href="#cb10-294" tabindex="-1"></a>  </span>
<span id="cb10-295"><a href="#cb10-295" tabindex="-1"></a>  <span class="st">&quot;Validation $R^2$&quot;</span>, </span>
<span id="cb10-296"><a href="#cb10-296" tabindex="-1"></a>  </span>
<span id="cb10-297"><a href="#cb10-297" tabindex="-1"></a>  <span class="st">&quot;Validation Adj. $R^2$&quot;</span>)</span>
<span id="cb10-298"><a href="#cb10-298" tabindex="-1"></a></span>
<span id="cb10-299"><a href="#cb10-299" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(my_output_table2, <span class="at">escape=</span><span class="cn">TRUE</span>, <span class="at">digits=</span><span class="dv">5</span>)</span></code></pre></div>
<table>
<colgroup>
<col width="10%" />
<col width="18%" />
<col width="24%" />
<col width="20%" />
<col width="26%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="right">Original <span class="math inline">\(R^2\)</span></th>
<th align="right">Original Adj. <span
class="math inline">\(R^2\)</span></th>
<th align="right">Validation <span
class="math inline">\(R^2\)</span></th>
<th align="right">Validation Adj. <span
class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tona</td>
<td align="right">0.99982</td>
<td align="right">0.99981</td>
<td align="right">0.99981</td>
<td align="right">0.99980</td>
</tr>
<tr class="even">
<td align="left">Person 1</td>
<td align="right">0.99974</td>
<td align="right">0.99970</td>
<td align="right">-33.83859</td>
<td align="right">-39.13767</td>
</tr>
<tr class="odd">
<td align="left">Person 2</td>
<td align="right">0.94250</td>
<td align="right">0.94117</td>
<td align="right">-23105.18880</td>
<td align="right">-23636.36555</td>
</tr>
<tr class="even">
<td align="left">Person 3</td>
<td align="right">0.93383</td>
<td align="right">0.93289</td>
<td align="right">-42912.23805</td>
<td align="right">-43523.53774</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="do">#####################################################</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co"># I untransform first before plotting my final model</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="do">#####################################################</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a> dt<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>y)     </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a> dt<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>x8)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(mylm)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(x8, y)) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> F, <span class="fu">aes</span>(<span class="at">col=</span><span class="fu">interaction</span>(x1,x7,x10,x3)), <span class="at">pch=</span><span class="dv">18</span>, <span class="at">cex=</span><span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  <span class="co">#facet_wrap(~interaction(x1,x7,x10,x3))+</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>  </span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>  <span class="co">#geom_vline(xintercept = 0, linetype = &quot;solid&quot;, col=&quot;grey50&quot;) +  </span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  <span class="co">#geom_hline(yintercept = 0, linetype = &quot;solid&quot;, col=&quot;grey50&quot;) +</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>  </span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>  <span class="do">###### Betas</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>  <span class="do">######coefficients</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a> <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>   b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">2</span>]<span class="sc">*</span>x <span class="sc">+</span> b[<span class="dv">3</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>   <span class="at">color =</span> <span class="st">&quot;purple4&quot;</span>,</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>   <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">linewidth=</span>.<span class="dv">57</span>) <span class="sc">+</span>  <span class="co"># base line model</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a> <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>   (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">4</span>]) <span class="sc">+</span> (b[<span class="dv">2</span>] <span class="sc">+</span> b[<span class="dv">5</span>])<span class="sc">*</span>x <span class="sc">+</span> (b[<span class="dv">3</span>]<span class="sc">+</span>b[<span class="dv">6</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (b[<span class="dv">7</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span>,</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a>   <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">linewidth=</span>.<span class="dv">57</span>) <span class="sc">+</span>  <span class="co"># model 2 on</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a> <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a>   (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">4</span>] <span class="sc">+</span> b[<span class="dv">8</span>]) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>   (b[<span class="dv">2</span>]<span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">+</span> b[<span class="dv">9</span>])<span class="sc">*</span>x <span class="sc">+</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a>   (b[<span class="dv">3</span>]<span class="sc">+</span>b[<span class="dv">6</span>]<span class="sc">+</span>b[<span class="dv">10</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a>   (b[<span class="dv">7</span>]<span class="sc">+</span>b[<span class="dv">11</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span><span class="sc">+</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a>   b[<span class="dv">12</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span>,</span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a>   <span class="at">color =</span> <span class="st">&quot;red4&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">linewidth=</span>.<span class="dv">57</span>) <span class="sc">+</span>   <span class="co"># model 3 on</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a>  </span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a>  </span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a> <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a>   (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">4</span>] <span class="sc">+</span> b[<span class="dv">8</span>] <span class="sc">+</span>b[<span class="dv">13</span>]) <span class="sc">+</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a>   (b[<span class="dv">2</span>]<span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">+</span> b[<span class="dv">9</span>]<span class="sc">+</span>b[<span class="dv">14</span>])<span class="sc">*</span>x <span class="sc">+</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a>   (b[<span class="dv">3</span>]<span class="sc">+</span>b[<span class="dv">6</span>]<span class="sc">+</span>b[<span class="dv">10</span>]<span class="sc">+</span>b[<span class="dv">15</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a>   (b[<span class="dv">7</span>]<span class="sc">+</span>b[<span class="dv">11</span>]<span class="sc">+</span>b[<span class="dv">16</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span><span class="sc">+</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a>   b[<span class="dv">12</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span>,</span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a>     <span class="at">color =</span> <span class="st">&quot;green4&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">linewidth=</span>.<span class="dv">57</span>) <span class="sc">+</span>   <span class="co"># model 4 on</span></span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a>  </span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a>  <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x)</span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a>   (b[<span class="dv">1</span>] <span class="sc">+</span> b[<span class="dv">4</span>] <span class="sc">+</span> b[<span class="dv">8</span>] <span class="sc">+</span>b[<span class="dv">13</span>] <span class="sc">+</span>b[<span class="dv">17</span>]) <span class="sc">+</span></span>
<span id="cb11-51"><a href="#cb11-51" tabindex="-1"></a>   (b[<span class="dv">2</span>]<span class="sc">+</span> b[<span class="dv">5</span>]<span class="sc">+</span> b[<span class="dv">9</span>]<span class="sc">+</span>b[<span class="dv">14</span>]<span class="sc">+</span>b[<span class="dv">18</span>])<span class="sc">*</span>x <span class="sc">+</span></span>
<span id="cb11-52"><a href="#cb11-52" tabindex="-1"></a>   (b[<span class="dv">3</span>]<span class="sc">+</span>b[<span class="dv">6</span>]<span class="sc">+</span>b[<span class="dv">10</span>]<span class="sc">+</span>b[<span class="dv">15</span>]<span class="sc">+</span>b[<span class="dv">19</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span></span>
<span id="cb11-53"><a href="#cb11-53" tabindex="-1"></a>   (b[<span class="dv">7</span>]<span class="sc">+</span>b[<span class="dv">11</span>]<span class="sc">+</span>b[<span class="dv">16</span>])<span class="sc">*</span>x<span class="sc">^</span><span class="dv">3</span><span class="sc">+</span></span>
<span id="cb11-54"><a href="#cb11-54" tabindex="-1"></a>   b[<span class="dv">12</span>]<span class="sc">*</span>x<span class="sc">^</span><span class="dv">4</span>,</span>
<span id="cb11-55"><a href="#cb11-55" tabindex="-1"></a>   <span class="at">color =</span> <span class="st">&quot;purple4&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="at">linewidth=</span>.<span class="dv">57</span>) <span class="sc">+</span></span>
<span id="cb11-56"><a href="#cb11-56" tabindex="-1"></a>  </span>
<span id="cb11-57"><a href="#cb11-57" tabindex="-1"></a>  </span>
<span id="cb11-58"><a href="#cb11-58" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Plotted model&quot;</span>,</span>
<span id="cb11-59"><a href="#cb11-59" tabindex="-1"></a>     <span class="at">caption =</span> <span class="st">&quot;This is the wayl&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-60"><a href="#cb11-60" tabindex="-1"></a>  </span>
<span id="cb11-61"><a href="#cb11-61" tabindex="-1"></a>  </span>
<span id="cb11-62"><a href="#cb11-62" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">10</span>))<span class="sc">+</span></span>
<span id="cb11-63"><a href="#cb11-63" tabindex="-1"></a></span>
<span id="cb11-64"><a href="#cb11-64" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb11-65"><a href="#cb11-65" tabindex="-1"></a>  </span>
<span id="cb11-66"><a href="#cb11-66" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb11-67"><a href="#cb11-67" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-68"><a href="#cb11-68" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb11-69"><a href="#cb11-69" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="Whale_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a> dt<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>y)     </span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a> dt<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>x8)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a> dt<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>y)     </span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a> dt<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>x8)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="fu">palette</span>(<span class="fu">c</span>(<span class="st">&quot;skyblue&quot;</span>,<span class="st">&quot;orange&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;purple&quot;</span>,<span class="st">&quot;steelblue&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green3&quot;</span>,<span class="st">&quot;black&quot;</span>))</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x8, <span class="at">data=</span>dt,<span class="at">main =</span><span class="st">&quot;Person 1 Guess at my Model&quot;</span>, <span class="at">col=</span><span class="fu">interaction</span>(x1,x7,x3,x10, <span class="at">drop=</span><span class="cn">TRUE</span>))</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co">#points(bsalm$fit ~ x8, data=dt, col=interaction(x1,x7,x3,x10, drop=TRUE), pch=16, cex=0.5)</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">coef</span>(bsalm)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="co">#gsub(&quot;I&quot;,&quot;&quot;,gsub(&quot;:&quot;,&quot;*&quot;,paste(&quot;b[&quot;, 1:48, &quot;]*&quot;, names(b), collapse=&quot; + &quot;)))</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>drawit <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x1=</span><span class="dv">0</span>, <span class="at">x7=</span><span class="dv">0</span>, <span class="at">x3=</span><span class="dv">0</span>, <span class="at">x10=</span><span class="dv">0</span>, <span class="at">i=</span><span class="dv">1</span>){</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>  <span class="fu">curve</span>(b[ <span class="dv">1</span> ] <span class="sc">+</span> b[ <span class="dv">2</span> ]<span class="sc">*</span> x1 <span class="sc">+</span> b[ <span class="dv">3</span> ]<span class="sc">*</span> x7 <span class="sc">+</span> b[ <span class="dv">4</span> ]<span class="sc">*</span> x3 <span class="sc">+</span> b[ <span class="dv">5</span> ]<span class="sc">*</span> x8 <span class="sc">+</span> b[ <span class="dv">6</span> ]<span class="sc">*</span> (x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">7</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7 <span class="sc">+</span> b[ <span class="dv">8</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x3 <span class="sc">+</span> b[ <span class="dv">9</span> ]<span class="sc">*</span> x7<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">10</span> ]<span class="sc">*</span> x3<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">11</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x8 <span class="sc">+</span> b[ <span class="dv">12</span> ]<span class="sc">*</span> x7<span class="sc">*</span>x8 <span class="sc">+</span> b[ <span class="dv">13</span> ]<span class="sc">*</span> x3<span class="sc">*</span>x8 <span class="sc">+</span> b[ <span class="dv">14</span> ]<span class="sc">*</span> x1<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">15</span> ]<span class="sc">*</span> x7<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">16</span> ]<span class="sc">*</span> x3<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">17</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>x3 <span class="sc">+</span> b[ <span class="dv">18</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">19</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x3<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">20</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>x8 <span class="sc">+</span> b[ <span class="dv">21</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x3<span class="sc">*</span>x8 <span class="sc">+</span> b[ <span class="dv">22</span> ]<span class="sc">*</span> x7<span class="sc">*</span>x3<span class="sc">*</span>x8 <span class="sc">+</span> b[ <span class="dv">23</span> ]<span class="sc">*</span> x7<span class="sc">*</span>x8<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">24</span> ]<span class="sc">*</span> x3<span class="sc">*</span>x8<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">25</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">26</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x3<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">27</span> ]<span class="sc">*</span> x7<span class="sc">*</span>x3<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">28</span> ]<span class="sc">*</span> x7<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">29</span> ]<span class="sc">*</span> x3<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">30</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x8<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">31</span> ]<span class="sc">*</span> x7<span class="sc">*</span>x8<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">32</span> ]<span class="sc">*</span> x3<span class="sc">*</span>x8<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">33</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>x3<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">34</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>x3<span class="sc">*</span>x8 <span class="sc">+</span> b[ <span class="dv">35</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>x8<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">36</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x3<span class="sc">*</span>x8<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">37</span> ]<span class="sc">*</span> x7<span class="sc">*</span>x3<span class="sc">*</span>x8<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">38</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>x3<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">39</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">40</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x3<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">41</span> ]<span class="sc">*</span> x7<span class="sc">*</span>x3<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">42</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>x8<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">43</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x3<span class="sc">*</span>x8<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> b[ <span class="dv">44</span> ]<span class="sc">*</span> x7<span class="sc">*</span>x8<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">45</span> ]<span class="sc">*</span> x3<span class="sc">*</span>x8<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">46</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>x3<span class="sc">*</span>x8<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">47</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x7<span class="sc">*</span>x8<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x10 <span class="sc">+</span> b[ <span class="dv">48</span> ]<span class="sc">*</span> x1<span class="sc">*</span>x3<span class="sc">*</span>x8<span class="sc">*</span>(x8<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>x10, <span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">xname=</span><span class="st">&quot;x8&quot;</span>, <span class="at">col=</span><span class="fu">palette</span>()[i])  </span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>}</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="fu">drawit</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="fu">drawit</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="fu">drawit</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="fu">drawit</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">4</span>)</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a><span class="fu">drawit</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="fu">drawit</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">6</span>)</span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="fu">drawit</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">7</span>)</span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="co">#drawit(1,0,0,1,8) same as 2</span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a><span class="fu">drawit</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">7</span>)</span></code></pre></div>
<p><img src="Whale_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a> dt<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>y)     </span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a> dt<span class="sc">$</span>x8 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(dt<span class="sc">$</span>x8)</span></code></pre></div>
<p><br></p>
<p><span class="math display">\[ \text{PS. Did you see the whale?
:)}\]</span></p>
<p><br><br></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
